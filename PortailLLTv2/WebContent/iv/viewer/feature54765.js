actuate.util.Package.define("actuate.iv.ui.dialog.file");actuate.iv.ui.dialog.file.IVSaveDocumentDialog=actuate.Class.create();actuate.iv.ui.dialog.file.IVSaveDocumentDialog.prototype=actuate.Class.extend(new actuate.iv.ui.dialog.file.IVFileBrowsingDialogBase(),{_classname:"actuate.iv.ui.dialog.file.IVSaveDocumentDialog",_height:329,_width:305,_htmlElements:{"_category":null,"_list":null,"_fileName":null,"_fileType":null},initialize:function(){var A=this._getId(this._classname);this._applyHtmlElementsNames(A);actuate.iv.ui.dialog.AbstractIVDialog.prototype.initialize.call(this,A);this.categoryElement=document.getElementById(this._htmlElements["_category"]);this.listElementDiv=document.getElementById(this._htmlElements["_list"]);this.listElement=new actuate.uiadapter.ListBox({cls:"elementsWidth",height:100,renderTo:this.listElementDiv});this.saveFileElement=new actuate.uiadapter.TextField({cls:"elementsWidth "+actuate.iv.constant.CSS_INPUTBOX});this.saveFileElement.render(this._htmlElements["_fileName"]);this.fileTypeElementDiv=document.getElementById(this._htmlElements["_fileType"]);this.categoryElement_c=actuate.Method.bindAsEventListener(this.__neh_categoryChange,this);this.listElement_c=actuate.Method.bind(this.__neh_listChange,this);this.listElementDbl_c=actuate.Method.bind(this.__neh_listDbl,this);this.model=new actuate.iv.ui.dialog.file.IVSaveFileDialogModel();this.currentListSelection=-1;this.fileTypeElement=new actuate.uiadapter.ComboBox({editable:false,cls:"comboWidth"});this.fileTypeElement.render(this.fileTypeElementDiv);this.__local_installEventHandlers(A);},__local_installEventHandlers:function(A){actuate.util.Event.observe(this.categoryElement,"click",this.categoryElement_c,false);this.listElement.registerEventHandler("select",this.listElement_c);this.listElement.registerEventHandler("dblclick",this.listElementDbl_c);},_bind:function(C){this.reset();this.model.setData(C.fileBrowsing);this._setBreadcrumbs(this.model.getLinkNames(),this.categoryElement);this._setFileNames(this.model.getFileNames(),this.listElement);var B=C.fileBrowsing.bizdoc?true:false;var A=[["rptdocument",actuate.util.Utility.getLocalizedString("saveDocumentDialog.fileType.rptdocument")]];if(B){A.push(["bizdocument",actuate.util.Utility.getLocalizedString("saveDocumentDialog.fileType.bizdocument")]);}this.fileTypeElement.setStore(A);if(B){this.fileTypeElement.setValue("bizdocument");}else{this.fileTypeElement.setValue("rptdocument");}},reset:function(A){actuate.iv.utility.ivUtility.removeChildren(this.categoryElement);this.listElement.clear();this.currentListSelection=-1;this.model.reset();},_preHide:function(){this.saveFileElement.setValue("");},__neh_listChange:function(){this.currentListSelection=this.listElement.getSelectedIndex();if(this.currentListSelection>=0){var A=this.model.isFolder(this.currentListSelection);if(!A){this.saveFileElement.setValue(this.model.getFileName(this.currentListSelection));}}},__neh_categoryChange:function(B){var D=actuate.util.Event.element(B);var A=null;if(D.tagName){A=D.selectionId;}else{A=D.parentNode.selectionId;}if(A==null){return ;}var C=this.model.getRPath(A);this._viewer.eventDispatcher.broadcastEvent(actuate.iv.core.iVEvent.__E_QUERY_SAVE_DOCUMENT,C);},__neh_listDbl:function(){var A=this.listElement.getSelectedIndex();if(A==-1){return ;}var B=this.model.isFolder(A);var C=this.model.getPath(A);if(B){this._viewer.eventDispatcher.broadcastEvent(actuate.iv.core.iVEvent.__E_QUERY_SAVE_DOCUMENT,C);}else{this.__selectFile();}},_okPress:function(){var C=this.saveFileElement.getValue();if(!actuate.iv.utility.ivUtility.isValidFileName(C)){this._viewer._document._selectionManager._previousWarningFocusObj=this.saveFileElement;this._viewer.eventDispatcher.broadcastEvent(actuate.iv.core.iVEvent.__E_WARN,actuate.util.Utility.getLocalizedString("error.saveViewDialog.invalidFileName"));}else{var B=this.model.makePath(C);var A=this.fileTypeElement.getValue();B=B+"."+A;if(B==this._viewer.apiInstance._reportDocument){this._viewer._document._selectionManager._previousWarningFocusObj=this.saveFileElement;this._viewer.eventDispatcher.broadcastEvent(actuate.iv.core.iVEvent.__E_WARN,actuate.util.Utility.getLocalizedString("error.saveViewDialog.duplicateDocName"));}else{this._hide();this._viewer.eventDispatcher.broadcastEvent(actuate.iv.core.iVEvent.__E_SAVE_DOCUMENT,B);}}},__getHelpTopic:function(){return"iv_save";}});