actuate.util.Package.define("actuate.iv.ui.dialog");actuate.iv.ui.dialog.IVAdvancedSortDialog=actuate.Class.create();actuate.iv.ui.dialog.IVAdvancedSortDialog.prototype=actuate.Class.extend(new actuate.iv.ui.dialog.AbstractIVDialog(),{_classname:"actuate.iv.ui.dialog.IVAdvancedSortDialog",_htmlElements:{"_sortDiv1":null,"_sortDiv2":null,"_sortDiv3":null,"_sortBy1":null,"_sortBy2":null,"_sortBy3":null},_height:266,_width:346,listBoxText:[actuate.util.Utility.getLocalizedString("advancedSortDialog.selectAColumn"),actuate.util.Utility.getLocalizedString("advancedSortDialog.selectAColumn")],initialize:function(){var A=this._getId(this._classname);this._applyHtmlElementsNames(A);actuate.iv.ui.dialog.AbstractIVDialog.prototype.initialize.call(this,A);this.selectBoxes=[];this.radioButtons=[];var E,D;this._initTemplates();for(var B=0;B<3;B++){var C=new actuate.uiadapter.ComboBox({editable:false,width:160});C.render(this._htmlElements["_sortBy"+(B+1)]);this.selectBoxes.push(C);}E=new actuate.uiadapter.Radio({cls:actuate.iv.constant.CSS_INPUTBOX,name:this._classname+"_sortBy1",valueText:"asc",boxLabel:actuate.util.Utility.getLocalizedString("advancedSortDialog.ascending"),checked:true,labelWidth:90});D=new actuate.uiadapter.Radio({cls:actuate.iv.constant.CSS_INPUTBOX,name:this._classname+"_sortBy1",valueText:"desc",boxLabel:actuate.util.Utility.getLocalizedString("advancedSortDialog.descending"),labelWidth:90});E.render(this._htmlElements["_sortBy1"]+"radio1");D.render(this._htmlElements["_sortBy1"]+"radio2");this.radioButtons.push([E,D]);E=new actuate.uiadapter.Radio({cls:actuate.iv.constant.CSS_INPUTBOX,name:this._classname+"_sortBy2",valueText:"asc",boxLabel:actuate.util.Utility.getLocalizedString("advancedSortDialog.ascending"),checked:true,labelWidth:90});D=new actuate.uiadapter.Radio({cls:actuate.iv.constant.CSS_INPUTBOX,name:this._classname+"_sortBy2",valueText:"desc",boxLabel:actuate.util.Utility.getLocalizedString("advancedSortDialog.descending"),labelWidth:90});E.render(this._htmlElements["_sortBy2"]+"radio1");D.render(this._htmlElements["_sortBy2"]+"radio2");this.radioButtons.push([E,D]);E=new actuate.uiadapter.Radio({cls:actuate.iv.constant.CSS_INPUTBOX,name:this._classname+"_sortBy3",valueText:"asc",boxLabel:actuate.util.Utility.getLocalizedString("advancedSortDialog.ascending"),checked:true,labelWidth:90});D=new actuate.uiadapter.Radio({cls:actuate.iv.constant.CSS_INPUTBOX,name:this._classname+"_sortBy3",valueText:"desc",boxLabel:actuate.util.Utility.getLocalizedString("advancedSortDialog.descending"),labelWidth:90});E.render(this._htmlElements["_sortBy3"]+"radio1");D.render(this._htmlElements["_sortBy3"]+"radio2");this.radioButtons.push([E,D]);this.model=null;},_initTemplates:function(){var F=new actuate.uiadapter.Template('<DIV CLASS="sectioncontainer1">'+'	<DIV id="actuate_iv_ui_dialog_ivAdvancedSortDialog_sortBy{0}" STYLE="margin-left:2px;">'+"	</DIV>"+"</DIV>"+'<DIV CLASS="sectioncontainer2">'+'	<DIV CLASS="sectionselection">'+"		<DIV>"+'			<SPAN id="actuate_iv_ui_dialog_ivAdvancedSortDialog_sortBy{0}radio1" NOWRAP>'+"			</SPAN>"+"		</DIV>"+"		<DIV>"+'			<SPAN id="actuate_iv_ui_dialog_ivAdvancedSortDialog_sortBy{0}radio2">'+"			</SPAN>"+"		</DIV>"+"	</DIV>"+"</DIV>");var A=document.createElement("div");var J=[1];F._append(A,J,true);var I=new actuate.uiadapter.FieldSet({checkboxToggle:false,title:actuate.util.Utility.getLocalizedString("advancedSortDialog.sortByText"),autoHeight:true,defaultType:"textfield",bodyStyle:"padding:8px 0px 0",contentEl:A});I.render(this._htmlElements["_sortDiv1"]);var C=document.createElement("div");var B=[2];F._append(C,B,true);var E=new actuate.uiadapter.FieldSet({checkboxToggle:false,title:actuate.util.Utility.getLocalizedString("advancedSortDialog.thenBy1Text"),autoHeight:true,defaultType:"textfield",bodyStyle:"padding:8px 0px 0",contentEl:C});E.render(this._htmlElements["_sortDiv2"]);var G=document.createElement("div");var H=[3];F._append(G,H,true);var D=new actuate.uiadapter.FieldSet({checkboxToggle:false,title:actuate.util.Utility.getLocalizedString("advancedSortDialog.thenBy2Text"),autoHeight:true,defaultType:"textfield",bodyStyle:"padding:8px 0px 0",contentEl:G});D.render(this._htmlElements["_sortDiv3"]);},_localBind:function(I){this.reset();this.model=I[actuate.model.Constant.MetadataType.ELEMENT];if(!this.model.hasMetadata(actuate.model.Constant.MetadataType.COLUMN_DEF)&&!this.model.hasMetadata(actuate.model.Constant.MetadataType.SORT)){return ;}var K=[];K.push(this.listBoxText);var N;var E=this.model.columnsOrder;for(var J=0;J<E.length;J++){var D=this.model.columnsMap[E[J]];if(!D.isGrouped){var A=D.getBindings();for(var F=0;F<A.length;F++){var L=A[F];if(!L.isAggregation){K.push([L.name,L.displayName]);}}}}for(var G=0;G<this.selectBoxes.length;G++){this.selectBoxes[G].setStore(K);this.selectBoxes[G].setSelectedIndex(0);this.selectBoxes[G].setValue(actuate.util.Utility.getLocalizedString("advancedSortDialog.selectAColumn"));}var H=this.model.sorts;if(H){var M=H.length;if(M>this.selectBoxes.length){M=this.selectBoxes.length;}for(var J=0;J<M;J++){var B=H[J].bindingName;var C=H[J].sortDirection;this.selectBoxes[J].setValue(B);if(C=="desc"){this.radioButtons[J][1].setValue(true);}else{this.radioButtons[J][0].setValue(true);}}}},reset:function(B){for(var A=0;A<this.selectBoxes.length;A++){this.selectBoxes[A].setStore(null);}for(var A=0;A<this.radioButtons.length;A++){this.radioButtons[A][0].setValue(true);}this.model=null;},_okPress:function(){this._viewer.eventDispatcher.fireEvent(actuate.iv.core.iVEvent.__E_APPLY_SORT,this._createSoapRequest());this._hide();},__getHelpTopic:function(){return"iv_advanced_sort";},_createSoapRequest:function(){var C=new actuate.iv.data.IVColumnDefinitionGroup();var E=this._getSelections();if(E){for(var B=0;B<E.length;B++){var A=new actuate.iv.data.IVBoundDataColumn();A.setName(E[B][0]);var D=new actuate.iv.data.IVTableColumnDefinition();D.setBoundDataColumn(A);D.setSortDir(E[B][1]);D.setIsGrouped(false);C.addTableColumnDefinition(D);}}var F=new actuate.iv.data.IVData();return F.getColumnDefinitionGroup(this._viewer,C);},_getSelections:function(){var G=[];var A;var C;var F;var H;var E;for(var D=this.selectBoxes.length-1;D>-1;D--){A=this.selectBoxes[D].getSelectedIndex();if(A>0){var E=this.selectBoxes[D].getValue();for(var B=0;B<this.radioButtons[D].length;B++){if(this.radioButtons[D][B].getValue()){C=this.radioButtons[D][B].getValueText();break;}}G.push([E,C]);}}if(G.length==0){return null;}G.reverse();return G;},__validate:function(){var H=[];var A;var C;var G;var F;for(var E=this.selectBoxes.length-1;E>-1;E--){A=this.selectBoxes[E].getSelectedIndex();if(A>0){var F=this.selectBoxes[E].getValue();for(var D=0;D<H.length;D++){if(H[D][0]==F){actuate.widget.MessageBox.alert(actuate.util.Utility.getLocalizedString("advancedSortDialog.alertTitle"),actuate.util.Utility.getLocalizedString("advancedSortDialog.sortErrorMessage"));return false;}}for(var B=0;B<this.radioButtons[E].length;B++){if(this.radioButtons[E][B].getValue()){C=this.radioButtons[E][B].getValueText();break;}}H.push([F,C]);}}return true;}});