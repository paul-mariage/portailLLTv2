actuate.util.Package.define("actuate.iv.ui.view");actuate.iv.ui.view.IVParameter=actuate.Class.create();actuate.iv.ui.view.IVParameter.prototype=actuate.Class.extend(new actuate.iv.ui.view.IVView(),{_height:230,_contentHeight:185,_runEnabled:false,parameter:null,initialize:function(O){actuate.iv.ui.view.IVView.prototype.initialize.call(this,O);var A=document.createElement("DIV");A.id="ParameterPanel";A.style.display="none";A.className="parameter";var L=document.createElement("DIV");L.className="paneHeader";L.id="actuate_iv_ui_view_ivParameter_parameterHeader";A.appendChild(L);var K=document.createElement("LABEL");K.style.align="left";K.className="ivViewLabel";var E=document.createTextNode(actuate.util.Utility.getLocalizedString("parameter.toolbar.displayname"));K.appendChild(E);L.appendChild(K);var P=document.createElement("SPAN");P.className="parameterToolbar";L.appendChild(P);var N=document.createElement("DIV");N.className="parameterToolbar_buttonStyleDisabled";N.id="actuate_iv_ui_view_ivParameter_runBtn";P.appendChild(N);var J=document.createElement("INPUT");J.id="actuate_iv_ui_view_ivParameter_runBtnImage";J.type="BUTTON";J.className="actuateCSSSprite_view actuateIV_parameterrun_disabled parameterRunBtn";J.title=actuate.util.Utility.getLocalizedString("parameter.button.run");J.style.marginRight="5px";N.appendChild(J);var H=document.createTextNode(actuate.util.Utility.getLocalizedString("parameter.button.run"));N.appendChild(H);var B=document.createElement("INPUT");B.type="BUTTON";B.className="closeButton actuate-widget-tool actuate-widget-tool-left";B.title=actuate.util.Utility.getLocalizedString("parameter.button.close");L.appendChild(B);var C=document.createElement("DIV");C.className="parameterContent";A.appendChild(C);var I=actuate.iv.utility.ivUtility.getElementByClassName(O.container,"content");if(I){I.appendChild(A);}this.instance=A;this.instance.style.height=this._height+"px";var G=(this._viewer.contentPanel&&this._viewer.contentPanel.getNavbarHeight)?this._viewer.contentPanel.getNavbarHeight():0;var M=this._viewer.height-this._height-G;this.instance.style.top=M+"px";this.instance.style.width=this._viewer.width+"px";this._contentDiv=null;this._closeBtn=null;this._runBtn=null;this._runBtnImage=null;for(var D=0;D<this.instance.childNodes.length;D++){if(this.instance.childNodes[D].getAttributeNode){var Q=this.instance.childNodes[D].getAttributeNode("class");if(Q.nodeValue=="parameterContent"){this._contentDiv=this.instance.childNodes[D];this._contentDiv.setAttribute("id","actuate_iv_ui_view_ivParameter_contentDiv_"+this._viewer.id);}else{if(Q.nodeValue=="paneHeader"){var F=this.instance.childNodes[D];this._closeBtn=F.getElementsByTagName("input")[1];this._runBtnImage=F.getElementsByTagName("input")[0];this._runBtn=this._runBtnImage.parentNode;}}}}this._contentDiv.style.height=this._contentHeight+"px";this._contentDiv.style.width=this._viewer.width+"px";this._eh_resize_closure=actuate.Method.bindAsEventListener(this._eh_resize,this);this.parametersLoadedCallBack_c=actuate.Method.bind(this.parametersLoadedCallBack,this);this.parametersExceptionCallBack_c=actuate.Method.bind(this.parametersExceptionCallBack,this);this._parameterValuesRunCallback_c=actuate.Method.bind(this._parameterValuesRunCallback,this);this._run_c=actuate.Method.bindAsEventListener(this._run,this);this._close_c=actuate.Method.bindAsEventListener(this.close,this);if(actuate.util.Utility.isIE8){this._closeBtn.buttonFixType=2;actuate.util.Utility.fixIE8ImageButtons(this.instance);}this._cb_installEventHandlers(this.instance.id);this._runEnabled=false;},_run:function(){if(!this._runEnabled){return ;}if(this._viewer.apiInstance.getReportDesign()){var B=this.parameter;var A=B.validateParameters();if(null!=A){this._viewer.eventDispatcher.broadcastEvent(actuate.iv.core.iVEvent.__E_WARN,A);return ;}B.downloadParameterValues(this._parameterValuesRunCallback_c);}},_parameterValuesRunCallback:function(B){if(B){var A=new Object();A[actuate.data.impl.OptionKeys.REPORT_PARAMETERS]=B;A[actuate.data.impl.OptionKeys.REPORTLET_BOOKMARK]=this._viewer.apiInstance.getReportletBookmark();this._viewer.eventDispatcher.broadcastEvent(actuate.iv.core.iVEvent.__E_RUN_REPORT,A);}},_cb_installEventHandlers:function(A){this._viewer.eventDispatcher.registerEventHandler(actuate.iv.core.iVEvent.__E_RESIZE,A,this._eh_resize_closure);actuate.util.Event.observe(this._closeBtn,"click",this._close_c,false);actuate.util.Event.observe(this._runBtn,"click",this._run_c,false);if(this._runBtnImage){this._neh_buttonMouseOut_c=actuate.Method.bindAsEventListener(this._neh_buttonMouseOut,this);this._neh_buttonMouseOver_c=actuate.Method.bindAsEventListener(this._neh_buttonMouseOver,this);actuate.util.Event.observe(this._runBtnImage,"mouseout",this._neh_buttonMouseOut_c,false);actuate.util.Event.observe(this._runBtnImage,"mouseover",this._neh_buttonMouseOver_c,false);}},_neh_buttonMouseOver:function(A){var B=actuate.util.Event.element(A);if(B&&B.className&&B.className.indexOf("disabled",B.className.length-"disabled".length)==-1){if(B.className.lastIndexOf("_over")<B.className.length-5){B.className=B.className+"_over";}}},_neh_buttonMouseOut:function(A){var B=actuate.util.Event.element(A);if(B&&B.className){if(B.className.indexOf("_over",B.className.length-"_over".length)!==-1){B.className=B.className.substr(0,B.className.length-"_over".length);}}},_eh_resize:function(){this._updateSize();},_beh_parameter:function(B){this._setRunEnabled(false);this.instance.style.display="block";this._viewer.eventDispatcher.broadcastEvent(actuate.iv.core.iVEvent.__E_RESIZE);var A=new Array();A.push("actuate.parameter");actuate.resource.module.require(A,actuate.Method.bind2(this._prepareParameter,this,B));},_prepareParameter:function(D){if(this.parameter==null){this.parameter=new actuate.parameter.Parameter(this.getContentDivId());this.parameter.registerEventHandler(actuate.parameter.EventConstants.ON_EXCEPTION,this.parametersExceptionCallBack_c);}var C=this.parameter;var A=this._viewer.apiInstance.getReportDesign();if(A){C.setReportName(A);A=this._viewer.apiInstance.getReportDocument();var B=this._viewer.apiInstance.getConnectionHandle();C.setTransientDocumentName(A,B);}else{A=this._viewer.apiInstance.getReportDocument();C.setReportName(A);}C.submit(this.parametersLoadedCallBack_c);return ;},parametersLoadedCallBack:function(){this._showReadOnly(this.parameter.getParameterDefinitions());},_hasParams:function(B){if(B){for(var A=0;A<B.length;A++){if(!B[A].isHidden()){return true;}}}return false;},_setRunEnabled:function(A){if(this._runEnabled!=A){this._runEnabled=A;this._runBtn.className=A?"parameterToolbar_buttonStyle":"parameterToolbar_buttonStyleDisabled";this._runBtnImage.disabled=!A;this._runBtnImage.className="parameterRunBtn actuateCSSSprite_view "+(A?"actuateIV_parameterrun":"actuateIV_parameterrun_disabled");this._runBtn.style.cursor=A?"pointer":"default";this._runBtnImage.style.cursor=A?"pointer":"default";}},_showReadOnly:function(C){var A=this._hasParams(C);var D=false;if(!A){D=true;}else{if(A&&!this._viewer.apiInstance.getReportDesign()){D=true;var B=document.createElement("div");this._contentDiv.appendChild(B);B.className="informationDiv";B.innerHTML=actuate.util.Utility.getLocalizedString("parameter.readOnlyInformation");}}this._setRunEnabled(!D);},parametersExceptionCallBack:function(A){this._viewer.eventDispatcher.broadcastEvent(actuate.iv.core.iVEvent.__E_WARN,A.getMessage());return ;},getContentDivId:function(){return this._contentDiv.getAttribute("id");},getPanelHeight:function(){return this._height;},_updateSize:function(){var A=(this._viewer.contentPanel&&this._viewer.contentPanel.getNavbarHeight)?this._viewer.contentPanel.getNavbarHeight():0;var B=this._viewer.height-this._height-A;this.instance.style.top=B+"px";this.instance.style.width=this._viewer.width+"px";this._contentDiv.style.width=this._viewer.width+"px";this._contentDiv.style.height=this._contentHeight+"px";}});