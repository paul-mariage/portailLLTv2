actuate.util.Package.define("actuate.iv.ui.dialog");actuate.iv.ui.dialog.IVDataAnalyzerDialog=actuate.Class.create();actuate.iv.ui.dialog.IVDataAnalyzerDialog.prototype=actuate.Class.extend(new actuate.iv.ui.dialog.AbstractIVDialog(),{_classname:"actuate.iv.ui.dialog.IVDataAnalyzerDialog",_viewer:null,_dataAnalyzer:null,_dataAnalyzerContainer:null,_selectedElement:null,isResizable:true,hasAutoAdjustSize:false,_uiOptions:null,showAnalyzerCubeView:true,showAnalyzerFilterView:true,showAnalyzerCrosstabView:true,initialize:function(){var A=this._getId(this._classname);this._title=actuate.util.Utility.getLocalizedString("dataAnalyzerDialog.caption");actuate.iv.ui.dialog.AbstractIVDialog.prototype.initialize.call(this,A,null,false);this._dataAnalyzer=null;this._dataAnalyzerContainer=document.createElement("div");this._dataAnalyzerContainer.id=this.htmlId+"_container";this._dataAnalyzerContainer.style.width="100%";this._dataAnalyzerContainer.style.height="100%";this._window.getBodyDom().appendChild(this._dataAnalyzerContainer);this._createDataAnalyzer_closure=actuate.Method.bindAsEventListener(this._createDataAnalyzer,this);this._applyDataAnalyzer_closure=actuate.Method.bindAsEventListener(this._applyDataAnalyzer,this);this._cancelDataAnalyzer_closure=actuate.Method.bindAsEventListener(this._cancelDataAnalyzer,this);this._window.registerEventHandler("resize",actuate.Method.bind(this._dialogResize,this));},_dialogResize:function(){if(this._dataAnalyzer&&this._dataAnalyzer.isActive()){var A=this._window.windowEl.body.getSize(true);this._dataAnalyzer.resizeTo(A.width,A.height);}},_localBind:function(C){this._selectedElement=C[actuate.model.Constant.MetadataType.ELEMENT];if(!this._selectedElement){return ;}var B;var A;if(this._viewer.standalone){B=this._viewer.clientWidth;A=this._viewer.clientHeight;}else{B=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;A=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;}B-=100;A-=100;this._window.windowEl.setSize(B,A);this.showAnalyzerCubeView=this._selectedElement["showAnalyzerCubeView"];this.showAnalyzerFilterView=this._selectedElement["showAnalyzerFilterView"];this.showAnalyzerCrosstabView=this._selectedElement["showAnalyzerCrosstabView"];if(!this._dataAnalyzer){actuate.resource.module.require(["actuate.xtabanalyzer"],this._createDataAnalyzer_closure);}else{this._updateDataAnalyzer();}return true;},_updateDataAnalyzer:function(){var B=this._window.windowEl.body.getSize(true);this._dataAnalyzer.setWidth(B.width);this._dataAnalyzer.setHeight(B.height);this._dataAnalyzer.setReportDocument(this._viewer.getTransientReportDocument(),this._viewer.getConnectionHandle());this._dataAnalyzer.setPersistentReport(this._viewer.apiInstance.getReportName());this._dataAnalyzer.setXTabBookmark(this._selectedElement.getBookmark());this._dataAnalyzer.setXTabIid(this._selectedElement.getInstanceId());this._uiOptions=new actuate.xtabanalyzer.UIOptions();if(this.showAnalyzerCubeView){this._uiOptions.enableCubeView(true);}else{this._uiOptions.enableCubeView(false);}if(this.showAnalyzerFilterView){this._uiOptions.enableFilterSummaryView(true);}else{this._uiOptions.enableFilterSummaryView(false);}if(this.showAnalyzerCrosstabView){this._uiOptions.enableCrosstabView(true);}else{this._uiOptions.enableCrosstabView(false);}this._dataAnalyzer.setUIOptions(this._uiOptions);var A=this;this._dataAnalyzer.submit(function(){A._show();});},_createDataAnalyzer:function(){var A=new actuate.XTabAnalyzer(this._dataAnalyzerContainer);A.setIVMode(true);A.registerEventHandler(actuate.xtabanalyzer.EventConstants.ON_SESSION_TIMEOUT,actuate.Method.bind(this._timeoutHandler,this));this._dataAnalyzer=A;this._updateDataAnalyzer();},_timeoutHandler:function(){this._viewer.triggerSessionTimeout();},__getHelpTopic:function(){return"iv_analyzer";},_okPress:function(){if(this._dataAnalyzer&&this._dataAnalyzer.isActive()){try{this._dataAnalyzer.commit(this._applyDataAnalyzer_closure);}catch(A){}}else{this._hide();}},_neh_cancel:function(){if(this._dataAnalyzer&&this._dataAnalyzer.isActive()){try{this._dataAnalyzer.rollback(this._cancelDataAnalyzer_closure);}catch(A){}}else{this._hide();}},_applyDataAnalyzer:function(){this._viewer.totalPage=-1;this._viewer.navbar._oTotalPage.text=-1;this._viewer.eventDispatcher.fireEvent(actuate.iv.core.iVEvent.__E_APPLY_DATA_ANALYZER,null);this._hide();},_cancelDataAnalyzer:function(){this._hide();},_adjustPosition:function(){this._window.center();}});