actuate.util.Package.define("actuate.iv.ui.dialog.column");actuate.iv.ui.dialog.column.IVArrangeColumnDialog=actuate.Class.create();actuate.iv.ui.dialog.column.IVArrangeColumnDialog.prototype=actuate.Class.extend(new actuate.iv.ui.dialog.AbstractIVDialog(),{_classname:"actuate.iv.ui.dialog.column.IVArrangeColumnDialog",_htmlElements:{"_panel":null,"_button_up":null,"_button_down":null},__columnList:null,__columnIIdList:[],_height:199,_width:263,initialize:function(){var A=this._getId(this._classname);this._applyHtmlElementsNames(A);actuate.iv.ui.dialog.AbstractIVDialog.prototype.initialize.call(this,A);this.columnPanel=document.getElementById(this._htmlElements["_panel"]);this.upButton=document.getElementById(this._htmlElements["_button_up"]);this.downButton=document.getElementById(this._htmlElements["_button_down"]);this.__columnList=new actuate.uiadapter.ListBox({renderTo:this.columnPanel,width:200,height:90});this.__installEventHandlers(A);},__installEventHandlers:function(A){actuate.util.Event.observe(this.upButton,"click",actuate.Method.bindAsEventListener(this.__neh_buttonUpClick,this),false);actuate.util.Event.observe(this.downButton,"click",actuate.Method.bindAsEventListener(this.__neh_buttonDownClick,this),false);},_localBind:function(B){if(!B){return ;}var F=[];var I=B[actuate.model.Constant.MetadataType.ELEMENT];var H=B.columnIid;var A=I.columnsOrder;var G=0;var C=0;this.__columnIIdList=A;while(C<A.length){var D=A[C];var E=I.columnsMap[D];F.push([D,E.header]);if(D==H){G=C;}C+=(E.spanCount>0?E.spanCount:1);}this.__columnList.setStore(F);if(F.length>0){this.__columnList.setSelectedIndex(G);}},__neh_buttonUpClick:function(B){actuate.util.Event.stop(B);var A=this.__columnList.getSelectedIndex();if(A==0){return ;}this.__columnList.swap(A,A-1);},__neh_buttonDownClick:function(B){actuate.util.Event.stop(B);var A=this.__columnList.getSelectedIndex();if(A==this.__columnList.getLength()-1){return ;}this.__columnList.swap(A,A+1);},_okPress:function(){this._viewer.eventDispatcher.fireEvent(actuate.iv.core.iVEvent.__E_REORDERCOLUMN,this._createSoapRequest());this._hide();},__getHelpTopic:function(){return"iv_manage_column";},_createSoapRequest:function(){var B=actuate.util.XmlDom.createXMLDom(actuate.util.Constants.soap.NAMESPACE_ACTUATE10,actuate.Constant.tag.Data);var A=actuate.util.XmlDom.createElement(B,actuate.Constant.tag.COLUMNDEFS);B.documentElement.appendChild(A);this.createColumnDefSoapRequest(this._getItemList(),B,A);return B;},_getItemList:function(){return this.__columnList.getStore().collect("value",true);},createColumnDefSoapRequest:function(D,F,A){var E;var C,G;for(var B=0;B<D.length;B++){E=actuate.util.XmlDom.createElement(F,actuate.Constant.tag.ColumnDef);C=actuate.util.XmlDom.createElement(F,actuate.Constant.tag.NewIndex);G=F.createTextNode(B);C.appendChild(G);E.appendChild(C);C=actuate.util.XmlDom.createElement(F,actuate.Constant.tag.Index);var H=this.__getOldIndex(D[B]);G=F.createTextNode(H);C.appendChild(G);E.appendChild(C);A.appendChild(E);}},__getOldIndex:function(B){for(var A=0;A<this.__columnIIdList.length;A++){if(B==this.__columnIIdList[A]){return A;}}}});