actuate.util.Package.define("actuate.dialog.impl.helper.font");actuate.dialog.impl.helper.font.FontDialogEx=actuate.Class.create();actuate.dialog.impl.helper.font.FontDialogEx.superclass=actuate.dialog.impl.helper.AbstractIVDialog.prototype;actuate.dialog.impl.helper.font.FontDialogEx.prototype=actuate.Class.extend(new actuate.dialog.impl.helper.AbstractIVDialog(),{_idname:"actuate.dialog.font.FontDialogEx",_classname:"actuate.dialog.font.FontDialogEx",_width:386,_htmlElements:{"_headerDataSt":null,"_applyToBoth":null,"_applyToHeader":null,"_applyToData":null,"_fontSelect":null,"_sizeSelect":null,"_colorSelect":null,"_bgColorSelect":null,"_bold":null,"_italic":null,"_underline":null,"_alignleft":null,"_aligncenter":null,"_alignright":null,"_radioButtons":null,"_applyToTable":null,"_applyToColumn":null,"_previewBox":null,"_sizeUnitSelect":null,"_previewText":null},_dataItemId:null,_subDialog:null,initialize:function(){this._util=actuate.util.Utility;var D=this._getId(this._idname);this._applyHtmlElementsNames(D);var C=document.getElementById(D);var A=this._getId(this._classname);C.className=A;actuate.dialog.impl.helper.AbstractIVDialog.prototype.initialize.call(this,D);this.headerDataSelection=document.getElementById(this._htmlElements["_headerDataSt"]);this.applyToBoth=new actuate.uiadapter.Radio({cls:actuate.dialog.impl.constant.CSS_INPUTBOX,name:"headerOrData",valueText:"Both",boxLabel:this._util.getLocalizedString("fontDialog.label.applyToBoth")});this.applyToHeader=new actuate.uiadapter.Radio({cls:actuate.dialog.impl.constant.CSS_INPUTBOX,name:"headerOrData",valueText:"Header",boxLabel:this._util.getLocalizedString("fontDialog.label.applyToHeader")});this.applyToData=new actuate.uiadapter.Radio({cls:actuate.dialog.impl.constant.CSS_INPUTBOX,name:"headerOrData",valueText:"Data",boxLabel:this._util.getLocalizedString("fontDialog.label.applyToData")});this.applyToBoth.render(this._htmlElements["_applyToBoth"]);this.applyToHeader.render(this._htmlElements["_applyToHeader"]);this.applyToData.render(this._htmlElements["_applyToData"]);this.fontSelectDiv=document.getElementById(this._htmlElements["_fontSelect"]);this.sizeSelectDiv=document.getElementById(this._htmlElements["_sizeSelect"]);this.sizeUnitSelectDiv=document.getElementById(this._htmlElements["_sizeUnitSelect"]);this.colorSelectDiv=document.getElementById(this._htmlElements["_colorSelect"]);this.bgColorSelectDiv=document.getElementById(this._htmlElements["_bgColorSelect"]);this.boldToggle=document.getElementById(this._htmlElements["_bold"]);this.italicToggle=document.getElementById(this._htmlElements["_italic"]);this.underlineToggle=document.getElementById(this._htmlElements["_underline"]);this.alignLeftToggle=document.getElementById(this._htmlElements["_alignleft"]);this.alignCenterToggle=document.getElementById(this._htmlElements["_aligncenter"]);this.alignRightToggle=document.getElementById(this._htmlElements["_alignright"]);this.fontSelect=new actuate.uiadapter.ComboBox({editable:false,resizable:true,width:100});this.fontSelect.render(this.fontSelectDiv);this.sizeSelect=new actuate.uiadapter.ComboBox({editable:true,width:50});this.sizeSelect.render(this.sizeSelectDiv);this.sizeUnitSelect=new actuate.uiadapter.ComboBox({editable:false,width:62});this.sizeUnitSelect.render(this.sizeUnitSelectDiv);this.colorSelect=new actuate.uiadapter.ColorField({width:242});this.colorSelect.render(this.colorSelectDiv);this.bgColorSelect=new actuate.uiadapter.ColorField({width:242});this.bgColorSelect.render(this.bgColorSelectDiv);this.radioButtonDiv=document.getElementById(this._htmlElements["_radioButtons"]);this.applyToTable=new actuate.uiadapter.Radio({cls:actuate.dialog.impl.constant.CSS_INPUTBOX,name:"tableOrColumn",valueText:"table",boxLabel:this._util.getLocalizedString("fontDialog.label.applyToTable")});this.applyToColumn=new actuate.uiadapter.Radio({cls:actuate.dialog.impl.constant.CSS_INPUTBOX,name:"tableOrColumn",valueText:"column",boxLabel:this._util.getLocalizedString("fontDialog.label.applyToColumn")});this.applyToTable.render(this._htmlElements["_applyToTable"]);this.applyToColumn.render(this._htmlElements["_applyToColumn"]);this.styleModel=null;this.styleMenus=null;this.styleSelectionView=new actuate.dialog.impl.helper.font.StyleSelectionView(this.fontSelect,this.sizeSelect,this.colorSelect,this.bgColorSelect,this._htmlElements["_bold"],this._htmlElements["_italic"],this._htmlElements["_underline"],this._htmlElements["_alignleft"],this._htmlElements["_aligncenter"],this._htmlElements["_alignright"],this.sizeUnitSelect);this.stylePreviewView=new actuate.dialog.impl.helper.font.StylePreviewView(this._htmlElements["_previewText"]);var B=actuate.Method.bindAsEventListener(this.__neh_keyup,this);actuate.util.Event.observe(this.boldToggle,"click",actuate.Method.bind(this.__neh_boldClick,this),false);actuate.util.Event.observe(this.boldToggle,"mouseover",actuate.Method.bind(this._neh_mouseOver,this),false);actuate.util.Event.observe(this.boldToggle,"mouseout",actuate.Method.bind(this._neh_mouseOut,this),false);actuate.util.Event.observe(this.italicToggle,"click",actuate.Method.bind(this.__neh_italicClick,this),false);actuate.util.Event.observe(this.italicToggle,"mouseover",actuate.Method.bind(this._neh_mouseOver,this),false);actuate.util.Event.observe(this.italicToggle,"mouseout",actuate.Method.bind(this._neh_mouseOut,this),false);actuate.util.Event.observe(this.underlineToggle,"click",actuate.Method.bind(this.__neh_underlineClick,this),false);actuate.util.Event.observe(this.underlineToggle,"mouseover",actuate.Method.bind(this._neh_mouseOver,this),false);actuate.util.Event.observe(this.underlineToggle,"mouseout",actuate.Method.bind(this._neh_mouseOut,this),false);actuate.util.Event.observe(this.alignLeftToggle,"click",actuate.Method.bind(this.__neh_alignLeftClick,this),false);actuate.util.Event.observe(this.alignLeftToggle,"mouseover",actuate.Method.bind(this._neh_mouseOver,this),false);actuate.util.Event.observe(this.alignLeftToggle,"mouseout",actuate.Method.bind(this._neh_mouseOut,this),false);actuate.util.Event.observe(this.alignCenterToggle,"click",actuate.Method.bind(this.__neh_alignCenterClick,this),false);actuate.util.Event.observe(this.alignCenterToggle,"mouseover",actuate.Method.bind(this._neh_mouseOver,this),false);actuate.util.Event.observe(this.alignCenterToggle,"mouseout",actuate.Method.bind(this._neh_mouseOut,this),false);actuate.util.Event.observe(this.alignRightToggle,"click",actuate.Method.bind(this.__neh_alignRightClick,this),false);actuate.util.Event.observe(this.alignRightToggle,"mouseover",actuate.Method.bind(this._neh_mouseOver,this),false);actuate.util.Event.observe(this.alignRightToggle,"mouseout",actuate.Method.bind(this._neh_mouseOut,this),false);this.selectBoxesFocused=false;this.__neh_gainFocus_c=actuate.Method.bind(this.__neh_gainFocus,this);this.fontSelect.registerEventHandler("focus",this.__neh_gainFocus_c);this.sizeSelect.registerEventHandler("focus",this.__neh_gainFocus_c);this.colorSelect.registerEventHandler("focus",this.__neh_gainFocus_c);this.bgColorSelect.registerEventHandler("focus",this.__neh_gainFocus_c);this._okCallback=null;this._cancelCallback=null;this._subDialog=false;},__neh_gainFocus:function(A){this.selectBoxesFocused=true;},loseFocus:function(){this.selectBoxesFocused=false;},_bindFromMetadata:function(A){this.styleModel=new actuate.dialog.impl.helper.font.StyleModel();this.reset();this._elementType=A[actuate.model.Constant.MetadataType.ELEMENT].type;if(!A.columnHeaderMode){this._column=A.selectedColumn;this._dataItemId=A.selectedElement&&A.selectedElement.iid.substr(1);}else{this._dataItemId=null;this._elementType=actuate.Constant.element.LABEL;}if(A.showHeaderDataSelection){this._showHeaderDataSelection(true);if("both"==A.applyTarget){this.applyToBoth.setValue(true);}else{if("header"==A.applyTarget){this.applyToHeader.setValue(true);}else{if("data"==A.applyTarget){this.applyToData.setValue(true);}else{this.applyToBoth.setValue(true);}}}}else{this._showHeaderDataSelection(false);}this._showRadioButtons(this._elementType==actuate.Constant.element.TABLE);if(A.style){this.styleModel.setFont(A.style);}this.styleSelectionView.setValues(this.styleModel.getFontFamily(),this.styleModel.getFontSize(),this.styleModel.getColor(),this.styleModel.getBackgroundColor(),this.styleModel.getIsBold(),this.styleModel.getIsItalic(),this.styleModel.getIsUnderline(),this.styleModel.getAlignment(),this.styleModel.getFontSizeUnit());if(!this.styleModel.isDefault()){this.stylePreviewView.showPreview(this.styleModel);}this.applyToColumn.setValue(true);this.applyToTable.setValue(false);},_showRadioButtons:function(A){this.radioButtonDiv.style.display=A?"block":"none";},_showHeaderDataSelection:function(A){this.headerDataSelection.style.display=A?"block":"none";},reset:function(){this.styleModel.reset();this.styleSelectionView.reset(this.styleModel);this.stylePreviewView.showPreview(this.styleModel);},__neh_fontChange:function(){this.styleModel.setFontFamily(this.styleSelectionView.getFontValue());this.handleFormatChange();},__neh_fontSizeChange:function(){this.styleModel.setFontSize(this.styleSelectionView.getFontSizeText());this.handleFormatChange();},__neh_fontSizeInput:function(){this._validateFontSizeInput();this.styleModel.setFontSize(this.styleSelectionView.getFontSizeText());this.handleFormatChange();},_validateFontSizeInput:function(){var B=this.styleSelectionView.getFontSizeText();B=(B)?B:"";var A=actuate.util.Utility.getLocalizedString("fontDialog.size.auto");A=(A)?A:"";if(!actuate.util.Utility.isNumeric(B)&&B.toLowerCase()!=A.toLowerCase()){actuate.uiadapter.MessageBox.show({title:actuate.util.Utility.getLocalizedString("fontDialogEx.alertTitle"),msg:actuate.util.Utility.getLocalizedString("fontDialogEx.numeric.errorMessage"),buttons:actuate.widget.MessageBox.OK,icon:actuate.widget.MessageBox.WARNING});return false;}else{return true;}},__neh_fontSizeUnitChange:function(){this.styleModel.setFontSizeUnit(this.styleSelectionView.getFontSizeUnitValue());this.handleFormatChange();},__neh_colorChange:function(){this.styleModel.setColor(this.styleSelectionView.getColorValue());this.handleFormatChange();},__neh_backgroundColorChange:function(){this.styleModel.setBackgroundColor(this.styleSelectionView.getBackgroundColorValue());this.handleFormatChange();},__neh_underlineClick:function(){this.styleModel.toggleUnderline();this.styleSelectionView.setUnderlineButtonValue(this.styleModel.getIsUnderline());this.handleFormatChange();},__neh_italicClick:function(){this.styleModel.toggleItalic();this.styleSelectionView.setItalicButtonValue(this.styleModel.getIsItalic());this.handleFormatChange();},__neh_boldClick:function(){this.styleModel.toggleBold();this.styleSelectionView.setBoldButtonValue(this.styleModel.getIsBold());this.handleFormatChange();},_neh_mouseOut:function(C){actuate.util.Event.stop(C);var D=actuate.util.Event.element(C);var E=D.className.split(" ");for(var B=0,A=E.length;B<A;B++){if(E[B].indexOf("actuateIV_")==0){var F=E[B].lastIndexOf("_over");if(F>0){actuate.widget.Element.fly(D).removeClass(E[B]);}}}},_neh_mouseOver:function(D){actuate.util.Event.stop(D);var F=actuate.util.Event.element(D);var G=F.className.split(" ");for(var B=0,A=G.length;B<A;B++){if(G[B].indexOf("actuateIV_")==0){var C=null;var E=G[B].lastIndexOf("_disable");var H=G[B].lastIndexOf("_enable");if(E>0){C=G[B].substring(0,E);}else{if(H>0){C=G[B].substring(0,H);}}actuate.widget.Element.fly(F).addClass(C+"_over");}}},__neh_alignLeftClick:function(){this.styleModel.setAlignment("left");this.styleSelectionView.setAlignmentButtonValue(this.styleModel.getAlignment());this.handleFormatChange();},__neh_alignCenterClick:function(){this.styleModel.setAlignment("center");this.styleSelectionView.setAlignmentButtonValue(this.styleModel.getAlignment());this.handleFormatChange();},__neh_alignRightClick:function(){this.styleModel.setAlignment("right");this.styleSelectionView.setAlignmentButtonValue(this.styleModel.getAlignment());this.handleFormatChange();},handleFormatChange:function(A){this.stylePreviewView.showPreview(this.styleModel);},getApplyTarget:function(){if(this.headerDataSelection.style.display=="none"){return null;}var A=null;if(this.applyToBoth.getValue()){A="both";}else{if(this.applyToHeader.getValue()){A="header";}else{if(this.applyToData.getValue()){A="data";}}}return A;},isApplyToTable:function(){if(this.applyToTable.getValue()){return true;}return false;},_okPress:function(){if(!this._validateFontSizeInput()){return ;}if(!this._subDialog){this._helpee.fireEvent(actuate.dialog.EventConstants.ON_DIALOG_OK,this._createSoapRequest());}if(this._okCallback){var A=new actuate.model.Font();if(this.fontSelect.getSelectedIndex()>=0){A.family=this.styleModel.getFontFamily();}if(this.sizeSelect.getSelectedIndex()>=0){var B=this.styleModel.getFontSize();if(B!=this.styleModel.fontSizeDefault){B=B+this.styleModel.getFontSizeUnit();}A.size=B;}if(this.colorSelect){A.color=this.styleModel.getColor();}if(this.bgColorSelect){A.backgroundColor=this.styleModel.getBackgroundColor();}A.bold=this.styleModel.getIsBold()?true:false;A.italic=this.styleModel.getIsItalic()?true:false;A.underline=this.styleModel.getIsUnderline()?true:false;A.alignment=this.styleModel.getAlignment();this._okCallback(A);}this._hide();},__getHelpTopic:function(){return"iv_advanced_font";},_cancelPress:function(){if(this._cancelCallback){this._cancelCallback();return ;}},_localBind:function(A){if(A.operationData){this._okCallback=A.operationData.okCallback;this._cancelCallback=A.operationData.cancelCallback;this._subDialog=A.operationData.subDialog?true:false;}else{this._okCallback=null;this._cancelCallback=null;this._subDialog=false;}if(!this.styleMenus){this.styleMenus=actuate.dialog.FontOptions;this.styleSelectionView.updateMenuOptions(this.styleMenus);this.__neh_fontChange_c=actuate.Method.bind(this.__neh_fontChange,this);this.fontSelect.registerEventHandler("select",this.__neh_fontChange_c);this.__neh_fontSizeChange_c=actuate.Method.bind(this.__neh_fontSizeChange,this);this.sizeSelect.registerEventHandler("select",this.__neh_fontSizeChange_c);this.__neh_fontSizeInput_c=actuate.Method.bind(this.__neh_fontSizeInput,this);this.sizeSelect.registerEventHandler("keyup",this.__neh_fontSizeInput_c);this.__neh_fontSizeUnitChange_c=actuate.Method.bind(this.__neh_fontSizeUnitChange,this);this.sizeUnitSelect.registerEventHandler("select",this.__neh_fontSizeUnitChange_c);this.__neh_colorChange_c=actuate.Method.bind(this.__neh_colorChange,this);this.colorSelect.registerEventHandler("pickerSelect",this.__neh_colorChange_c);this.colorSelect.registerEventHandler("paletteSelect",this.__neh_colorChange_c);this.__neh_backgroundColorChange_c=actuate.Method.bind(this.__neh_backgroundColorChange,this);this.bgColorSelect.registerEventHandler("pickerSelect",this.__neh_backgroundColorChange_c);this.bgColorSelect.registerEventHandler("paletteSelect",this.__neh_backgroundColorChange_c);}if(this._subDialog){this.styleModel=A.operationData.styles;this._showRadioButtons(false);this._showHeaderDataSelection(false);}else{this._bindFromMetadata(A);return ;}this.styleSelectionView.setValues(this.styleModel.getFontFamily(),this.styleModel.getFontSize(),this.styleModel.getColor(),this.styleModel.getBackgroundColor(),this.styleModel.getIsBold(),this.styleModel.getIsItalic(),this.styleModel.getIsUnderline(),this.styleModel.getAlignment(),this.styleModel.getFontSizeUnit());this.stylePreviewView.showPreview(this.styleModel);},_createSoapRequest:function(){var C=actuate.util.XmlDom.createXMLDom(actuate.util.Constants.soap.NAMESPACE_ACTUATE10,actuate.Constant.tag.Data);C.documentElement.appendChild(actuate.util.XmlDom.createElement(C,actuate.Constant.tag.COLUMNDEFS));var D=actuate.util.XmlDom.createElement(C,actuate.Constant.tag.Font);C.documentElement.appendChild(D);if(this._dataItemId&&(!this._column||this._column.isMergedColumn)){var B=actuate.util.XmlDom.createElement(C,actuate.Constant.tag.DataItemId);dataItemIdTextNode=C.createTextNode(this._dataItemId);B.appendChild(dataItemIdTextNode);C.documentElement.appendChild(B);}if(this.fontSelect.getSelectedIndex()>=0){B=actuate.util.XmlDom.createElement(C,actuate.Constant.tag.FAMILY);textNode=C.createTextNode(this.styleModel.getFontFamily());B.appendChild(textNode);D.appendChild(B);}if(this.sizeSelect.getValue()==""){this.styleModel.setFontSize(this.styleModel.fontSizeDefault);}B=actuate.util.XmlDom.createElement(C,actuate.Constant.tag.SIZE);var A=this.styleModel.getFontSize();if(A!=this.styleModel.fontSizeDefault){A=A+this.styleModel.getFontSizeUnit();}textNode=C.createTextNode(A);B.appendChild(textNode);D.appendChild(B);if(this.colorSelect){B=actuate.util.XmlDom.createElement(C,actuate.Constant.tag.Color);textNode=C.createTextNode(this.styleModel.getColor());B.appendChild(textNode);D.appendChild(B);}if(this.bgColorSelect){B=actuate.util.XmlDom.createElement(C,actuate.Constant.tag.BackgroundColor);textNode=C.createTextNode(this.styleModel.getBackgroundColor());B.appendChild(textNode);D.appendChild(B);}B=actuate.util.XmlDom.createElement(C,actuate.Constant.tag.Bold);if(this.styleModel.getIsBold()){textNode=C.createTextNode("true");}else{textNode=C.createTextNode("false");}B.appendChild(textNode);D.appendChild(B);B=actuate.util.XmlDom.createElement(C,actuate.Constant.tag.Italic);if(this.styleModel.getIsItalic()){textNode=C.createTextNode("true");}else{textNode=C.createTextNode("false");}B.appendChild(textNode);D.appendChild(B);B=actuate.util.XmlDom.createElement(C,actuate.Constant.tag.Underline);if(this.styleModel.getIsUnderline()){textNode=C.createTextNode("true");}else{textNode=C.createTextNode("false");}B.appendChild(textNode);D.appendChild(B);if(this.styleModel.getAlignment()){B=actuate.util.XmlDom.createElement(C,actuate.Constant.tag.Alignment);textNode=C.createTextNode(this.styleModel.getAlignment());B.appendChild(textNode);D.appendChild(B);}B=actuate.util.XmlDom.createElement(C,actuate.Constant.tag.ApplyToTable);if(this.isApplyToTable()){textNode=C.createTextNode("true");}else{textNode=C.createTextNode("false");}B.appendChild(textNode);D.appendChild(B);return C;},isInColorOptions:function(A){var D=actuate.dialog.FontOptions.fontColors;if(D){for(var B=0;B<D.length;B++){for(var C in D[B]){if(A.toLowerCase()==D[B][C]){return true;}}}}}});