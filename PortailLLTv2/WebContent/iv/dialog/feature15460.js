actuate.util.Package.define("actuate.dialog.impl.helper.chartbuilder");actuate.dialog.impl.helper.chartbuilder.ChartWoAxisDataTab=actuate.Class.extendClass(actuate.dialog.impl.helper.AbstractDataTabDialog,{_classname:"actuate.dialog.impl.helper.chartbuilder.ChartWoAxisDataTab",_filter:null,_showTooltip:null,_uiData:{},_selectedIid:null,initialize:function(){this.id=this._getId(this._classname);this._title=actuate.util.Utility.getLocalizedString("chartBuilder.data");actuate.dialog.impl.helper.AbstractTabDialog.prototype.initialize.call(this);this._dataFieldSet=actuate.widget.ComponentMgr.get(this.id+"_dataFieldSet");this.__initDataSourceCombo();this._categoryCombo=actuate.widget.ComponentMgr.get("actuate_dialog_ChartWoAxisDataTab_categoryCombo");this._xGroupOn=actuate.widget.ComponentMgr.get(this.id+"_xGroupOn");this._valueCombo=actuate.widget.ComponentMgr.get("actuate_dialog_ChartWoAxisDataTab_valueCombo");this._aggrExprLabel=actuate.widget.ComponentMgr.get(this.id+"_aggrExprLabel");this._agregateExpression=actuate.widget.ComponentMgr.get("actuate_dialog_ChartWoAxisDataTab_agregateExpression");this._isXGroupOn=actuate.widget.ComponentMgr.get("actuate_dialog_ChartWoAxisDataTab_isXGroupOn");this._showTooltip=actuate.widget.ComponentMgr.get("actuate_dialog_ChartWoAxisDataTab_ShowTooltip");this._tooltipValue=actuate.widget.ComponentMgr.get("actuate_dialog_ChartWoAxisDataTab_TooltipValue");this._xGroupOn_items=actuate.widget.ComponentMgr.get(this.id+"_xGroupOn_items");this._hyperlinkCheckbox=actuate.widget.ComponentMgr.get(this.id+"_hyperlinkCheckbox");this._keepCubeHierarchy=actuate.widget.ComponentMgr.get(this.id+"_keepCubeHierarchy");var A=actuate.Method.bind(this._eh_changeXGroupOn,this);var B=actuate.Method.bind(this._eh_datasetComboChange,this);var C=actuate.Method.bind(this._eh_onBeforeSelect,this);this.__dataSourceCombo.registerEventHandler("change",B);this._categoryCombo.registerEventHandler("select",A);this._categoryCombo.registerEventHandler("beforeselect",C);this._valueCombo.registerEventHandler("beforeselect",C);this._tooltipValue.registerEventHandler("beforeselect",C);},__createDataSourceCombo:function(){return actuate.widget.ComponentMgr.get("actuate_dialog_ChartWoAxisDataTab_dataSetCombo");},_initContent:function(){this._componentArray=[];var C=this;this._valueDefinitionStore=new actuate.widget.data.SimpleStore({fields:["valueDefinitionValue","valueDefinitionText","title","valueDefinitionType","hasAction"]});this._valueDefinitionStore2=new actuate.widget.data.SimpleStore({fields:["valueDefinitionValue","valueDefinitionText","title","valueDefinitionType"]});this._valueDefinitionStoreTooltip=new actuate.widget.data.SimpleStore({fields:["valueDefinitionValue","valueDefinitionText","title","valueDefinitionType"]});var A={xtype:"fieldset",collapsible:true,title:actuate.util.Utility.getLocalizedString("chartBuilder.data"),checkboxToggle:false,defaults:{border:false,layout:"column"},cls:"actuate-widget-panle-zero-margin-top",id:this.id+"_dataFieldSet",listeners:{collapse:function(){if(C._parentDialog&&C._parentDialog.adjustSize){C._parentDialog.adjustSize();}},expand:function(){if(C._parentDialog&&C._parentDialog.adjustSize){C._parentDialog.adjustSize();}}},items:[{layout:"column",bodyStyle:"padding:4px 4px 4px 4px",items:[{layout:"form",border:false,labelWidth:190,items:[{id:"actuate_dialog_ChartWoAxisDataTab_dataSetCombo",width:320,fieldLabel:actuate.util.Utility.getLocalizedString("chartBuilder.useDataFrom"),xtype:"treecombo",editable:false,forceSelection:true,autoExpand:true,valueField:"value",displayField:"title",titleField:"title",icons:this.__dataSourceIcons,sortInfo:{folderSort:true,field:"text",direction:"ASC"},showTooltip:true,store:new actuate.widget.custom.TreeCombo.TreeComboStore(this.__dataSourceComboStore),style:"margin-right:3px; margin-lef:0px"}]}]},{items:[{columnWidth:0.37,id:this.id+"_hyperlinkCheckbox",xtype:"checkbox",checked:true,boxLabel:actuate.util.Utility.getLocalizedString("common.dataTab.useHyperlink"),handler:function(){}},{columnWidth:0.37,id:this.id+"_keepCubeHierarchy",xtype:"checkbox",checked:false,boxLabel:actuate.util.Utility.getLocalizedString("common.dataTab.keepCubeHierarchy"),handler:function(){}}]}]};this._componentArray.push(A);this._xGroupOnStore=new actuate.widget.data.SimpleStore({fields:["value","text"]});var E={xtype:"fieldset",collapsible:true,autoHeight:true,title:actuate.util.Utility.getLocalizedString("chartBuilder.slice"),checkboxToggle:false,defaults:{border:false,header:false,layout:"column",bodyStyle:"padding:2px 4px 2px 4px"},listeners:{collapse:function(){if(C._parentDialog&&C._parentDialog.adjustSize){C._parentDialog.adjustSize();}},expand:function(){if(C._parentDialog&&C._parentDialog.adjustSize){C._parentDialog.adjustSize();}}},items:[{items:[{columnWidth:0.37,xtype:"label",text:actuate.util.Utility.getLocalizedString("chartBuilder.sliceLable")},{columnWidth:0.6,id:"actuate_dialog_ChartWoAxisDataTab_categoryCombo",xtype:"treecombo",editable:false,forceSelection:true,valueField:"valueDefinitionValue",displayField:"valueDefinitionText",titleField:"title",autoExpand:true,showTooltip:true,icons:this.__icons,store:new actuate.widget.custom.TreeCombo.TreeComboStore(this._valueDefinitionStore)}]},{items:[{columnWidth:0.37,xtype:"label",style:"height:1px"},{columnWidth:0.605,id:"actuate_dialog_ChartWoAxisDataTab_isXGroupOn",xtype:"checkbox",checked:true,boxLabel:actuate.util.Utility.getLocalizedString("chartBuilder.groupCategories"),handler:function(){var F=actuate.widget.ComponentMgr.get("actuate_dialog_ChartWoAxisDataTab_agregateExpression");F.setDisabled(this.checked?false:true);F.setValue(this.checked?"Sum":"");C._eh_changeXGroupOn();}}]},{id:this.id+"_xGroupOn_items",items:[{width:197,xtype:"label",text:actuate.util.Utility.getLocalizedString("chartBuilder.timeInterval")},{width:220,id:this.id+"_xGroupOn",xtype:"combo",editable:false,forceSelection:true,valueField:"value",displayField:"text",store:this._xGroupOnStore}]}]};this._componentArray.push(E);var D={xtype:"fieldset",collapsible:true,autoHeight:true,title:actuate.util.Utility.getLocalizedString("chartBuilder.value"),checkboxToggle:false,defaults:{border:false,header:false,layout:"column",bodyStyle:"padding:2px 4px 2px 4px"},listeners:{collapse:function(){if(C._parentDialog&&C._parentDialog.adjustSize){C._parentDialog.adjustSize();}},expand:function(){if(C._parentDialog&&C._parentDialog.adjustSize){C._parentDialog.adjustSize();}}},items:[{items:[{columnWidth:0.37,xtype:"label",style:"height:1px",text:""},{columnWidth:0.3,xtype:"label",text:actuate.util.Utility.getLocalizedString("chartBuilder.selectvalue")},{columnWidth:0.02,xtype:"label",style:"height:1px"},{id:this.id+"_aggrExprLabel",columnWidth:0.25,xtype:"label",text:actuate.util.Utility.getLocalizedString("chartBuilder.aggregateExpression")}]},{items:[{columnWidth:0.37,xtype:"label",text:actuate.util.Utility.getLocalizedString("chartBuilder.series")},{columnWidth:0.3,id:"actuate_dialog_ChartWoAxisDataTab_valueCombo",xtype:"treecombo",editable:false,forceSelection:true,valueField:"valueDefinitionValue",displayField:"valueDefinitionText",viewWidth:250,titleField:"title",autoExpand:true,showTooltip:true,icons:this.__icons,store:new actuate.widget.custom.TreeCombo.TreeComboStore(this._valueDefinitionStore2)},{columnWidth:0.02,xtype:"label",style:"height:1px"},{columnWidth:0.25,id:"actuate_dialog_ChartWoAxisDataTab_agregateExpression",xtype:"combo",editable:false,disabled:false,forceSelection:true,value:"Sum",store:[["Sum",actuate.util.Utility.getLocalizedString("chartBuilder.agregateExpressionSum")],["Average",actuate.util.Utility.getLocalizedString("chartBuilder.agregateExpressionAverage")],["Count",actuate.util.Utility.getLocalizedString("chartBuilder.agregateExpressionCount")],["DistinctCount",actuate.util.Utility.getLocalizedString("chartBuilder.agregateExpressionDistinctCount")],["Min",actuate.util.Utility.getLocalizedString("chartBuilder.agregateExpressionMin")],["Max",actuate.util.Utility.getLocalizedString("chartBuilder.agregateExpressionMax")],["First",actuate.util.Utility.getLocalizedString("chartBuilder.agregateExpressionFirst")],["Last",actuate.util.Utility.getLocalizedString("chartBuilder.agregateExpressionLast")]]}]}]};this._componentArray.push(D);var B={xtype:"fieldset",collapsible:true,autoHeight:true,title:actuate.util.Utility.getLocalizedString("chartBuilder.tooltip"),checkboxToggle:false,defaults:{border:false,header:false,layout:"column",bodyStyle:"padding:2px 4px 2px 4px"},listeners:{collapse:function(){if(C._parentDialog&&C._parentDialog.adjustSize){C._parentDialog.adjustSize();}},expand:function(){if(C._parentDialog&&C._parentDialog.adjustSize){C._parentDialog.adjustSize();}}},items:[{items:[{columnWidth:0.37,id:"actuate_dialog_ChartWoAxisDataTab_ShowTooltip",xtype:"checkbox",checked:true,boxLabel:actuate.util.Utility.getLocalizedString("chartBuilder.tooltip"),handler:function(){var F=actuate.widget.ComponentMgr.get("actuate_dialog_ChartWoAxisDataTab_TooltipValue");F.setDisabled(this.checked?false:true);}},{columnWidth:0.43,id:"actuate_dialog_ChartWoAxisDataTab_TooltipValue",xtype:"treecombo",editable:false,style:"width:170px",forceSelection:true,disabled:false,value:"",valueField:"valueDefinitionValue",displayField:"valueDefinitionText",titleField:"title",autoExpand:true,showTooltip:true,icons:this.__icons,store:new actuate.widget.custom.TreeCombo.TreeComboStore(this._valueDefinitionStoreTooltip)}]}]};this._componentArray.push(B);},_eh_changeXGroupOn:function(){this._xGroupOn.clear();var B=this._queryTreeComboRecord(this._categoryCombo,this._getTreeComboValue(this._categoryCombo));var C=B?B.data.valueDefinitionType:"";if(this._isXGroupOn.checked&&("date-time"==C||"datetime"==C||"date"==C||"time"==C)){if("date-time"==C||"datetime"==C){var A=new this._xGroupOnStore.recordType({value:"Years",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.year")});this._xGroupOnStore.add(A);var A=new this._xGroupOnStore.recordType({value:"Quarters",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.quarter")});this._xGroupOnStore.add(A);var A=new this._xGroupOnStore.recordType({value:"Months",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.month")});this._xGroupOnStore.add(A);var A=new this._xGroupOnStore.recordType({value:"Weeks",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.week")});this._xGroupOnStore.add(A);var A=new this._xGroupOnStore.recordType({value:"Days",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.day")});this._xGroupOnStore.add(A);var A=new this._xGroupOnStore.recordType({value:"Hours",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.hour")});this._xGroupOnStore.add(A);var A=new this._xGroupOnStore.recordType({value:"Minutes",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.minute")});this._xGroupOnStore.add(A);var A=new this._xGroupOnStore.recordType({value:"Seconds",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.second")});this._xGroupOnStore.add(A);}else{if("date"==C){var A=new this._xGroupOnStore.recordType({value:"Years",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.year")});this._xGroupOnStore.add(A);var A=new this._xGroupOnStore.recordType({value:"Quarters",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.quarter")});this._xGroupOnStore.add(A);var A=new this._xGroupOnStore.recordType({value:"Months",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.month")});this._xGroupOnStore.add(A);var A=new this._xGroupOnStore.recordType({value:"Weeks",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.week")});this._xGroupOnStore.add(A);var A=new this._xGroupOnStore.recordType({value:"Days",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.day")});this._xGroupOnStore.add(A);}else{if("time"==C){var A=new this._xGroupOnStore.recordType({value:"Hours",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.hour")});this._xGroupOnStore.add(A);var A=new this._xGroupOnStore.recordType({value:"Minutes",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.minute")});this._xGroupOnStore.add(A);var A=new this._xGroupOnStore.recordType({value:"Seconds",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.second")});this._xGroupOnStore.add(A);}}}this._xGroupOn.setSelectedIndex(0);this._xGroupOn_items.show(true);this._parentDialog._fixDropShadow();}else{this._xGroupOn_items.hide();this._parentDialog._fixDropShadow();}},_eh_datasetComboChange:function(){this.__selectionChangedHandler();},__onSelectDataSource:function(){this.__clearFilter();var A=this.__getSelectedDataSourceInfo();if(A&&A[1]){if(A[3]&&A[3].type=="cube"){this._isXGroupOn.setDisabled(true);this._isXGroupOn.setValue(false);}else{if(A[3]&&A[3].type=="dataset"){this._isXGroupOn.setDisabled(false);this._isXGroupOn.setValue(true);}}}this._clearFilterUI=true;this._keepCubeHierarchy.setValue((this._isDataCubeSelected()||this._isDataModelSelected())?true:false);this.showCubeHierarchyOption((this._isDataCubeSelected()||this._isDataModelSelected())?true:false);this._resetAllTreeCombo();actuate.dialog.impl.helper.chartbuilder.ChartWoAxisDataTab.superclass.__onSelectDataSource.call(this);},_resetAllTreeCombo:function(){var F=this.__dataSourceCombo.getValue();var E={id:"none",strong:true,value:"",text:""};var D={id:"default1",value:"",strong:true,text:actuate.util.Utility.getLocalizedString("chartBuilder.tooltip.default")};var C={id:"default2",value:"categoryData",strong:true,text:actuate.util.Utility.getLocalizedString("chartBuilder.tooltip.categoryData")};var B={id:"default3",value:"valueSeriesName",strong:true,text:actuate.util.Utility.getLocalizedString("chartBuilder.tooltip.valueSeriesName")};var A={id:"default4",value:"valueData",strong:true,text:actuate.util.Utility.getLocalizedString("chartBuilder.tooltip.valueData")};this._valueDefinitionStore.removeAll();this._valueDefinitionStore2.removeAll();this._valueDefinitionStoreTooltip.removeAll();this.__addDataIntoTreeStore(E,this._valueDefinitionStore);this.__addDataIntoTreeStore(E,this._valueDefinitionStore2);this.__addDataIntoTreeStore(D,this._valueDefinitionStoreTooltip);this.__addDataIntoTreeStore(C,this._valueDefinitionStoreTooltip);this.__addDataIntoTreeStore(B,this._valueDefinitionStoreTooltip);this.__addDataIntoTreeStore(A,this._valueDefinitionStoreTooltip);this.__setTreeStoreValues(this._valueDefinitionStore,F,["category","column","dimension"]);this.__setTreeStoreValues(this._valueDefinitionStore2,F,["category","column","measure"]);this.__setTreeStoreValues(this._valueDefinitionStoreTooltip,F,["category","column"]);if(this._isDataModelSelected()){this._categoryCombo.expandDeep=1;this._valueCombo.expandDeep=1;this._tooltipValue.expandDeep=1;}else{this._categoryCombo.expandDeep=null;this._valueCombo.expandDeep=null;this._tooltipValue.expandDeep=null;}this._categoryCombo.refresh();this._valueCombo.refresh();this._tooltipValue.refresh();this._categoryCombo.setValueById("none");this._valueCombo.setValueById("none");this._tooltipValue.setValueById("default1");},storeUIData:function(B){var A=actuate.dialog.impl.helper.chartbuilder.ChartWoAxisDataTab.superclass.storeUIData.call(this);this._uiData.dataManagerSoap=A.dataManagerSoap;this._uiData.newDataMarts=A.newDataMarts;this._uiData.DataSet=A.DataSet;this._uiData.Cube=A.Cube;this._uiData.DataMarts=A.DataMarts;this._uiData.xAxisSeries={};this._uiData.xAxisSeries.name=this._getTreeComboValue(this._categoryCombo);this._uiData.xAxisSeries.isGroupOnX=this._isXGroupOn.getValue();this._uiData.keepCubeHierarchy=this._keepCubeHierarchy.getValue();if(this._isXGroupOn.getValue()){var C=this._queryTreeComboRecord(this._categoryCombo,this._getTreeComboValue(this._categoryCombo));var D=C?C.data.valueDefinitionType:"";if("date-time"==D||"datetime"==D||"date"==D||"time"==D){this._uiData.xAxisSeries.groupOn=this._xGroupOn.getValue();}}this._uiData.yAxisSeries=new Array();this._uiData.yAxisSeries[0]={};this._uiData.yAxisSeries[0].name=this._getTreeComboValue(this._valueCombo);this._uiData.yAxisSeries[0].aggregate=this._agregateExpression.getValue();this._uiData.yAxisSeries[0].groupOn=false;this._uiData.yAxisSeries[1]={};if(this._showTooltip.getValue()){this._uiData.tooltip={};this._uiData.tooltip.tooltip=this._getTreeComboValue(this._tooltipValue);}if(B==null){B={};}B.dataTab=this._uiData;this._uiData={};return B;},loadData:function(E){this._xGroupOn_items.hide();if(E.Element&&E.Element.iid){this._selectedIid=E.Element.iid;}else{this._selectedIid=null;}var I=[];if(E.DataMarts){this._data=E;this._clearControls();this.__showAllDataSources(null,E.newDataMarts);}if(E.DataSet&&E.DataSet.dataMart){this.__selectDataSource(E.DataSet,"dataset");this.__onSelectDataSource();}else{if(E.Cube&&E.Cube.dataMart){this.__selectDataSource(E.Cube,"cube");this.__onSelectDataSource();}else{this._tooltipValue.setSelectedIndex(0);}}this._eh_datasetComboChange();if(E.Filter){this._filter=E.Filter;}if(E.xAxisSeries){this.__setTreeComboValue(this._categoryCombo,this.convertExpression(E.xAxisSeries.name));this._isXGroupOn.setValue(E.xAxisSeries.isGroupOnX);if(E.xAxisSeries.isGroupOnX==true){var A=this._queryTreeComboRecord(this._categoryCombo,E.xAxisSeries.name);var C=A?A.data.valueDefinitionType:"";if("date-time"==C||"datetime"==C||"date"==C||"time"==C){this._eh_changeXGroupOn();var F=this._xGroupOnStore.query("value",E.xAxisSeries.groupOn).itemAt(0);if(F){this._xGroupOn.setValue(E.xAxisSeries.groupOn);}}}}if(E.tooltip){if(E.tooltip.tooltip!=undefined){this._showTooltip.setValue(true);this.__setTreeComboValue(this._tooltipValue,E.tooltip.tooltip);}else{this._showTooltip.setValue(false);}}if(E.yAxisSeries){var B=E.yAxisSeries;if(B){if(B[0]){this.__setTreeComboValue(this._valueCombo,this.convertExpression(B[0].name));var H=this._getTreeComboValue(this._valueCombo);if(!B[0].aggregate){if(this._isXGroupOn.checked){this._agregateExpression.setValue("Sum");this._agregateExpression.setDisabled(false);}else{this._agregateExpression.setValue("");this._agregateExpression.setDisabled(true);}}else{if(B[0].name==""){this._agregateExpression.setValue("Sum");}else{this._agregateExpression.setValue(B[0].aggregate);}}}}}var D=null;if(E.Base!=null&&E.Base.copyHyperlink!=null){D=E.Base.copyHyperlink=="true"?true:false;}if(this._hyperlinkCheckbox.disabled!=true){if(D==true){this._hyperlinkCheckbox.setValue(true);}else{if(D==false){this._hyperlinkCheckbox.setValue(false);}}}else{this._hyperlinkCheckbox.setValue(false);}if(E.dataManagerSoap){this._dataManagerSoap=E.dataManagerSoap;}var G=null;if(E.Base!=null&&E.Base.keepCubeHierarchy!=null){G=E.Base.keepCubeHierarchy?true:false;}else{if(E.keepCubeHierarchy!=null){G=E.keepCubeHierarchy?true:false;}}if(G==true){this._keepCubeHierarchy.setValue(true);}else{this._keepCubeHierarchy.setValue(false);}},_afterHide:function(){this._clearControls();this._dataManagerSoap=null;this._uiData={};},_clearControls:function(){this.__dataSourceCombo.clear();this.__clearFilter();this._dataManagerSoap=null;this._clearSubControls();this._agregateExpression.setSelectedIndex(0);this._hyperlinkCheckbox.setValue(true);this._hyperlinkCheckbox.setDisabled(false);this._selectedIid=null;this._keepCubeHierarchy.setValue(false);this.showCubeHierarchyOption(false);},_clearSubControls:function(){this._categoryCombo.clear();this._valueCombo.clear();this._tooltipValue.clear();this._xGroupOn.clear();this._isXGroupOn.setDisabled(false);this._isXGroupOn.setValue(true);this._showTooltip.setValue(true);this._xGroupOn_items.hide();this._agregateExpression.setDisabled(false);this._agregateExpression.setSelectedIndex(0);},_changeFilterPanel:function(B){if(this._parentDialog._filterPanel){var C={};var A=this.__getSelectedDataSourceInfo();if(A){C.dataObject=[A[1],A[4],A[3]];C.dataObjectSoap=this.createDataSetSoap(A);C.dataMartSoap=this._dataManagerSoap;C.clearFilterUI=this._clearFilterUI;C.target="FlashCharts";}if(this._filter){C.Filter=this._filter;}this._parentDialog._filterPanel.loadData(C);}},_updateFilter:function(B,A){this._filterSoap=B;this._clearFilterUI=false;},_rightButtonClick:function(){var A=this._itemsTree.getSelectionModel().getSelectedNode();if(A&&!this._selectedList.contains(A.id)){this._selectedList.add([A.id,A.text]);if(A.nextSibling){A.nextSibling.select();}else{if(A.previousSibling){A.previousSibling.select();}}this._itemsTree.getRootNode().firstChild.removeChild(A);}},_leftButtonClick:function(){var A=this._selectedList.getSelectedIndex();if(A!=-1){var C=-1;if(this._selectedList.getValueAt(A+1)){C=A+1;}else{if(this._selectedList.getValueAt(A-1)){C=A-1;}}var B=this._selectedList.store[A];this._itemsTree.getRootNode().firstChild.appendChild({id:B[0],text:B[1]});this._selectedList.setSelectedIndex(C);this._selectedList.remove(B[0]);}},validate:function(){var B=this._isDataCubeSelected();var C=this._isDataSetSelected();if(!(B||C)){actuate.widget.MessageBox.show({title:actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.alertTitle"),msg:actuate.util.Utility.getLocalizedString("common.dataTab.noDataSourceError"),buttons:actuate.widget.MessageBox.OK});return false;}if(!this._getTreeComboValue(this._categoryCombo)){actuate.widget.MessageBox.show({title:actuate.util.Utility.getLocalizedString("chartBuilder.alertTitle"),msg:actuate.util.Utility.getLocalizedString("chartBuilder.noCategoryError"),buttons:actuate.widget.MessageBox.OK});return false;}if(!this._getTreeComboValue(this._valueCombo)){actuate.widget.MessageBox.show({title:actuate.util.Utility.getLocalizedString("chartBuilder.alertTitle"),msg:actuate.util.Utility.getLocalizedString("chartBuilder.noSliceValueError"),buttons:actuate.widget.MessageBox.OK});return false;}else{if(!this.isExpression(this._getTreeComboValue(this._valueCombo))){var A=this._getFieldDataType(this._getTreeComboValue(this._valueCombo));if(!(A=="integer"||A=="float"||A=="decimal")&&this._isXGroupOn.checked&&!(this._agregateExpression.getValue()=="Count"||this._agregateExpression.getValue()=="DistinctCount")){actuate.widget.MessageBox.show({title:actuate.util.Utility.getLocalizedString("chartBuilder.alertTitle"),msg:actuate.util.Utility.getLocalizedString("chartBuilder.yAggregationError"),buttons:actuate.widget.MessageBox.OK});return false;}if(!(A=="integer"||A=="float"||A=="decimal")&&!this._isXGroupOn.checked){actuate.widget.MessageBox.show({title:actuate.util.Utility.getLocalizedString("chartBuilder.alertTitle"),msg:actuate.util.Utility.getLocalizedString("chartBuilder.yAggregationError"),buttons:actuate.widget.MessageBox.OK});return false;}}}return true;},_getFieldDataType:function(K){var J=this.__getSelectedDataSourceInfo();if(J){var A=J[1].dimensions;if(A){for(var H=0;H<A.length;H++){var L=A[H].levels;if(L){for(var G=0;G<L.length;G++){if(L[G].dataType=="integer"&&L[G].attributes&&L[G].attributes.length>0){for(var D=0;D<L[G].attributes.length;D++){var E=L[G].attributes[D];if(E&&E.name=="DateTime"&&(E.dataType=="date"||E.dataType=="time"||E.dataType=="datetime"||E.dataType=="date-time")){if('data["'+E.fullName+'"]'==K){return E.dataType;}}}}if('data["'+L[G].fullName+'"]'==K){return L[G].dataType;}}}}}var C=J[1].measures;if(C){for(var H=0;H<C.length;H++){var I=C[H].measures;if(I){for(var G=0;G<I.length;G++){if('data["'+C[H].name+"/"+I[G].name+'"]'==K){return I[G].dataType;}}}}}var F=J[1].columns;if(F){for(var H=0;H<F.length;H++){var B=F[H].name;if(F[H].type=="attribute"){B=F[H].fullName;}if('row["'+B+'"]'==K){return F[H].dataType;}}}}return"";},_getFieldDispalyName:function(I){var H=this.__getSelectedDataSourceInfo();if(H){var A=H[1].dimensions;if(A){for(var F=0;F<A.length;F++){var J=A[F].levels;if(J){for(var E=0;E<J.length;E++){if('data["'+J[E].fullName+'"]'==I){return J[E].displayName;}}}}}var C=H[1].measures;if(C){for(var F=0;F<C.length;F++){var G=C[F].measures;if(G){for(var E=0;E<G.length;E++){if('data["'+C[F].name+"/"+G[E].name+'"]'==I){return G[E].displayName;}}}}}var D=H[1].columns;if(D){for(var F=0;F<D.length;F++){var B=D[F].name;if(D[F].type=="attribute"){B=D[F].fullName;}if('row["'+B+'"]'==I){return D[F].displayName;}}}}return"";},createDataSetSoap:function(){var F=actuate.util.XmlDom.createXMLDom(actuate.util.Constants.soap.NAMESPACE_ACTUATE10,actuate.Constant.tag.Data);var G=this.__getSelectedDataSourceInfo();if(G){var D=G[0];var J=G[1].name;var H=G[2];}if(G[1].dimensions){E=actuate.util.XmlDom.createElement(F,"Cube");var B=actuate.util.XmlDom.createElement(F,"Name");var C=F.createTextNode(J);B.appendChild(C);E.appendChild(B);}else{var E=actuate.util.XmlDom.createElement(F,"DataSetDef");var B=actuate.util.XmlDom.createElement(F,"Name");var C=F.createTextNode(J);B.appendChild(C);E.appendChild(B);}var A=actuate.util.XmlDom.createElement(F,"DataSource");if(D){var K=actuate.util.XmlDom.createElement(F,"DisplayName");K.appendChild(F.createTextNode(D));A.appendChild(K);}var I=actuate.util.XmlDom.createElement(F,"DataMartName");C=F.createTextNode(H);I.appendChild(C);A.appendChild(I);E.appendChild(A);return E;},createSoapNode:function(R,H){if(H){if(this._selectedIid){H.documentElement.setAttribute("iid",this._selectedIid);}var m=actuate.util.XmlDom.createElement(H,"DataBinding");var T=actuate.util.XmlDom.createElement(H,"X-axis");var e=actuate.util.XmlDom.createElement(H,"DataMartData");T.appendChild(e);var U=actuate.util.XmlDom.createElement(H,"DataField");var N=H.createTextNode(this._getTreeComboValue(this._categoryCombo));U.appendChild(N);e.appendChild(U);var J=actuate.util.XmlDom.createElement(H,"DataType");var N=H.createTextNode(this._getFieldDataType(this._getTreeComboValue(this._categoryCombo)));J.appendChild(N);e.appendChild(J);var Y=actuate.util.XmlDom.createElement(H,"DisplayName");var N=H.createTextNode(this._getFieldDispalyName(this._getTreeComboValue(this._categoryCombo)));Y.appendChild(N);e.appendChild(Y);m.appendChild(T);var I=actuate.util.XmlDom.createElement(H,"Y-axis");var e=actuate.util.XmlDom.createElement(H,"DataMartData");I.appendChild(e);var U=actuate.util.XmlDom.createElement(H,"DataField");var N=H.createTextNode(this._getTreeComboValue(this._valueCombo));U.appendChild(N);e.appendChild(U);var J=actuate.util.XmlDom.createElement(H,"DataType");var N=H.createTextNode(this._getFieldDataType(this._getTreeComboValue(this._valueCombo)));J.appendChild(N);e.appendChild(J);var Y=actuate.util.XmlDom.createElement(H,"DisplayName");var N=H.createTextNode(this._getFieldDispalyName(this._getTreeComboValue(this._valueCombo)));Y.appendChild(N);e.appendChild(Y);if(this._isXGroupOn.checked){var Z=actuate.util.XmlDom.createElement(H,"Aggregate");var j=actuate.util.XmlDom.createElement(H,"Func");var N=H.createTextNode(this._agregateExpression.getValue());j.appendChild(N);Z.appendChild(j);e.appendChild(Z);}m.appendChild(I);var i=this.__getSelectedDataSourceInfo();var Q=i[0];var E=i[2];if(i[1].dimensions){var O=actuate.util.XmlDom.createElement(H,"CubeName");var N=H.createTextNode(i[1].name);O.appendChild(N);m.appendChild(O);}if(i[1].columns){var O=actuate.util.XmlDom.createElement(H,"DataSetName");var N=H.createTextNode(i[1].name);O.appendChild(N);m.appendChild(O);}var n=actuate.util.XmlDom.createElement(H,"ShowTooltip");var h=H.createTextNode(this._showTooltip.checked?"true":"false");n.appendChild(h);m.appendChild(n);var c=actuate.util.XmlDom.createElement(H,"TooltipValue");var e=actuate.util.XmlDom.createElement(H,"DataMartData");c.appendChild(e);var U=actuate.util.XmlDom.createElement(H,"DataField");var N=H.createTextNode(this._getTreeComboValue(this._tooltipValue));U.appendChild(N);e.appendChild(U);var J=actuate.util.XmlDom.createElement(H,"DataType");var a="";if(this._getTreeComboValue(this._tooltipValue)=="categoryData"){a=this._getFieldDataType(this._getTreeComboValue(this._categoryCombo));}else{if(this._getTreeComboValue(this._tooltipValue)=="valueSeriesName"){}else{if(this._getTreeComboValue(this._tooltipValue)=="valueData"){a=this._getFieldDataType(this._getTreeComboValue(this._valueCombo));}else{a=this._getFieldDataType(this._getTreeComboValue(this._tooltipValue));}}}var N=H.createTextNode(a);J.appendChild(N);e.appendChild(J);m.appendChild(c);var S;var M=R.getElementsByTagName(actuate.Constant.tag.Apperance);if(M==null||M.length==0){S=actuate.util.XmlDom.createElement(H,actuate.Constant.tag.Apperance);R.appendChild(S);}else{S=M[0];}if(Q){var d=actuate.util.XmlDom.createElement(H,"DataSourceName");var N=H.createTextNode(Q);d.appendChild(N);m.appendChild(d);}var X=actuate.util.XmlDom.createElement(H,"DataMartName");var N=H.createTextNode(E);X.appendChild(N);R.appendChild(X);var k=i[4];if(k){var A=(k.toLowerCase()=="data")?actuate.dialog.impl.constant.DataMartAccessType.LATEST:actuate.dialog.impl.constant.DataMartAccessType.TRANSIENT;var P=actuate.util.XmlDom.createElement(H,"DataMartAccessType");P.appendChild(H.createTextNode(A));R.appendChild(P);}var S;var M=R.getElementsByTagName(actuate.Constant.tag.Apperance);if(M==null||M.length==0){S=actuate.util.XmlDom.createElement(H,actuate.Constant.tag.Apperance);R.appendChild(S);}else{S=M[0];}var g=actuate.util.XmlDom.createElement(H,"GroupingAtX");var N=H.createTextNode(this._isXGroupOn.checked?"true":"false");g.appendChild(N);S.appendChild(g);if(this._isXGroupOn.checked){var D=actuate.util.XmlDom.createElement(H,"XGroupingOn");var N=H.createTextNode(this._xGroupOn.getValue());D.appendChild(N);S.appendChild(D);}var V=actuate.util.XmlDom.createElement(H,"YAxes");S.appendChild(V);var b=actuate.util.XmlDom.createElement(H,"YAxis");V.appendChild(b);R.appendChild(m);}this.__addFilterSoap(H.documentElement);var L=actuate.util.XmlDom.createElement(H,actuate.Constant.tag.Json);H.documentElement.appendChild(L);if(this._dataManagerSoap!=null&&this._dataManagerSoap.childNodes){var K=this._dataManagerSoap.childNodes[0].data;var W=K.substr(0,K.length-1)+",";var l=H.createTextNode(W);L.appendChild(l);}if(this._keepCubeHierarchy.disabled==false){var F=actuate.util.Json;var f="KeepCubeHierarchy:";if(L.childNodes.length==0){f="{KeepCubeHierarchy:";}var G={};G.value=this._keepCubeHierarchy.getValue().toString();f+=F.makeMap(G)+",";var B=H.createTextNode(f);L.appendChild(B);}if(this._hyperlinkCheckbox.disabled==false){var F=actuate.util.Json;var f="UseHyperlink:";if(L.childNodes.length==0){f="{UseHyperlink:";}var G={};G.value=this._hyperlinkCheckbox.getValue().toString();f+=F.makeMap(G)+"}";var C=H.createTextNode(f);L.appendChild(C);}else{var f=null;if(L.childNodes.length!=0){f="}";}else{f="{}";}var C=H.createTextNode(f);L.appendChild(C);}},getDataSelection:function(){var A=this.__getSelectedDataSourceInfo();if(A&&A[1]){return{dataSourceName:A[1].name,type:A[3].type};}return null;},setAggrExprVisibility:function(A){if(A){this._aggrExprLabel.show();this._agregateExpression.show();}else{this._aggrExprLabel.hide();this._agregateExpression.hide();}},showCubeHierarchyOption:function(A){if(A){this._keepCubeHierarchy.show();}else{this._keepCubeHierarchy.hide();}},__addDataIntoTreeStore:function(C,A){if(A&&C&&!(C.value&&C.value.dataType=="blob")){if(A==this._valueDefinitionStore){var B=C.value;if(B&&B.type=="column"&&this._isSummaryTable&&!B.isDimension){return ;}}C.valueDefinitionValue=C;C.valueDefinitionText=C.text;C.valueDefinitionType=this._getDataType(C);C.title=this._getTooltip(C);C.dimension=this._getDimension(C);C.hasAction=this._hasAction(C);C.isDimension=this._isDimension(C);C.disabled=this._isDisabled(C,A);A.add(new A.recordType(C,C.id));}},_isDisabled:function(B,A){if(actuate.dialog.impl.helper.chartbuilder.ChartWoAxisDataTab.superclass._isDisabled.apply(this,arguments)){return true;}if(this._isSummaryTable&&B.type=="column"){if(A==this._valueDefinitionStore){return !B.isDimension;}else{if(A==this._valueDefinitionStore2){return B.isDimension;}}}return false;},_getTreeComboValueByRecord:function(B){var A;if(B){A=B.value;}if(B&&B.value&&B.value.type){var E=B.value;switch(E.type){case"attribute":var F=E.fullName;if(F){F=F.replace(/\"/g,'\\"');A='row["'+F+'"]';}break;case"column":var C=E.name;if(C){C=C.replace(/\"/g,'\\"');A='row["'+C+'"]';}break;case"level":if(E.dataType!="blob"){levelFullName=E.fullName;if(E.dataType=="integer"&&E.attributes&&E.attributes.length>0){for(var G=0;G<E.attributes.length;G++){var D=E.attributes[G];if(D&&D.name=="DateTime"&&(D.dataType=="date"||D.dataType=="time"||D.dataType=="datetime"||D.dataType=="date-time")){levelFullName=D.fullName;break;}}}A='data["'+levelFullName+'"]';}break;case"measure":if(E.dataType!="blob"){A='data["'+E.groupName+"/"+E.name+'"]';}break;default:A=E.name;break;}}return A;},_eh_onBeforeSelect:function(B,A){if(A&&A.data&&A.data.valueDefinitionValue){return actuate.dialog.impl.helper.chartbuilder.ChartWoAxisDataTab.superclass._eh_onBeforeSelect.call(this,B,A.data.valueDefinitionValue.node);}return true;}});