actuate.util.Package.define("actuate.dialog.impl.helper.selectorbuilder");actuate.dialog.impl.helper.selectorbuilder.SelectorCalendarFormatTab=actuate.Class.extendClass(actuate.dialog.impl.helper.selectorbuilder.SelectorFormatTab,{_classname:"actuate.dialog.SelectorCalendarFormatTab",_initPanel:function(){var F=this;var G=[];var B=actuate.util.Utility;var A=B.getLocalizedString("dateFormat.shortDate");var C={xtype:"fieldset",collapsible:true,autoHeight:true,title:B.getLocalizedString("selectorBuilder.formatTab.values"),checkboxToggle:false,defaults:{border:false,header:false,layout:"column",bodyStyle:"padding:2px 4px 2px 4px"},listeners:{collapse:function(){if(F._parentDialog&&F._parentDialog.adjustSize){F._parentDialog.adjustSize();}},expand:function(){if(F._parentDialog&&F._parentDialog.adjustSize){F._parentDialog.adjustSize();}}},items:[{items:[{id:"actuate_dialog_selectorCalendarFormatTab_range_auto",xtype:"checkbox",hideLabel:true,boxLabel:actuate.util.Utility.getLocalizedString("selectorBuilder.formatTab.range.auto"),checked:true,hidden:true}]},{items:[{width:150,xtype:"label",text:B.getLocalizedString("selectorBuilder.formatTab.values.default")},{width:150,id:"actuate_dialog_selectorCalendarFormatTab_default_value_text",xtype:"datefield",format:A,readOnly:true}]},{items:[{width:150,xtype:"label",text:B.getLocalizedString("selectorBuilder.formatTab.startDate")},{width:150,id:"actuate_dialog_selectorCalendarFormatTab_startDate_text",xtype:"datefield",format:A,readOnly:true}]},{items:[{width:150,xtype:"label",text:B.getLocalizedString("selectorBuilder.formatTab.endDate")},{width:150,id:"actuate_dialog_selectorCalendarFormatTab_endDate_text",xtype:"datefield",format:A,readOnly:true}]},this.__getFormattingComponent()]};G.push(C);this._panel=new actuate.widget.panel.Panel({header:false,plain:true,border:false,title:B.getLocalizedString("selectorBuilder.formatTab.format"),autoHeight:true,items:G});this._defaultValueText=actuate.widget.ComponentMgr.get("actuate_dialog_selectorCalendarFormatTab_default_value_text");this._defaultValueLabel=actuate.widget.ComponentMgr.get("selectorBuilder.formatTab.values.default");this._startDateText=actuate.widget.ComponentMgr.get("actuate_dialog_selectorCalendarFormatTab_startDate_text");this._endDateText=actuate.widget.ComponentMgr.get("actuate_dialog_selectorCalendarFormatTab_endDate_text");this._chkAutoRange=actuate.widget.ComponentMgr.get("actuate_dialog_selectorCalendarFormatTab_range_auto");var D=[this._defaultValueText,this._startDateText,this._endDateText];for(var E=0;E<D.length;E++){var H=D[E];H.pickerConfig=B.getLocalizedStrings("DatePicker",["okText","cancelText","todayText","minText","maxText","disabledDaysText","disabledDatesText","nextText","prevText","monthYearText"]);actuate.Class.extend(H,B.getLocalizedStrings("DateField",["disabledDaysText","disabledDatesText","minText","maxText","invalidText"]));}this._chkAutoRange.registerEventHandler("check",actuate.Method.bind(this._autoRangeUpdated,this),false);this.on("fieldchanged",actuate.Method.bind(this._noBindingChangedHandler,this));},_initializeControlStatus:function(){this._validateControlArray=[];this._validateControlArray.push(this._txtValueLimit);},_autoRangeUpdated:function(){if(this._chkAutoRange.getValue()==true){this._startDateText.disable();this._endDateText.disable();}else{this._startDateText.enable();this._endDateText.enable();}},validate:function(){var B;var A=this._startDateText.getValue();var D=this._endDateText.getValue();var C=this._defaultValueText.getValue();if((!A&&!this._startDateText.disabled)||(!D&&!this._endDateText.disabled)){B=actuate.util.Utility.getLocalizedString("selectorBuilder.formatTab.date.startEndDateEmptyError");}if(!this._chkAutoRange.getValue()){if(A&&D){if(D.getTime()<A.getTime()){B=actuate.util.Utility.getLocalizedString("selectorBuilder.formatTab.date.startEndDateError");}}}if(C){if((A&&C.getTime()<A.getTime())||(D&&C.getTime()>D.getTime())){B=actuate.util.Utility.getLocalizedString("selectorBuilder.formatTab.date.defaultDateRangeError");}}if(B!=null){actuate.widget.MessageBox.alert(actuate.util.Utility.getLocalizedString("selectorDialog.alertTitle"),B);return false;}return true;},loadData:function(A){actuate.dialog.impl.helper.selectorbuilder.SelectorCalendarFormatTab.superclass.loadData.apply(this,arguments);if(A&&A.parameter){this._defaultValueText.setValue(A.parameter.defaultValue);}if(!A||!A.Base||A.Base.type!="calendar"){return ;}var C=A.Base.binding;var B=A.Format;if(!B){this._setDefaultValues();return ;}if(B.defaultValue!=null){this._defaultValueText.setValue(this._parseDate(B.defaultValue));}if(B.autoRange&&B.autoRange!=undefined){this._chkAutoRange.setValue(true,true);this._startDateText.setValue(null);this._endDateText.setValue(null);this._startDateText.disable();this._endDateText.disable();}else{this._chkAutoRange.setValue(false,true);this._startDateText.enable();this._endDateText.enable();if(B.startDate!=null){this._startDateText.setValue(this._parseDate(B.startDate));}if(B.endDate!=null){this._endDateText.setValue(this._parseDate(B.endDate));}}if(this._parentDialog._consumer&&this._parentDialog._consumer._service._instanceId){if(this._defaultValueText&&this._defaultValueText.getValue()){if(this._labelfaultValue){this._labelfaultValue.disable();}this._defaultValueText.disable();}}},_setDefaultValues:function(){this._defaultValueText.enable();this._defaultValueText.setValue(null);this._startDateText.setValue(null);this._endDateText.setValue(null);this._chkAutoRange.setValue(true,true);this._startDateText.disable();this._endDateText.disable();},createJsonData:function(){var A={};if(!this._chkAutoRange.getValue()){A.startDate=this._formatDate(this._startDateText.getValue());A.endDate=this._formatDate(this._endDateText.getValue());A.autoRange=false;}else{A.autoRange=true;}A.defaultValue=this._formatDate(this._defaultValueText.getValue());return{Format:A};},_formatDate:function(A){if(!A){return null;}return A.format(actuate.util.Constants.LOCALE_NEUTRAL_DATE_FORMAT);},_parseDate:function(A){if(!A||typeof (A)!="string"){return null;}return actuate.util.Date.parseDate(A,actuate.util.Constants.LOCALE_NEUTRAL_DATE_FORMAT);},_noBindingChangedHandler:function(B){if(B&&B.noBinding!=undefined){var A=B&&B.noBinding;this._chkAutoRange.setValue(!A,true);this._startDateText.setDisabled(!A);this._endDateText.setDisabled(!A);}},setControlType:function(A){this._setDefaultValues();},_dataFormatHandler:function(A){if(A){A.type="datetimeformat";}actuate.dialog.impl.helper.selectorbuilder.SelectorCalendarFormatTab.superclass._dataFormatHandler.apply(this,arguments);}});