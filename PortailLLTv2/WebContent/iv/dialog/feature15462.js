actuate.util.Package.define("actuate.dialog.impl.helper.chartbuilder");actuate.dialog.impl.helper.chartbuilder.ParentChartWithAxisDataTab=actuate.Class.extendClass(actuate.dialog.impl.helper.AbstractDataTabDialog,{_showTooltip:null,_selectedIid:null,_uiData:{},_valueDefinitionStore1:null,_valueDefinitionStore2:null,_valueDefinitionStore3:null,_valueDefinitionStore4:null,_valueDefinitionStore5:null,_valueDefinitionStore6:null,_valueDefinitionStore7:null,_valueDefinitionStore8:null,initialize:function(){if(this.__extending){return ;}this._title=actuate.util.Utility.getLocalizedString("chartBuilder.data");actuate.dialog.impl.helper.AbstractTabDialog.prototype.initialize.call(this);this._dataFieldSet=actuate.widget.ComponentMgr.get(this.id+"_dataFieldSet");this.__initDataSourceCombo();this._showTooltip=actuate.widget.ComponentMgr.get(this.id+"_ShowTooltip");this._tooltipValue=actuate.widget.ComponentMgr.get(this.id+"_TooltipValue");this._xGroupOn=actuate.widget.ComponentMgr.get(this.id+"_xGroupOn");this._yGroup=actuate.widget.ComponentMgr.get(this.id+"_yGroup");this._yGroupOn=actuate.widget.ComponentMgr.get(this.id+"_yGroupOn");this._categoryXCombo=actuate.widget.ComponentMgr.get(this.id+"_categoryXCombo");this._categoryXLabel=actuate.widget.ComponentMgr.get(this.id+"_categoryXLabel");this._isXGroupOn=actuate.widget.ComponentMgr.get(this.id+"_isXGroupOn");this._xGroupOn_items=actuate.widget.ComponentMgr.get(this.id+"_xGroupOn_items");this._yGroupOn_items=actuate.widget.ComponentMgr.get(this.id+"_yGroupOn_items");this._eh_changeXGroupOn_c=actuate.Method.bind(this._eh_changeXGroupOn,this);this._categoryXCombo.registerEventHandler("select",this._eh_changeXGroupOn_c);this._eh_changeYGroupOn_c=actuate.Method.bind(this._eh_changeYGroupOn,this);this._yGroup.registerEventHandler("select",this._eh_changeYGroupOn_c);this._hyperlinkCheckbox=actuate.widget.ComponentMgr.get(this.id+"_hyperlinkCheckbox");this._keepCubeHierarchy=actuate.widget.ComponentMgr.get(this.id+"_keepCubeHierarchy");this._eh_datasetComboChange_c=actuate.Method.bind(this._eh_datasetComboChange,this);this.__dataSourceCombo.registerEventHandler("change",this._eh_datasetComboChange_c);var A=actuate.Method.bind(this._eh_onBeforeSelect,this);this._categoryXCombo.registerEventHandler("beforeselect",A);this._yGroup.registerEventHandler("beforeselect",A);this._tooltipValue.registerEventHandler("beforeselect",A);},__createDataSourceCombo:function(){return actuate.widget.ComponentMgr.get(this.id+"_dataSetCombo");},_initContent:function(){var E=this;this._componentArray=[];var E=this;this._valueDefinitionStore=new actuate.widget.data.SimpleStore({fields:["valueDefinitionValue","valueDefinitionText","title","valueDefinitionType","hasAction"]});this._valueDefinitionStoreTooltip=new actuate.widget.data.SimpleStore({fields:["valueDefinitionValue","valueDefinitionText","title","valueDefinitionType"]});var C={xtype:"fieldset",collapsible:true,title:actuate.util.Utility.getLocalizedString("chartBuilder.data"),checkboxToggle:false,defaults:{border:false,layout:"column"},cls:"actuate-widget-panle-zero-margin-top",id:this.id+"_dataFieldSet",listeners:{collapse:function(){if(E._parentDialog&&E._parentDialog.adjustSize){E._parentDialog.adjustSize();}},expand:function(){if(E._parentDialog&&E._parentDialog.adjustSize){E._parentDialog.adjustSize();}}},items:[{layout:"column",bodyStyle:"padding:4px 4px 4px 4px",items:[{layout:"form",border:false,labelWidth:190,items:[{id:this.id+"_dataSetCombo",width:320,fieldLabel:actuate.util.Utility.getLocalizedString("chartBuilder.useDataFrom"),xtype:"treecombo",editable:false,forceSelection:true,autoExpand:true,valueField:"value",displayField:"title",titleField:"title",icons:this.__dataSourceIcons,sortInfo:{folderSort:true,field:"text",direction:"ASC"},showTooltip:true,store:new actuate.widget.custom.TreeCombo.TreeComboStore(this.__dataSourceComboStore),style:"margin-right:3px"}]}]},{items:[{columnWidth:0.37,id:this.id+"_hyperlinkCheckbox",xtype:"checkbox",checked:true,boxLabel:actuate.util.Utility.getLocalizedString("common.dataTab.useHyperlink"),handler:function(){}},{columnWidth:0.37,id:this.id+"_keepCubeHierarchy",xtype:"checkbox",checked:false,boxLabel:actuate.util.Utility.getLocalizedString("common.dataTab.keepCubeHierarchy"),handler:function(){}}]}]};this._componentArray.push(C);this._xGroupOnStore=new actuate.widget.data.SimpleStore({fields:["value","text"]});var F={id:this.id+"_categoryXTitle",xtype:"fieldset",collapsible:true,autoHeight:true,title:actuate.util.Utility.getLocalizedString("chartBuilder.categories"),checkboxToggle:false,defaults:{border:false,header:false,layout:"column",bodyStyle:"padding:4px 4px 4px 4px"},listeners:{collapse:function(){if(E._parentDialog&&E._parentDialog.adjustSize){E._parentDialog.adjustSize();}},expand:function(){if(E._parentDialog&&E._parentDialog.adjustSize){E._parentDialog.adjustSize();}}},items:[{items:[{columnWidth:0.37,id:this.id+"_categoryXLabel",xtype:"label",style:"height:1px",text:actuate.util.Utility.getLocalizedString("chartBuilder.date")},{columnWidth:0.6,id:this.id+"_categoryXCombo",xtype:"treecombo",editable:false,forceSelection:true,valueField:"valueDefinitionValue",displayField:"valueDefinitionText",titleField:"title",autoExpand:true,showTooltip:true,icons:this.__icons,store:new actuate.widget.custom.TreeCombo.TreeComboStore(this._valueDefinitionStore)}]},{items:[{columnWidth:0.37,xtype:"label",style:"height:1px"},{columnWidth:0.605,id:this.id+"_isXGroupOn",xtype:"checkbox",checked:true,boxLabel:actuate.util.Utility.getLocalizedString("chartBuilder.groupCategories"),handler:function(){E._agregateExpressionHandler(this);E._eh_changeXGroupOn();}}]},{id:this.id+"_xGroupOn_items",items:[{columnWidth:0.37,xtype:"label",text:actuate.util.Utility.getLocalizedString("chartBuilder.timeInterval")},{columnWidth:0.4,id:this.id+"_xGroupOn",xtype:"combo",editable:false,forceSelection:true,valueField:"value",displayField:"text",store:this._xGroupOnStore},{columnWidth:0.2,xtype:"label",style:"height:1px"}]}]};this._componentArray.push(F);this._aggregationExpressionStore=new actuate.widget.data.SimpleStore({fields:["value","text"]});var B=new this._aggregationExpressionStore.recordType({value:"Sum",text:actuate.util.Utility.getLocalizedString("chartBuilder.agregateExpressionSum")});this._aggregationExpressionStore.add(B);B=new this._aggregationExpressionStore.recordType({value:"Average",text:actuate.util.Utility.getLocalizedString("chartBuilder.agregateExpressionAverage")});this._aggregationExpressionStore.add(B);B=new this._aggregationExpressionStore.recordType({value:"Count",text:actuate.util.Utility.getLocalizedString("chartBuilder.agregateExpressionCount")});this._aggregationExpressionStore.add(B);B=new this._aggregationExpressionStore.recordType({value:"DistinctCount",text:actuate.util.Utility.getLocalizedString("chartBuilder.agregateExpressionDistinctCount")});this._aggregationExpressionStore.add(B);B=new this._aggregationExpressionStore.recordType({value:"Min",text:actuate.util.Utility.getLocalizedString("chartBuilder.agregateExpressionMin")});this._aggregationExpressionStore.add(B);B=new this._aggregationExpressionStore.recordType({value:"Max",text:actuate.util.Utility.getLocalizedString("chartBuilder.agregateExpressionMax")});this._aggregationExpressionStore.add(B);B=new this._aggregationExpressionStore.recordType({value:"First",text:actuate.util.Utility.getLocalizedString("chartBuilder.agregateExpressionFirst")});this._aggregationExpressionStore.add(B);B=new this._aggregationExpressionStore.recordType({value:"Last",text:actuate.util.Utility.getLocalizedString("chartBuilder.agregateExpressionLast")});this._aggregationExpressionStore.add(B);var A=this._initYAxisContent();this._componentArray.push(A);var D={xtype:"fieldset",collapsible:true,autoHeight:true,title:actuate.util.Utility.getLocalizedString("chartBuilder.tooltip"),checkboxToggle:false,defaults:{border:false,header:false,layout:"column",bodyStyle:"padding:2px 4px 2px 4px"},listeners:{collapse:function(){if(E._parentDialog&&E._parentDialog.adjustSize){E._parentDialog.adjustSize();}},expand:function(){if(E._parentDialog&&E._parentDialog.adjustSize){E._parentDialog.adjustSize();}}},items:[{items:[{columnWidth:0.2,id:this.id+"_ShowTooltip",xtype:"checkbox",checked:true,boxLabel:actuate.util.Utility.getLocalizedString("chartBuilder.tooltip"),handler:function(){E._tooltipValue.setDisabled(this.checked?false:true);}},{columnWidth:0.6,id:this.id+"_TooltipValue",xtype:"treecombo",editable:false,style:"width:170px",forceSelection:true,disabled:false,valueField:"valueDefinitionValue",displayField:"valueDefinitionText",titleField:"title",autoExpand:true,showTooltip:true,icons:this.__icons,store:new actuate.widget.custom.TreeCombo.TreeComboStore(this._valueDefinitionStoreTooltip)}]}]};this._componentArray.push(D);},_agregateExpressionHandler:function(A){},_initYAxisContent:function(){return null;},_eh_changeYGroupOn:function(){this._yGroupOn.clear();var B=this._queryTreeComboRecord(this._yGroup,this._getTreeComboValue(this._yGroup));var C=B?B.data.valueDefinitionType:"";if("date-time"==C||"datetime"==C||"date"==C||"time"==C){if("date-time"==C||"datetime"==C){var A=new this._yGroupOnStore.recordType({value:"Years",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.year")});this._yGroupOnStore.add(A);var A=new this._yGroupOnStore.recordType({value:"Quarters",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.quarter")});this._yGroupOnStore.add(A);var A=new this._yGroupOnStore.recordType({value:"Months",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.month")});this._yGroupOnStore.add(A);var A=new this._yGroupOnStore.recordType({value:"Weeks",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.week")});this._yGroupOnStore.add(A);var A=new this._yGroupOnStore.recordType({value:"Days",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.day")});this._yGroupOnStore.add(A);var A=new this._yGroupOnStore.recordType({value:"Hours",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.hour")});this._yGroupOnStore.add(A);var A=new this._yGroupOnStore.recordType({value:"Minutes",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.minute")});this._yGroupOnStore.add(A);var A=new this._yGroupOnStore.recordType({value:"Seconds",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.second")});this._yGroupOnStore.add(A);}else{if("date"==C){var A=new this._yGroupOnStore.recordType({value:"Years",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.year")});this._yGroupOnStore.add(A);var A=new this._yGroupOnStore.recordType({value:"Quarters",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.quarter")});this._yGroupOnStore.add(A);var A=new this._yGroupOnStore.recordType({value:"Months",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.month")});this._yGroupOnStore.add(A);var A=new this._yGroupOnStore.recordType({value:"Weeks",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.week")});this._yGroupOnStore.add(A);var A=new this._yGroupOnStore.recordType({value:"Days",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.day")});this._yGroupOnStore.add(A);}else{if("time"==C){var A=new this._yGroupOnStore.recordType({value:"Hours",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.hour")});this._yGroupOnStore.add(A);var A=new this._yGroupOnStore.recordType({value:"Minutes",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.minute")});this._yGroupOnStore.add(A);var A=new this._yGroupOnStore.recordType({value:"Seconds",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.second")});this._yGroupOnStore.add(A);}}}this._yGroupOn.setSelectedIndex(0);this._yGroupOn_items.show(true);}else{this._yGroupOn_items.hide();}},_eh_changeXGroupOn:function(){this._xGroupOn.clear();this._filter_y_group();var C=this._queryTreeComboRecord(this._categoryXCombo,this._getTreeComboValue(this._categoryXCombo));var D=C?C.data.valueDefinitionType:"";var B={value:{dataType:D,category:"Unformatted"}};this.fireEvent("xaxischanged",{format:B});if(this._isXGroupOn.checked&&("date-time"==D||"datetime"==D||"date"==D||"time"==D)){if("date-time"==D||"datetime"==D){var A=new this._xGroupOnStore.recordType({value:"Years",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.year")});this._xGroupOnStore.add(A);var A=new this._xGroupOnStore.recordType({value:"Quarters",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.quarter")});this._xGroupOnStore.add(A);var A=new this._xGroupOnStore.recordType({value:"Months",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.month")});this._xGroupOnStore.add(A);var A=new this._xGroupOnStore.recordType({value:"Weeks",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.week")});this._xGroupOnStore.add(A);var A=new this._xGroupOnStore.recordType({value:"Days",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.day")});this._xGroupOnStore.add(A);var A=new this._xGroupOnStore.recordType({value:"Hours",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.hour")});this._xGroupOnStore.add(A);var A=new this._xGroupOnStore.recordType({value:"Minutes",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.minute")});this._xGroupOnStore.add(A);var A=new this._xGroupOnStore.recordType({value:"Seconds",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.second")});this._xGroupOnStore.add(A);}else{if("date"==D){var A=new this._xGroupOnStore.recordType({value:"Years",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.year")});this._xGroupOnStore.add(A);var A=new this._xGroupOnStore.recordType({value:"Quarters",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.quarter")});this._xGroupOnStore.add(A);var A=new this._xGroupOnStore.recordType({value:"Months",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.month")});this._xGroupOnStore.add(A);var A=new this._xGroupOnStore.recordType({value:"Weeks",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.week")});this._xGroupOnStore.add(A);var A=new this._xGroupOnStore.recordType({value:"Days",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.day")});this._xGroupOnStore.add(A);}else{if("time"==D){var A=new this._xGroupOnStore.recordType({value:"Hours",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.hour")});this._xGroupOnStore.add(A);var A=new this._xGroupOnStore.recordType({value:"Minutes",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.minute")});this._xGroupOnStore.add(A);var A=new this._xGroupOnStore.recordType({value:"Seconds",text:actuate.util.Utility.getLocalizedString("chartBuilder.dialog.intervalType.second")});this._xGroupOnStore.add(A);}}}this._xGroupOn.setSelectedIndex(0);this._xGroupOn_items.show(true);this._parentDialog._fixDropShadow();}else{this._xGroupOn_items.hide();this._parentDialog._fixDropShadow();}},_filter_y_group:function(){var D=this._queryTreeComboRecord(this._categoryXCombo,this._getTreeComboValue(this._categoryXCombo));if(this._isDataCubeSelected()){if(D&&D.id!="none"){var C=D.get("dimension");var B=this._valueDefinitionStoreGroupBy;B.clearFilter(true);B.filterBy(function(E){return E.get("id")!=C;});this._yGroup.refresh();if(this._getTreeComboValue(this._yGroup)){var A=this._queryTreeComboRecord(this._yGroup,this._getTreeComboValue(this._yGroup));if(A&&A.get("dimension")==C){this._yGroup.setValueById("none");}}}}},_eh_datasetComboChange:function(){this.__selectionChangedHandler();},__onSelectDataSource:function(){this.__clearFilter();var A=this.__getSelectedDataSourceInfo();if(A&&A[1]){if(A[1].columns){this._xGroupOn.setValue("");this._yGroupOn_items.hide();}var B=A[1].measures;if(B){this._xGroupOn.setValue("");this._yGroupOn_items.hide();}if(A[3]&&A[3].type=="cube"){this._isXGroupOn.setDisabled(true);this._isXGroupOn.setValue(false);}else{if(A[3]&&A[3].type=="dataset"){this._isXGroupOn.setDisabled(false);this._isXGroupOn.setValue(true);}}}this._clearFilterUI=true;this._keepCubeHierarchy.setValue((this._isDataCubeSelected()||this._isDataModelSelected())?true:false);this.showCubeHierarchyOption((this._isDataCubeSelected()||this._isDataModelSelected())?true:false);this._resetAllTreeCombo();actuate.dialog.impl.helper.chartbuilder.ParentChartWithAxisDataTab.superclass.__onSelectDataSource.call(this);},_resetAllTreeCombo:function(){var F=this.__dataSourceCombo.getValue();var E={id:"none",strong:true,value:"",text:""};var D={id:"default1",value:"",strong:true,text:actuate.util.Utility.getLocalizedString("chartBuilder.tooltip.default")};var C={id:"default2",value:"categoryData",strong:true,text:actuate.util.Utility.getLocalizedString("chartBuilder.tooltip.categoryData")};var B={id:"default3",value:"valueSeriesName",strong:true,text:actuate.util.Utility.getLocalizedString("chartBuilder.tooltip.valueSeriesName")};var A={id:"default4",value:"valueData",strong:true,text:actuate.util.Utility.getLocalizedString("chartBuilder.tooltip.valueData")};this._valueDefinitionStore.removeAll();this._valueDefinitionStoreTooltip.removeAll();this.__addDataIntoTreeStore(E,this._valueDefinitionStore);this.__addDataIntoTreeStore(D,this._valueDefinitionStoreTooltip);this.__addDataIntoTreeStore(C,this._valueDefinitionStoreTooltip);this.__addDataIntoTreeStore(B,this._valueDefinitionStoreTooltip);this.__addDataIntoTreeStore(A,this._valueDefinitionStoreTooltip);this.__setTreeStoreValues(this._valueDefinitionStore,F,["category","column","dimension"]);this.__setTreeStoreValues(this._valueDefinitionStoreTooltip,F,["category","column"]);if(this._isDataModelSelected()){this._categoryXCombo.expandDeep=1;this._tooltipValue.expandDeep=1;}else{this._categoryXCombo.expandDeep=null;this._tooltipValue.expandDeep=null;}this._categoryXCombo.refresh();this._tooltipValue.refresh();this._categoryXCombo.setValueById("none");this._tooltipValue.setValueById("default1");},storeUIData:function(B){var A=actuate.dialog.impl.helper.chartbuilder.ParentChartWithAxisDataTab.superclass.storeUIData.call(this);this._uiData.dataManagerSoap=A.dataManagerSoap;this._uiData.newDataMarts=A.newDataMarts;this._uiData.DataSet=A.DataSet;this._uiData.Cube=A.Cube;this._uiData.xAxisSeries={};this._uiData.xAxisSeries.name=this._getTreeComboValue(this._categoryXCombo);this._uiData.xAxisSeries.isGroupOnX=this._isXGroupOn.getValue();this._uiData.keepCubeHierarchy=this._keepCubeHierarchy.getValue();if(this._isXGroupOn.getValue()){var C=this._queryTreeComboRecord(this._categoryXCombo,this._getTreeComboValue(this._categoryXCombo));var D=C?C.data.valueDefinitionType:"";if("date-time"==D||"datetime"==D||"date"==D||"time"==D){this._uiData.xAxisSeries.groupOn=this._xGroupOn.getValue();}}if(this._showTooltip.getValue()){this._uiData.tooltip={};this._uiData.tooltip.tooltip=this._getTreeComboValue(this._tooltipValue);}if(B==null){B={};}B.dataTab=this._uiData;this._uiData={};return B;},loadData:function(E){this._xGroupOn_items.hide();this._yGroupOn_items.hide();if(this.id.indexOf("Stock")>0){this._categoryXLabel.enable();this._categoryXLabel.setText(actuate.util.Utility.getLocalizedString("chartBuilder.date"));}else{this._categoryXLabel.disable();this._categoryXLabel.setText("");}if(E.Element&&E.Element.iid){this._selectedIid=E.Element.iid;}else{this._selectedIid=null;}var C=[];if(E.DataMarts){this._data=E;this._clearControls();this.__showAllDataSources(null,E.newDataMarts);}if(E.DataSet&&E.DataSet.dataMart){this.__selectDataSource(E.DataSet,"dataset");this.__onSelectDataSource();}else{if(E.Cube&&E.Cube.dataMart){this.__selectDataSource(E.Cube,"cube");this.__onSelectDataSource();}else{this._tooltipValue.setValueById("default1");}}this._eh_datasetComboChange();if(E.Filter){this._filter=E.Filter;}if(E.xAxisSeries){this.__setTreeComboValue(this._categoryXCombo,this.convertExpression(E.xAxisSeries.name));var F=this._queryTreeComboRecord(this._categoryXCombo,E.xAxisSeries.name);if(F){this.__setTreeComboValue(this._categoryXCombo,E.xAxisSeries.name);}else{if(!this.isExpression(this.convertExpression(E.xAxisSeries.name))){var B=this._valueDefinitionStore.getAt(0);if(B){this.__setTreeComboValue(this._categoryXCombo,B.data.valueDefinitionValue);}else{this._categoryXCombo.setValueById("none");}}}this._isXGroupOn.setValue(E.xAxisSeries.isGroupOnX);this._eh_changeXGroupOn();if(E.xAxisSeries.isGroupOnX==true){var F=this._queryTreeComboRecord(this._categoryXCombo,E.xAxisSeries.name);var H=F?F.data.valueDefinitionType:"";var D=this._xGroupOnStore.query("value",E.xAxisSeries.groupOn).itemAt(0);if(D){this._xGroupOn.setValue(this.convertExpression(E.xAxisSeries.groupOn));}}}this._loadYAxisData(E);if(E.tooltip){if(E.tooltip.tooltip!=undefined){this._showTooltip.setValue(true);this.__setTreeComboValue(this._tooltipValue,E.tooltip.tooltip);}else{this._showTooltip.setValue(false);}}var G=null;if(E.Base!=null&&E.Base.copyHyperlink!=null){G=E.Base.copyHyperlink=="true"?true:false;}if(G==true){this._hyperlinkCheckbox.setValue(true);}else{if(G==false){this._hyperlinkCheckbox.setValue(false);}}if(E.dataManagerSoap){this._dataManagerSoap=E.dataManagerSoap;}var A=null;if(E.Base!=null&&E.Base.keepCubeHierarchy!=null){A=E.Base.keepCubeHierarchy?true:false;}else{if(E.keepCubeHierarchy!=null){A=E.keepCubeHierarchy?true:false;}}if(A==true){this._keepCubeHierarchy.setValue(true);}else{this._keepCubeHierarchy.setValue(false);}},_loadYAxisData:function(A){},_afterHide:function(){this._clearControls();this._dataManagerSoap=null;this._uiData={};},_clearControls:function(){this.__dataSourceCombo.clear();this.__clearFilter();this._filter=null;this._clearSubControls();this._selectedIid=null;this._hyperlinkCheckbox.enable();this._hyperlinkCheckbox.setValue(true);this._keepCubeHierarchy.setValue(false);this.showCubeHierarchyOption(false);},_clearSubControls:function(){this._categoryXCombo.clear();this._yGroup.clear();this._xGroupOn.clear();this._tooltipValue.clear();this._yGroupOn.clear();this._isXGroupOn.setDisabled(false);this._isXGroupOn.setValue(true);this._showTooltip.setValue(true);this._xGroupOn_items.hide();this._yGroupOn_items.hide();},_changeFilterPanel:function(B){if(this._parentDialog._filterPanel){var C={};var A=this.__getSelectedDataSourceInfo();if(A){C.dataObject=[A[1],A[4],A[3]];C.dataObjectSoap=this.createDataSetSoap(A);C.dataMartSoap=this._dataManagerSoap;C.clearFilterUI=this._clearFilterUI;C.target="FlashCharts";}if(this._filter){C.Filter=this._filter;}this._parentDialog._filterPanel.loadData(C);}},_rightButtonClick:function(){var A=this._itemsTree.getSelectionModel().getSelectedNode();if(A&&!this._selectedList.contains(A.id)){this._selectedList.add([A.id,A.text]);if(A.nextSibling){A.nextSibling.select();}else{if(A.previousSibling){A.previousSibling.select();}}this._itemsTree.getRootNode().firstChild.removeChild(A);}},_leftButtonClick:function(){var A=this._selectedList.getSelectedIndex();if(A!=-1){var C=-1;if(this._selectedList.getValueAt(A+1)){C=A+1;}else{if(this._selectedList.getValueAt(A-1)){C=A-1;}}var B=this._selectedList.store[A];this._itemsTree.getRootNode().firstChild.appendChild({id:B[0],text:B[1]});this._selectedList.setSelectedIndex(C);this._selectedList.remove(B[0]);}},validate:function(){var A=this._isDataCubeSelected();var B=this._isDataSetSelected();if(!(A||B)){actuate.widget.MessageBox.show({title:actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.alertTitle"),msg:actuate.util.Utility.getLocalizedString("common.dataTab.noDataSourceError"),buttons:actuate.widget.MessageBox.OK});return false;}if(!this._getTreeComboValue(this._categoryXCombo)){actuate.widget.MessageBox.show({title:actuate.util.Utility.getLocalizedString("chartBuilder.alertTitle"),msg:actuate.util.Utility.getLocalizedString("chartBuilder.noCategoryError"),buttons:actuate.widget.MessageBox.OK});return false;}if(this._getTreeComboValue(this._categoryXCombo)==this._getTreeComboValue(this._yGroup)&&!this.isExpression(this._getTreeComboValue(this._categoryXCombo))){actuate.widget.MessageBox.show({title:actuate.util.Utility.getLocalizedString("chartBuilder.alertTitle"),msg:actuate.util.Utility.getLocalizedString("chartBuilder.yGroupCantEqualToX"),buttons:actuate.widget.MessageBox.OK});return false;}return true;},_getDataSetFieldDataType:function(E){var A=this.__getSelectedDataSourceInfo();if(A){var D=A[1].columns;if(D){for(var C=0;C<D.length;C++){var B=D[C].name;if(D[C].type=="attribute"){B=D[C].fullName;}if('row["'+B+'"]'==E){return D[C].dataType;}}}}return"";},_getYAxisDataType:function(F){var A=this.__getSelectedDataSourceInfo();if(A){var E=A[1].measures;if(E){for(var C=0;C<E.length;C++){var D=E[C].measures;if(D){for(var B=0;B<D.length;B++){if('data["'+E[C].name+"/"+D[B].name+'"]'==F){return D[B].dataType;}}}}}return this._getDataSetFieldDataType(F);}return"";},_getXAxisDataType:function(H){var A=this.__getSelectedDataSourceInfo();if(A){var E=A[1].dimensions;if(E){for(var D=0;D<E.length;D++){var F=E[D].levels;if(F){for(var B=0;B<F.length;B++){if(F[B].dataType=="integer"&&F[B].attributes&&F[B].attributes.length>0){for(var G=0;G<F[B].attributes.length;G++){var C=F[B].attributes[G];if(C&&C.name=="DateTime"&&(C.dataType=="date"||C.dataType=="time"||C.dataType=="datetime"||C.dataType=="date-time")){if('data["'+C.fullName+'"]'==H){return C.dataType;}}}}if('data["'+F[B].fullName+'"]'==H){return F[B].dataType;}}}}}return this._getDataSetFieldDataType(H);}return"";},_getFieldDispalyName:function(I){var H=this.__getSelectedDataSourceInfo();if(H){var A=H[1].dimensions;if(A){for(var F=0;F<A.length;F++){var J=A[F].levels;if(J){for(var E=0;E<J.length;E++){if('data["'+J[E].fullName+'"]'==I){return J[E].displayName;}}}}}var C=H[1].measures;if(C){for(var F=0;F<C.length;F++){var G=C[F].measures;if(G){for(var E=0;E<G.length;E++){if('data["'+C[F].name+"/"+G[E].name+'"]'==I){return G[E].displayName;}}}}}var D=H[1].columns;if(D){for(var F=0;F<D.length;F++){var B=D[F].name;if(D[F].type=="attribute"){B=D[F].fullName;}if('row["'+B+'"]'==I){return D[F].displayName;}}}}return"";},createDataSetSoap:function(){var F=actuate.util.XmlDom.createXMLDom(actuate.util.Constants.soap.NAMESPACE_ACTUATE10,actuate.Constant.tag.Data);var G=this.__getSelectedDataSourceInfo();var D=G[0];var J=G[1].name;var H=G[2];if(G[1].dimensions){E=actuate.util.XmlDom.createElement(F,"Cube");var B=actuate.util.XmlDom.createElement(F,"Name");var C=F.createTextNode(J);B.appendChild(C);E.appendChild(B);}else{var E=actuate.util.XmlDom.createElement(F,"DataSetDef");var B=actuate.util.XmlDom.createElement(F,"Name");var C=F.createTextNode(J);B.appendChild(C);E.appendChild(B);}var A=actuate.util.XmlDom.createElement(F,"DataSource");if(D){var K=actuate.util.XmlDom.createElement(F,"DisplayName");K.appendChild(F.createTextNode(D));A.appendChild(K);}var I=actuate.util.XmlDom.createElement(F,"DataMartName");C=F.createTextNode(H);I.appendChild(C);A.appendChild(I);E.appendChild(A);return E;},createSoapNode:function(S,H){if(H){if(this._selectedIid){H.documentElement.setAttribute("iid",this._selectedIid);}var j=actuate.util.XmlDom.createElement(H,"DataBinding");var U=actuate.util.XmlDom.createElement(H,"X-axis");var d=actuate.util.XmlDom.createElement(H,"DataMartData");U.appendChild(d);var V=actuate.util.XmlDom.createElement(H,"DataField");var N=H.createTextNode(this._getTreeComboValue(this._categoryXCombo));V.appendChild(N);d.appendChild(V);var J=actuate.util.XmlDom.createElement(H,"DataType");var N=H.createTextNode(this._getXAxisDataType(this._getTreeComboValue(this._categoryXCombo)));J.appendChild(N);d.appendChild(J);var a=actuate.util.XmlDom.createElement(H,"DisplayName");var N=H.createTextNode(this._getFieldDispalyName(this._getTreeComboValue(this._categoryXCombo)));a.appendChild(N);d.appendChild(a);j.appendChild(U);this._createYAxisSoapNode(H,j);var g=this.__getSelectedDataSourceInfo();var R=g[0];var E=g[2];if(g[1].dimensions){var P=actuate.util.XmlDom.createElement(H,"CubeName");var N=H.createTextNode(g[1].name);P.appendChild(N);j.appendChild(P);}if(g[1].columns){var P=actuate.util.XmlDom.createElement(H,"DataSetName");var N=H.createTextNode(g[1].name);P.appendChild(N);j.appendChild(P);}this._createTooltipSoapNode(H,j);if(R){var c=actuate.util.XmlDom.createElement(H,"DataSourceName");c.appendChild(H.createTextNode(R));j.appendChild(c);}var Z=actuate.util.XmlDom.createElement(H,"DataMartName");var N=H.createTextNode(E);Z.appendChild(N);S.appendChild(Z);var h=g[4];if(h){var A=(h.toLowerCase()=="data")?actuate.dialog.impl.constant.DataMartAccessType.LATEST:actuate.dialog.impl.constant.DataMartAccessType.TRANSIENT;var Q=actuate.util.XmlDom.createElement(H,"DataMartAccessType");Q.appendChild(H.createTextNode(A));S.appendChild(Q);}var T;var M=S.getElementsByTagName(actuate.Constant.tag.Apperance);if(M==null||M.length==0){T=actuate.util.XmlDom.createElement(H,actuate.Constant.tag.Apperance);S.appendChild(T);}else{T=M[0];}var f=actuate.util.XmlDom.createElement(H,"GroupingAtX");var N=H.createTextNode(this._isXGroupOn.checked?"true":"false");f.appendChild(N);T.appendChild(f);if(this._isXGroupOn.checked){var D=actuate.util.XmlDom.createElement(H,"XGroupingOn");var N=H.createTextNode(this._xGroupOn.getValue());D.appendChild(N);T.appendChild(D);}var W=actuate.util.XmlDom.createElement(H,"YAxes");T.appendChild(W);var b=actuate.util.XmlDom.createElement(H,"YAxis");W.appendChild(b);W.appendChild(b);var I=actuate.util.XmlDom.createElement(H,"GroupingAtY");var N=H.createTextNode(this._getTreeComboValue(this._yGroup)?"true":"false");I.appendChild(N);T.appendChild(I);b.appendChild(I);var Y=actuate.util.XmlDom.createElement(H,"YGroupingOn");var N=H.createTextNode(this._getTreeComboValue(this._yGroup));Y.appendChild(N);T.appendChild(Y);b.appendChild(Y);var O=actuate.util.XmlDom.createElement(H,"YGroupingUnit");var N=H.createTextNode(this._yGroupOn.getValue());O.appendChild(N);T.appendChild(O);b.appendChild(O);S.appendChild(j);this.__addFilterSoap(H.documentElement);var L=actuate.util.XmlDom.createElement(H,actuate.Constant.tag.Json);H.documentElement.appendChild(L);if(this._dataManagerSoap!=null&&this._dataManagerSoap.childNodes){var K=this._dataManagerSoap.childNodes[0].data;var X=K.substr(0,K.length-1)+",";var i=H.createTextNode(X);L.appendChild(i);}if(this._keepCubeHierarchy.disabled==false){var F=actuate.util.Json;var e="KeepCubeHierarchy:";if(L.childNodes.length==0){e="{KeepCubeHierarchy:";}var G={};G.value=this._keepCubeHierarchy.getValue().toString();e+=F.makeMap(G)+",";var B=H.createTextNode(e);L.appendChild(B);}if(this._hyperlinkCheckbox.disabled==false){var F=actuate.util.Json;var e="UseHyperlink:";if(L.childNodes.length==0){e="{UseHyperlink:";}var G={};G.value=this._hyperlinkCheckbox.getValue().toString();e+=F.makeMap(G)+"}";var C=H.createTextNode(e);L.appendChild(C);}else{var e=null;if(L.childNodes.length!=0){e="}";}else{e="{}";}var C=H.createTextNode(e);L.appendChild(C);}}},_createYAxisSoapNode:function(B,A){},_createTooltipSoapNode:function(B,A){},getDataSelection:function(){var A=this.__getSelectedDataSourceInfo();if(A&&A[1]){return{dataSourceName:A[1].name,type:A[3].type};}return null;},getTrueFalseLiteral:function(A){if(!A||A=="false"){return"false";}else{return"true";}},showCubeHierarchyOption:function(A){if(A){this._keepCubeHierarchy.show();}else{this._keepCubeHierarchy.hide();}},__addDataIntoTreeStore:function(C,A){if(A&&C&&!(C.value&&C.value.dataType=="blob")){if(A==this._valueDefinitionStore){var B=C.value;if(B&&B.type=="column"&&this._isSummaryTable&&!B.isDimension){return ;}}C.valueDefinitionValue=C;C.valueDefinitionText=C.text;C.valueDefinitionType=this._getDataType(C);C.title=this._getTooltip(C);C.dimension=this._getDimension(C);C.hasAction=this._hasAction(C);C.isDimension=this._isDimension(C);C.disabled=this._isDisabled(C,A);A.add(new A.recordType(C,C.id));}},_isDisabled:function(B,A){if(actuate.dialog.impl.helper.chartbuilder.ParentChartWithAxisDataTab.superclass._isDisabled.apply(this,arguments)){return true;}if(this._isSummaryTable&&B.type=="column"){if(A==this._valueDefinitionStore){return !B.isDimension;}else{if(A==this._valueDefinitionStore1||A==this._valueDefinitionStore2||A==this._valueDefinitionStore3||A==this._valueDefinitionStore4||A==this._valueDefinitionStore5||A==this._valueDefinitionStore6||A==this._valueDefinitionStore7||A==this._valueDefinitionStore8){return B.isDimension;}}}return false;},_getTreeComboValueByRecord:function(B){var A;if(B){A=B.value;}if(B&&B.value&&B.value.type){var E=B.value;switch(E.type){case"attribute":var F=E.fullName;if(F){F=F.replace(/\"/g,'\\"');A='row["'+F+'"]';}break;case"column":var C=E.name;if(C){C=C.replace(/\"/g,'\\"');A='row["'+C+'"]';}break;case"level":if(E.dataType!="blob"){levelFullName=E.fullName;if(E.dataType=="integer"&&E.attributes&&E.attributes.length>0){for(var G=0;G<E.attributes.length;G++){var D=E.attributes[G];if(D&&D.name=="DateTime"&&(D.dataType=="date"||D.dataType=="time"||D.dataType=="datetime"||D.dataType=="date-time")){levelFullName=D.fullName;break;}}}A='data["'+levelFullName+'"]';}break;case"measure":if(E.dataType!="blob"){A='data["'+E.groupName+"/"+E.name+'"]';}break;default:A=E.name;break;}}return A;},_eh_onBeforeSelect:function(B,A){if(A&&A.data&&A.data.valueDefinitionValue){return actuate.dialog.impl.helper.chartbuilder.ParentChartWithAxisDataTab.superclass._eh_onBeforeSelect.call(this,B,A.data.valueDefinitionValue.node);}return true;}});