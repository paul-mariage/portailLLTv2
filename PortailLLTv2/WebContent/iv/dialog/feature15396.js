actuate.util.Package.define("actuate.dialog.impl.helper");actuate.dialog.impl.helper.SelectedFilterDialog=actuate.Class.extendClass(actuate.dialog.impl.helper.AbstractIVDialog,{_classname:"actuate.dialog.SelectedFilterDialog",_width:368,_filterText:"",_whichValue1:false,_whichValue2:false,_htmlElements:{"_filterBy":null,"_advancedFilterButton":null,"_condition":null,"_value1":null,"_textValue1Div":null,"_value1InputDiv":null,"_ListSelectedValues":null,"_DateImg1":null,"_SelectValuesLink1":null,"_SelectValuesLabel1":null,"_anyOfListValuesDiv":null,"_anyOfListValuesLink":null,"_anyOfDeleteValuesLink":null,"_value2":null,"_textValue2Div":null,"_value2InputDiv":null,"_DateImg2":null,"_SelectValuesLink2":null,"_SelectValuesLabel2":null,"_SelectValuesDiv":null,"_filterTextLabel":null,"_FilterText":null,"_FindButton":null,"_FindRow":null,"_ValuesList":null,"_Calendar":null,"_dateTimeFormatDiv":null,"_filterClearLink":null,"_labelPipe":null,"_previous":null,"_next":null,"_recalculateTotalsDiv":null},__neh_value1Change_c:null,__neh_value2Change_c:null,initialize:function(){var B=this._getId(this._classname);this._applyHtmlElementsNames(B);actuate.dialog.impl.helper.AbstractIVDialog.prototype.initialize.call(this,B);this.columnName=null;this.data=null;this.whichButton=null;this.whichDataType=null;this.clearFilterFlag="false";this.valuesLoadedFlag="false";this.textValue=actuate.util.Utility.getLocalizedString("filterDialog.text.value");this.textValueTo=actuate.util.Utility.getLocalizedString("filterDialog.text.valueTo");this.textValueFrom=actuate.util.Utility.getLocalizedString("filterDialog.text.valueFrom");this.textDateValue=actuate.util.Utility.getLocalizedString("filterDialog.text.dateValue");this.textDateValueTo=actuate.util.Utility.getLocalizedString("filterDialog.text.dateValueTo");this.textDateValueFrom=actuate.util.Utility.getLocalizedString("filterDialog.text.dateValueFrom");this.idCalendar=document.getElementById(this._htmlElements["_Calendar"]);this.idDateImg1=document.getElementById(this._htmlElements["_DateImg1"]);this.idDateImg2=document.getElementById(this._htmlElements["_DateImg2"]);this.condition=new actuate.uiadapter.ComboBox({editable:false,width:220});this.condition.render(this._htmlElements["_condition"]);this.previousCondition=null;this.__neh_changeCondition_c=actuate.Method.bind(this.__neh_changeCondition,this);this.condition.registerEventHandler("select",this.__neh_changeCondition_c);this.value1Text=new actuate.uiadapter.TextField({cls:actuate.dialog.impl.constant.CSS_INPUTBOX,width:150});this.value1Text.render(this._htmlElements["_value1InputDiv"]);this.value2Text=new actuate.uiadapter.TextField({cls:actuate.dialog.impl.constant.CSS_INPUTBOX,width:150});this.value2Text.render(this._htmlElements["_value2InputDiv"]);this.__neh_value1Change_c=actuate.Method.bind(this.__neh_value1Change,this);this.__neh_value2Change_c=actuate.Method.bind(this.__neh_value2Change,this);this.value1Text.registerEventHandler("mouseover",actuate.Method.bind(this.__neh_value1Tooltip,this),false);this.value2Text.registerEventHandler("mouseover",actuate.Method.bind(this.__neh_value2Tooltip,this),false);this.value1Text.registerEventHandler("change",this.__neh_value1Change_c,false);this.value2Text.registerEventHandler("change",this.__neh_value2Change_c,false);this.__neh_CalendarClick1_c=actuate.Method.bind2(this.__neh_CalendarClick,this,this.value1Text);actuate.util.Event.observe(this.idDateImg1,"click",this.__neh_CalendarClick1_c,false);this.__neh_CalendarClick2_c=actuate.Method.bind2(this.__neh_CalendarClick,this,this.value2Text);actuate.util.Event.observe(this.idDateImg2,"click",this.__neh_CalendarClick2_c,false);this.idListSelectedValuesDiv=document.getElementById(this._htmlElements["_ListSelectedValues"]);this.idListSelectedValues=new actuate.uiadapter.ListBox({multiSelect:true,width:220,height:50,enableKeyEvents:true,renderTo:this.idListSelectedValuesDiv});var A=this;this.idListSelectedValues.registerEventHandler("keyup",function(D,C){if(C.stopPropagation){C.stopPropagation();}else{C.cancelBubble=true;}if(C.keyCode==C.DELETE){A._neh_DeleteValuesLink();}C.preventDefault();});this.__neh_ListSelectedValuesFocus_c=actuate.Method.bind(this.__neh_ListSelectedValuesFocus,this);this.idListSelectedValues.registerEventHandler("click",this.__neh_ListSelectedValuesFocus_c);this.textValue1Div=document.getElementById(this._htmlElements["_textValue1Div"]);this.textValue2Div=document.getElementById(this._htmlElements["_textValue2Div"]);this.value1InputDiv=document.getElementById(this._htmlElements["_value1InputDiv"]);this.value2InputDiv=document.getElementById(this._htmlElements["_value2InputDiv"]);this.idValue1=document.getElementById(this._htmlElements["_value1"]);this.idValue2=document.getElementById(this._htmlElements["_value2"]);this.resultSetName=document.getElementById(this._htmlElements["_filterBy"]);this.idSelectValuesDiv=document.getElementById(this._htmlElements["_SelectValuesDiv"]);this.idSelectValuesLink1=document.getElementById(this._htmlElements["_SelectValuesLink1"]);this.idSelectValuesLink2=document.getElementById(this._htmlElements["_SelectValuesLink2"]);this.idSelectValuesLabel1=document.getElementById(this._htmlElements["_SelectValuesLabel1"]);this.idSelectValuesLabel2=document.getElementById(this._htmlElements["_SelectValuesLabel2"]);actuate.util.Event.observe(this.idSelectValuesLink1,"click",actuate.Method.bind(this._neh_SelectValuesLink1,this),false);actuate.util.Event.observe(this.idSelectValuesLink2,"click",actuate.Method.bind(this._neh_SelectValuesLink2,this),false);this.idFindRow=document.getElementById(this._htmlElements["_FindRow"]);this.idFilterTextLabel=document.getElementById(this._htmlElements["_filterTextLabel"]);this.idFilterText=new actuate.uiadapter.TextField({cls:actuate.dialog.impl.constant.CSS_INPUTBOX,width:150,name:"filterText"});this.idFilterText.render(this._htmlElements["_FilterText"]);this.idFindButton=new actuate.uiadapter.Button({text:actuate.util.Utility.getLocalizedString("filterDialog.text.find")});this.idFindButton.render(this._htmlElements["_FindButton"]);this.idValuesListDiv=document.getElementById(this._htmlElements["_ValuesList"]);this.idValuesList=new actuate.uiadapter.ListBox({multiSelect:true,width:220,height:100,renderTo:this.idValuesListDiv});this.__neh_FindClick_c=actuate.Method.bind(this.__neh_FindClick,this);this.idFindButton.registerEventHandler("click",this.__neh_FindClick_c,false);this.__neh_ListClick_c=actuate.Method.bind(this.__neh_ListClick,this);this.idValuesList.registerEventHandler("select",this.__neh_ListClick_c);this.__neh_FilterTextChange_c=actuate.Method.bind(this.__neh_FilterTextChange,this);this.idFilterText.registerEventHandler("keypress",this.__neh_FilterTextChange_c,false);this.cal=document.getElementById("outerCalendarDiv");this.idAdvancedFilterLink=document.getElementById(this._htmlElements["_advancedFilterButton"]);actuate.util.Event.observe(this.idAdvancedFilterLink,"click",actuate.Method.bind(this._neh_AdvancedButtonClick,this),false);actuate.util.Event.observe(document.getElementById(this._htmlElements["_filterClearLink"]),"click",actuate.Method.bind(this._neh_clearFilterLink,this),false);this.idLabelPipe=document.getElementById(this._htmlElements["_labelPipe"]);this.textEq=actuate.util.Utility.getLocalizedString("filterDialog.text.Eq");this.textNe=actuate.util.Utility.getLocalizedString("filterDialog.text.Ne");this.textLt=actuate.util.Utility.getLocalizedString("filterDialog.text.Lt");this.textLe=actuate.util.Utility.getLocalizedString("filterDialog.text.Le");this.textGt=actuate.util.Utility.getLocalizedString("filterDialog.text.Gt");this.textGe=actuate.util.Utility.getLocalizedString("filterDialog.text.Ge");this.textBetween=actuate.util.Utility.getLocalizedString("filterDialog.text.Between");this.textNotbetween=actuate.util.Utility.getLocalizedString("filterDialog.text.Notbetween");this.textIsnull=actuate.util.Utility.getLocalizedString("filterDialog.text.Isnull");this.textIsnotnull=actuate.util.Utility.getLocalizedString("filterDialog.text.Isnotnull");this.textIstrue=actuate.util.Utility.getLocalizedString("filterDialog.text.Istrue");this.textIsfalse=actuate.util.Utility.getLocalizedString("filterDialog.text.Isfalse");this.textLike=actuate.util.Utility.getLocalizedString("filterDialog.text.Like");this.textNotLike=actuate.util.Utility.getLocalizedString("filterDialog.text.NotLike");this.textIn=actuate.util.Utility.getLocalizedString("filterDialog.text.In");this.textNotIn=actuate.util.Utility.getLocalizedString("filterDialog.text.NotIn");this.noCondition=actuate.util.Utility.getLocalizedString("filterDialog.text.NoFilterCondition");this.conditionEq=actuate.dialog.impl.constant.DesignChoice.FILTER_OPERATOR_EQ;this.conditionNe=actuate.dialog.impl.constant.DesignChoice.FILTER_OPERATOR_NE;this.conditionLt=actuate.dialog.impl.constant.DesignChoice.FILTER_OPERATOR_LT;this.conditionLe=actuate.dialog.impl.constant.DesignChoice.FILTER_OPERATOR_LE;this.conditionGt=actuate.dialog.impl.constant.DesignChoice.FILTER_OPERATOR_GT;this.conditionGe=actuate.dialog.impl.constant.DesignChoice.FILTER_OPERATOR_GE;this.conditionBetween=actuate.dialog.impl.constant.DesignChoice.FILTER_OPERATOR_BETWEEN;this.conditionNotbetween=actuate.dialog.impl.constant.DesignChoice.FILTER_OPERATOR_NOT_BETWEEN;this.conditionIsnull=actuate.dialog.impl.constant.DesignChoice.FILTER_OPERATOR_NULL;this.conditionIsnotnull=actuate.dialog.impl.constant.DesignChoice.FILTER_OPERATOR_NOT_NULL;this.conditionIstrue=actuate.dialog.impl.constant.DesignChoice.FILTER_OPERATOR_TRUE;this.conditionIsfalse=actuate.dialog.impl.constant.DesignChoice.FILTER_OPERATOR_FALSE;this.conditionLike=actuate.dialog.impl.constant.DesignChoice.FILTER_OPERATOR_LIKE;this.conditionNotLike=actuate.dialog.impl.constant.DesignChoice.FILTER_OPERATOR_NOT_LIKE;this.conditionTopn=actuate.dialog.impl.constant.DesignChoice.FILTER_OPERATOR_TOP_N;this.conditionBottomn=actuate.dialog.impl.constant.DesignChoice.FILTER_OPERATOR_BOTTOM_N;this.conditionToppercent=actuate.dialog.impl.constant.DesignChoice.FILTER_OPERATOR_TOP_PERCENT;this.conditionBottompercent=actuate.dialog.impl.constant.DesignChoice.FILTER_OPERATOR_BOTTOM_PERCENT;this.conditionIn=actuate.dialog.impl.constant.DesignChoice.FILTER_OPERATOR_IN_NEW;this.conditionNotIn=actuate.dialog.impl.constant.DesignChoice.FILTER_OPERATOR_NOT_IN_NEW;this._operatorMap=[];this._operatorMap[this.conditionEq]=this.textEq;this._operatorMap[this.conditionNe]=this.textNe;this._operatorMap[this.conditionLt]=this.textLt;this._operatorMap[this.conditionLe]=this.textLe;this._operatorMap[this.conditionGt]=this.textGt;this._operatorMap[this.conditionGe]=this.textGe;this._operatorMap[this.conditionBetween]=this.textBetween;this._operatorMap[this.conditionNotBetween]=this.textNotbetween;this._operatorMap[this.conditionIsnull]=this.textIsnull;this._operatorMap[this.conditionIsnotnull]=this.textIsnotnull;this._operatorMap[this.conditionIstrue]=this.textIstrue;this._operatorMap[this.conditionIsfalse]=this.textIsfalse;this._operatorMap[this.conditionIsLike]=this.textIsLike;this._operatorMap[this.conditionIsNotLike]=this.textIsNotLike;this._operatorMap[this.conditionIn]=this.textIn;this._operatorMap[this.conditionNotIn]=this.textNotIn;this.MsgNoBlankValue=actuate.util.Utility.getLocalizedString("filterDialog.text.MsgNoBlankValue");this.MsgNumeric=actuate.util.Utility.getLocalizedString("filterDialog.text.MsgNumeric");this.MsgMissingQuotes=actuate.util.Utility.getLocalizedString("filterDialog.text.MsgMissingQuotes");this.ListSelectedValuesCount=null;this.FocusAfterCalendarFlag=false;this.idAnyOfListValuesLink=document.getElementById(this._htmlElements["_anyOfListValuesLink"]);actuate.util.Event.observe(this.idAnyOfListValuesLink,"click",actuate.Method.bind(this._neh_AnyOfSelectValuesLink,this),false);this.idAnyOfDeleteValuesLink=document.getElementById(this._htmlElements["_anyOfDeleteValuesLink"]);actuate.util.Event.observe(this.idAnyOfDeleteValuesLink,"click",actuate.Method.bind(this._neh_DeleteValuesLink,this),false);this.idAnyOfListValuesDiv=document.getElementById(this._htmlElements["_anyOfListValuesDiv"]);this.idDateTimeFormatDiv=document.getElementById(this._htmlElements["_dateTimeFormatDiv"]);this.idPrevious=document.getElementById(this._htmlElements["_previous"]);this.idNext=document.getElementById(this._htmlElements["_next"]);this._previousClick_c=actuate.Method.bind(this._previousClick,this);actuate.util.Event.observe(this.idPrevious,"click",this._previousClick_c,false);this._nextClick_c=actuate.Method.bind(this._nextClick,this);actuate.util.Event.observe(this.idNext,"click",this._nextClick_c,false);this._rowCount=0;this._prevCursor=-1;this._currCursor=-1;this._endOfResultset=false;this.filterList=new actuate.data.FilterLists();this.ivFilter=new actuate.data.Filters();this.recalculateTotals=new actuate.uiadapter.Checkbox({cls:actuate.dialog.impl.constant.CSS_INPUTBOX,boxLabel:actuate.util.Utility.getLocalizedString("filterDialog.text.recalculateTotals"),checked:true});this.recalculateTotals.render(this._htmlElements["_recalculateTotalsDiv"]);},_localBind:function(C,E){if(!C){return ;}this.data=C;if(!C.resultSetData){this.showAdvancedFilterLink(true);if(!E||(this._consumer._helper._dataItem&&this._consumer._helper._dataItem._selectedIId)){this.showAdvancedFilterLink(false);}}var D=C.selectedBinding||C.Binding;var B=C.Filter&&C.Filter.hasAggregation;if(!C.resultSetData&&D&&(D.isLinkedDataModel||D.isSubQuery)&&(B||D.isAggregation)){this.showAdvancedFilterLink(false);}var A=C[actuate.model.Constant.MetadataType.ELEMENT];if(A&&A.type){switch(A.type){case actuate.Constant.element.SUMMARYTABLE:case actuate.Constant.element.TABLE:case actuate.Constant.element.DATAITEM:this.recalculateTotals.show();break;default:this.recalculateTotals.hide();break;}}if(this.whichButton==null){this.resetValues();if(!this._showFilter(C,E)){return true;}this.showSelectValuesLinks();this.showHideDateTimeFormatDiv();}else{if(this.whichButton!=null){this.showData(C);}}this.adjustSize();},_previousClick:function(){if(this.idPrevious.className=="link_disabled"){return ;}if(this._prevCursor>0){if(this.idFilterText.getValue()!=this._filterText){this.__neh_FindClick(null);return ;}var A={name:"FilterText",value:this.idFilterText.getValue()};var C={name:"target",value:this._classname};var D={name:"prevCursor",value:this._prevCursor};var B=[A,C,D];this._showHideFindRow();this._consumer._eventDispatcher.fireEvent(actuate.iv.core.iVEvent.__E_MOREVALUES_FILTER,B);}},_nextClick:function(){if(this.idNext.className=="link_disabled"){return ;}if(this.idFilterText.getValue()!=this._filterText){this.__neh_FindClick(null);return ;}var A={name:"FilterText",value:this.idFilterText.getValue()};var C={name:"target",value:this._classname};var D={name:"currCursor",value:this._currCursor};var B=[A,C,D];this._showHideFindRow();this._consumer._eventDispatcher.fireEvent(actuate.iv.core.iVEvent.__E_MOREVALUES_FILTER,B);},showHideDateTimeFormatDiv:function(){var A="";this.idDateTimeFormatDiv.style.display="none";if(this.whichDataType==actuate.Constant.DataType.DATE){A=actuate.util.Utility.getLocalizedString("filterDialog.text.dateFormatMsg")+" "+actuate.util.Utility.toDate(new Date());this.idDateTimeFormatDiv.style.display="block";}else{if(this.whichDataType==actuate.Constant.DataType.TIME){A=actuate.util.Utility.getLocalizedString("filterDialog.text.timeFormatMsg")+" "+actuate.util.Utility.toTime(new Date());this.idDateTimeFormatDiv.style.display="block";}else{if(this.whichDataType==actuate.Constant.DataType.DATETIME){A=actuate.util.Utility.getLocalizedString("filterDialog.text.dateTimeFormatMsg")+" "+actuate.util.Utility.toDateTime(new Date());this.idDateTimeFormatDiv.style.display="block";}}}this.idDateTimeFormatDiv.innerHTML=A;},_enter_key:function(){if(this.value1Text){if(this.value1Text.hasFocus||(this.value1Text.textfield&&this.value1Text.textfield.hasFocus)){this.__neh_value1Change();}}if(this.value2Text){if(this.value2Text.hasFocus||(this.value2Text.textfield&&this.value2Text.textfield.hasFocus)){this.__neh_value2Change();}}actuate.dialog.impl.helper.SelectedFilterDialog.superclass._enter_key.apply(this,arguments);},_okPress:function(){if(this.condition.getValue()=="clear"){this.__neh_clearFilter();this._hide();return ;}else{var B=false;var D=this.getOperatorAry(this.condition.getValue());var C=this.value1Text.getValue();var A=this.value2Text.getValue();if(this._whichValue1==true){C=this._selectedValue1;}if(this._whichValue2==true){A=this._selectedValue2;}if(D==0){this._whichValue1=false;this._whichValue2=false;this.value1Text.setValue("");this.value2Text.setValue("");this.idListSelectedValues.clear();}else{if(D==1&&(this.whichDataType!=actuate.Constant.DataType.STRING||this.isNumericTypeCondition())){if(!this._whichValue1&&(C==""||C==null)){this._consumer._eventDispatcher.broadcastEvent(actuate.iv.core.iVEvent.__E_WARN,this.MsgNoBlankValue);return ;}this._whichValue2=false;this.value2Text.setValue("");this.idListSelectedValues.clear();}else{if(D==2&&this.whichDataType!=actuate.Constant.DataType.STRING){if((!this._whichValue1&&(C==""||C==null))||(!this._whichValue2&&(A==""||A==null))){this._consumer._eventDispatcher.broadcastEvent(actuate.iv.core.iVEvent.__E_WARN,this.MsgNoBlankValue);return ;}this.idListSelectedValues.clear();}else{if(D==3){if(this.idListSelectedValues.getLength()==0){this._consumer._eventDispatcher.broadcastEvent(actuate.iv.core.iVEvent.__E_WARN,this.MsgNoBlankValue);return ;}this._whichValue1=false;this._whichValue2=false;this.value1Text.setValue("");this.value2Text.setValue("");}}}}this._consumer._eventDispatcher.fireEvent(actuate.iv.core.iVEvent.__E_APPLYFILTER,this.htmlId);this._hide();this.whichButton=null;}},isNumericTypeCondition:function(){if(this.condition.getValue()==this.conditionTopn||this.condition.getValue()==this.conditionBottomn||this.condition.getValue()==this.conditionToppercent||this.condition.getValue()==this.conditionBottompercent){return true;}return false;},__getHelpTopic:function(){return"iv_filter";},_neh_cancel:function(){if(this.clearFilterFlag=="true"){this.value2Text.setValue("");this.value1Text.setValue("");this.condition.setSelectedIndex(0);this.whichButton=null;this._whichValue1=false;this._whichValue2=false;}this._hide();},_preHide:function(){this.whichButton=null;this.filterList.clearFilterList();this.condition.collapse();this.idSelectValuesDiv.style.display="none";this._isSharedBinding=undefined;},resetValues:function(){this.whichButton=null;this.idFilterText.setValue("");this.valuesLoadedFlag="false";this.clearFilterFlag="false";this._rowCount=0;this._prevCursor=-1;this._currCursor=-1;this._endOfResultset=false;this.showHideCalendarDiv(false);this.idValuesList.clear();this.idListSelectedValues.clear();this.idFilterText.hide();},loadConditions:function(){var A=[];var B=actuate.util.Utility.isNumber(this.whichDataType);var C=actuate.util.Utility.isDateDataType(this.whichDataType);var D=(this.whichDataType==actuate.Constant.DataType.BOOLEAN);if(D){A.push([this.conditionIstrue,this.textIstrue]);A.push([this.conditionIsfalse,this.textIsfalse]);}else{A.push([this.conditionEq,this.textEq]);A.push([this.conditionNe,this.textNe]);A.push([this.conditionLt,this.textLt]);A.push([this.conditionLe,this.textLe]);A.push([this.conditionGt,this.textGt]);A.push([this.conditionGe,this.textGe]);A.push([this.conditionBetween,this.textBetween]);A.push([this.conditionNotbetween,this.textNotbetween]);}A.push([this.conditionIsnull,this.textIsnull]);A.push([this.conditionIsnotnull,this.textIsnotnull]);if(!D&&!B&&!C){A.push([this.conditionLike,this.textLike]);A.push([this.conditionNotLike,this.textNotLike]);}A.push([this.conditionIn,this.textIn]);A.push([this.conditionNotIn,this.textNotIn]);if(B){A.push([this.conditionIstrue,this.textIstrue]);A.push([this.conditionIsfalse,this.textIsfalse]);}A.push(["clear",this.noCondition]);this.condition.setStore(A);},_isTopBottomCondition:function(A){return(A==this.conditionTopn||A==this.conditionBottomn||A==this.conditionToppercent||A==this.conditionBottompercent);},__neh_changeCondition:function(C){var D=this.condition.getValue();var B=false;if(this._isTopBottomCondition(D)!=this._isTopBottomCondition(this._previousCondition)){this.value1Text.setValue("");this.value2Text.setValue("");B=true;this._whichValue1=false;this._whichValue2=false;}var A=this.getOperatorAry(D);this.idValuesList.setSelectedIndex();this._showValueGUI(A);if(!B){this._showHideSelectValuesBlock();}this.adjustSize();this._previousCondition=D;},__neh_clearFilter:function(A){this._consumer._eventDispatcher.fireEvent(actuate.iv.core.iVEvent.__E_CLEARFILTER);this.value1Text.setValue("");this.value2Text.setValue("");this.condition.setSelectedIndex(0);this._whichValue1=false;this._whichValue2=false;this.__neh_changeCondition();this.clearFilterFlag="true";},_disableDeleteValuesLink:function(){this._enableLink(this.idAnyOfDeleteValuesLink,false);},_neh_DeleteValuesLink:function(){if(this.idListSelectedValues.getLength()==0){return ;}if(this.idAnyOfDeleteValuesLink.className=="link_disabled"){return ;}var C=0;var B=this.idListSelectedValues.getSelectedIndex()-1;var A=this.idListSelectedValues.getSelectedValues();for(C=0;C<A.length;C++){this.idListSelectedValues.remove(A[C]);}if(B<0){B=0;}if(this.idListSelectedValues.getLength()==0){this._enableLink(this.idAnyOfDeleteValuesLink,false);this.idListSelectedValues.setSelectedIndex(-1);}else{if(B!=-1&&B!=null){this.idListSelectedValues.setSelectedIndex(B);}}},_neh_SelectValuesLink1:function(C){this.whichButton="MoreValues1";if(this.valuesLoadedFlag=="false"){var A={name:"FilterText",value:""};var E={name:"target",value:this._classname};var F={name:"currCursor",value:-1};var D=[A,E,F];this._consumer._eventDispatcher.fireEvent(actuate.iv.core.iVEvent.__E_MOREVALUES_FILTER,D);if(this._isSharedBinding){return ;}this.valuesLoadedFlag="true";}this._showHideFindRow();this.showHideCalendarDiv(false);this.idCalendar.style.display="none";this.idSelectValuesDiv.style.display="block";this.idSelectValuesLink1.style.display="none";this.idSelectValuesLabel1.style.display="block";this.idSelectValuesLink2.style.display="block";this.idSelectValuesLabel2.style.display="none";var B=this.getOperatorAry(this.condition.getValue());if(B!=3){this.value1Text.focus();}this.adjustSize();},_neh_AnyOfSelectValuesLink:function(C){this.whichButton="MoreValues1";if(this.valuesLoadedFlag=="false"){var A={name:"FilterText",value:""};var E={name:"target",value:this._classname};var F={name:"currCursor",value:-1};var D=[A,E,F];this._consumer._eventDispatcher.fireEvent(actuate.iv.core.iVEvent.__E_MOREVALUES_FILTER,D);this.valuesLoadedFlag="true";}this._showHideFindRow();this.showHideCalendarDiv(false);this.idSelectValuesDiv.style.display="block";this.idCalendar.style.display="none";this._enableLink(this.idAnyOfListValuesLink,false);var B=this.getOperatorAry(this.condition.getValue());if(B!=3){this.value1Text.focus();}this.adjustSize();},_neh_SelectValuesLink2:function(C){this.whichButton="MoreValues2";if(this.valuesLoadedFlag=="false"){var A={name:"FilterText",value:""};var E={name:"target",value:this._classname};var F={name:"currCursor",value:-1};var D=[A,E,F];this._consumer._eventDispatcher.fireEvent(actuate.iv.core.iVEvent.__E_MOREVALUES_FILTER,D);if(this._isSharedBinding){return ;}this.valuesLoadedFlag="true";}this._showHideFindRow();this.showHideCalendarDiv(false);this.idCalendar.style.display="none";this.idSelectValuesDiv.style.display="block";this.idSelectValuesLink2.style.display="none";this.idSelectValuesLabel2.style.display="block";this.idSelectValuesLink1.style.display="block";this.idSelectValuesLabel1.style.display="none";var B=this.getOperatorAry(this.condition.getValue());if(B!=3){this.value2Text.focus();}this.adjustSize();},__neh_CalendarClick:function(D){var A={};var B=this.getOperatorAry(this.condition.getValue());if(this.whichDataType==actuate.Constant.DataType.DATE){A.isDateTime=false;}else{A.isDateTime=true;}if(B==3){this.ListSelectedValuesCount=this.idListSelectedValues.getLength();this.FocusAfterCalendarFlag=true;A.target=this.idListSelectedValues;}else{A.target=D;}var C={};C.cache=A;this._consumer._eventDispatcher.fireEvent(actuate.iv.core.iVEvent.__E_CALENDAR,C);this._whichValue1=false;this._whichValue2=false;},showHideCalendarDiv:function(A){if(A){if(this.idCalendar.style.display=="none"){this.cal.style.display="block";this.idCalendar.appendChild(this.cal);this.idCalendar.style.display="block";}}else{if(this.idCalendar.style.display=="block"){this.cal.style.display="none";this.idCalendar.removeChild(this.cal);this.idCalendar.style.display="none";}}},splitAtN:function(A){if(A){if(A.length<50){return A;}if(A.length>50){var C=A.substring(0,50);var B=A.substring(50);if(B.length>50){A=C+"\n"+this.splitAtN(B);}else{A=C+"\n"+B;}}}return A;},_showFilter:function(H,C){this._whichValue1=false;this._whichValue2=false;this._selectedValue1=null;this._selectedValue2=null;this.value1Text.setValue("");this.value2Text.setValue("");var I=H.selectedBinding||H.Binding;var L=null;var D=null;if(C){this.selectedName=I.name;this.whichDataType=H.dataType||I.dataType;this.loadConditions();var B=I.displayName==null?this.selectedName:I.displayName;this.resultSetName.innerHTML=this.splitAtN(B);L=H[actuate.model.Constant.MetadataType.FILTER];D=L.getSimpleFilter(this.selectedName);}else{var J=null;for(var B in I){this.selectedName=I[B].name;this.whichDataType=H.dataType||I[B].dataType;J=I[B].displayName;}this.loadConditions();this.resultSetName.innerHTML=this.splitAtN(J);L=H[actuate.model.Constant.MetadataType.FILTER];D=L.getSimpleFilter(this.selectedName);}if(!D){this.condition.setSelectedIndex(0);}else{var E=this._operatorMap[D.operator];if(E!=null&&!this.condition.hasRecord(D.operator)){this.condition.add([[D.operator,E]]);}this.condition.setValue(D.operator);this.recalculateTotals.setCheckedFlag(D.updateAggregation);}this._previousCondition=this.condition.getValue();var F=this.getOperatorAry(this.condition.getValue());this._showValueGUI(F);if(F==1){this._whichValue1=true;this._whichValue2=false;}else{if(F==2){this._whichValue1=true;this._whichValue2=true;}}this._selectedValue1=null;this._selectedValue2=null;if(!D){return true;}var A=D.values;if(A&&A.length>0){if(this.condition.getValue()==actuate.dialog.impl.constant.DesignChoice.FILTER_OPERATOR_IN_NEW||this.condition.getValue()==actuate.dialog.impl.constant.DesignChoice.FILTER_OPERATOR_NOT_IN_NEW){var K=[];for(var G=0;G<A.length;G++){K.push([A[G],A[G]==null?actuate.util.Utility.getLocalizedString("filterDialog.text.nullValue"):A[G]]);}this.idListSelectedValues.setStore(K);this._enableLink(this.idAnyOfDeleteValuesLink,false);}else{if(A.length==1){this.value1Text.setValue(A[0]);this._whichValue1=false;}else{if(A.length==2){this.value1Text.setValue(A[0]);this.value2Text.setValue(A[1]);this._whichValue1=false;this._whichValue2=false;}}}}return true;},_showValueGUI:function(A){this.idCalendar.style.display="none";this.idValuesList.setMultiSelect(false);this.idListSelectedValuesDiv.style.display="none";this.idListSelectedValues.hide();this.value1Text.hide();this.value2Text.hide();this.idAnyOfListValuesDiv.style.display="none";if(A==0){this.idValue1.style.display="none";this.idValue2.style.display="none";actuate.util.XmlDom.setTextContent(this.textValue1Div,"");actuate.util.XmlDom.setTextContent(this.textValue2Div,"");}if(A==1){this.whichButton="MoreValues1";if(this.idSelectValuesLabel1.style.display=="none"&&this.idSelectValuesLink1.style.display=="none"){this.idSelectValuesLink1.style.display="block";this.idSelectValuesLabel1.style.display="none";}if(this.idSelectValuesDiv.style.display=="block"){this.idSelectValuesLink1.style.display="none";this.idSelectValuesLabel1.style.display="block";}if(this.whichDataType==actuate.Constant.DataType.DATETIME||this.whichDataType==actuate.Constant.DataType.DATE){if(this.condition.getValue()==this.conditionTopn||this.condition.getValue()==this.conditionBottomn||this.condition.getValue()==this.conditionToppercent||this.condition.getValue()==this.conditionBottompercent||this.condition.getValue()==this.conditionLike||this.condition.getValue()==this.conditionNotLike){this.value1Text.enable();this.value2Text.enable();actuate.util.XmlDom.setTextContent(this.textValue1Div,this.textValue);actuate.util.XmlDom.setTextContent(this.textValue2Div,"");}else{actuate.util.XmlDom.setTextContent(this.textValue1Div,this.textDateValue);actuate.util.XmlDom.setTextContent(this.textValue2Div,"");}this.idDateImg1.style.display="block";this.idDateImg2.style.display="none";}else{actuate.util.XmlDom.setTextContent(this.textValue1Div,this.textValue);actuate.util.XmlDom.setTextContent(this.textValue2Div,"");this.idDateImg1.style.display="none";this.idDateImg2.style.display="none";}this.idValue1.style.display="block";this.idValue2.style.display="none";this.value1Text.show();}if(A==2){if(this.whichDataType==actuate.Constant.DataType.DATETIME||this.whichDataType==actuate.Constant.DataType.DATE){actuate.util.XmlDom.setTextContent(this.textValue1Div,this.textDateValueFrom);actuate.util.XmlDom.setTextContent(this.textValue2Div,this.textDateValueTo);this.idDateImg1.style.display="block";this.idDateImg2.style.display="block";}else{actuate.util.XmlDom.setTextContent(this.textValue1Div,this.textValueFrom);actuate.util.XmlDom.setTextContent(this.textValue2Div,this.textValueTo);this.idDateImg1.style.display="none";this.idDateImg2.style.display="none";}if(this.idSelectValuesLabel1.style.display=="none"&&this.idSelectValuesLink1.style.display=="none"){this.idSelectValuesLink1.style.display="block";this.idSelectValuesLabel1.style.display="none";}if(this.idSelectValuesLabel2.style.display=="none"&&this.idSelectValuesLink2.style.display=="none"){this.idSelectValuesLink2.style.display="block";this.idSelectValuesLabel2.style.display="none";}if(this.idSelectValuesLabel1.style.display=="block"){this.idSelectValuesLink2.style.display="block";this.idSelectValuesLabel2.style.display="none";this.whichButton="MoreValues1";}else{if(this.idSelectValuesLabel2.style.display=="block"){this.idSelectValuesLink1.style.display="block";this.idSelectValuesLabel1.style.display="none";this.whichButton="MoreValues2";}}this.idValue1.style.display="block";this.idValue2.style.display="block";this.value1Text.show();this.value2Text.show();}if(A==3){this.showHideCalendarDiv(false);this.idAnyOfListValuesDiv.style.display="block";this.idAnyOfListValuesLink.style.display="";if(this.idSelectValuesDiv.style.display=="block"){this._enableLink(this.idAnyOfListValuesLink,false);}else{this._enableLink(this.idAnyOfListValuesLink,true);}this.idAnyOfDeleteValuesLink.style.display="";if(this.idListSelectedValues.getLength()>0){this._enableLink(this.idAnyOfDeleteValuesLink,true);}else{this._enableLink(this.idAnyOfDeleteValuesLink,false);}this.idSelectValuesLink1.style.display="none";this.idSelectValuesLabel1.style.display="none";this.idDateImg1.style.display="none";this.idDateImg2.style.display="none";if(this.whichDataType==actuate.Constant.DataType.DATETIME||this.whichDataType==actuate.Constant.DataType.DATE){actuate.util.XmlDom.setTextContent(this.textValue1Div,this.textDateValue);actuate.util.XmlDom.setTextContent(this.textValue2Div,"");}else{actuate.util.XmlDom.setTextContent(this.textValue1Div,this.textValue);actuate.util.XmlDom.setTextContent(this.textValue2Div,"");}this.idValuesList.setMultiSelect(true);this.idListSelectedValuesDiv.style.display="block";this.idListSelectedValues.show();this.idValue1.style.display="block";this.idValue2.style.display="none";}if(this.condition.getValue()==this.conditionTopn||this.condition.getValue()==this.conditionBottomn||this.condition.getValue()==this.conditionToppercent||this.condition.getValue()==this.conditionBottompercent){this.idSelectValuesLink1.style.display="none";this.idSelectValuesLink1.style.visibility="hidden";this.idSelectValuesLabel1.style.display="none";this.idSelectValuesDiv.style.display="none";this.idDateImg1.style.display="none";}this.adjustSize();},showSelectValuesLinks:function(){this.idSelectValuesLabel2.style.display="none";this.idSelectValuesLabel1.style.display="none";this.idSelectValuesDiv.style.display="none";var A=this.getOperatorAry(this.condition.getValue());if(A==0){this.idSelectValuesLink1.style.display="none";this.idSelectValuesLink2.style.display="none";}else{if(A==1){this.idSelectValuesLink1.style.display="block";this.idSelectValuesLink2.style.display="none";}else{if(A==2){this.idSelectValuesLink1.style.display="block";this.idSelectValuesLink2.style.display="block";}}}},createFilterRequestForMashup:function(C){this.ivFilter.setOperator(C.getOperator());this.ivFilter.setFilterType("Simple");var B=new actuate.data.BoundDataColumn();B.setName(C.getColumnName());this.ivFilter.setColumnName(B);var A=new Array();A.push(C.getValue());A.push("");this.ivFilter.setValueList(A);return this.ivData.getFilter(this._consumer,this.ivFilter);},createFilterRequest:function(){var G=this.getOperatorAry(this.condition.getValue());var B=new Array();if(G==3){var D=this.idListSelectedValues.getStore().collect("value",true);for(var E=0;E<D.length;E++){B.push(D[E]);}}else{var C=this.value1Text.isVisible()===false?null:this.value1Text.getValue();var A=this.value2Text.isVisible()===false?null:this.value2Text.getValue();if(this._whichValue1==true){C=this._selectedValue1;}else{if(this._whichValue2==true){A=this._selectedValue2;}}B.push(C);if(G==2){B.push(A);}}B=actuate.util.Json.makeArray(B);if(!this._whichValue1&&B[0]==null&&!actuate.util.Utility.isNumber(this.whichDataType)&&!actuate.util.Utility.isDateDataType(this.whichDataType)&&!this.isSpecialFunction(this.condition.getValue())){if(this.condition.getValue()==this.conditionEq){this.ivFilter.setOperator(this.conditionIsnull);}else{if(this.condition.getValue()==this.conditionNe){this.ivFilter.setOperator(this.conditionIsnotnull);}else{this.ivFilter.setOperator(this.condition.getValue());}}}else{this.ivFilter.setOperator(this.condition.getValue());}this.ivFilter.setFilterType("Simple");var F=new actuate.data.BoundDataColumn();F.setName(this.selectedName);this.ivFilter.setColumnName(F);this.ivFilter.setValueList(B);this.ivFilter.setUpdateAggregation(this.recalculateTotals.getValue());return this.ivData.getFilter(this._consumer,this.ivFilter);},createShowDialogRequest:function(D){var B=new actuate.data.BoundDataColumn();B.setName(this.selectedName);var C=new actuate.data.TableColumnDefinition();C.setBoundDataColumn(B);var A=new actuate.data.ColumnDefinitionGroup();A.addTableColumnDefinition(C);return this.ivData.getColumnDefinitionGroup(D,A);},createMoreValuesRequest:function(D){var B=new actuate.data.BoundDataColumn();B.setName(this.selectedName);var C=new actuate.data.TableColumnDefinition();C.setIid(D);C.setBoundDataColumn(B);var A=new actuate.data.ColumnDefinitionGroup();A.addTableColumnDefinition(C);return this.ivData.getColumnDefinitionGroup(this._consumer,A);},isSpecialFunction:function(A){if(A==this.conditionTopn||A==this.conditionBottomn||A==this.conditionToppercent||A==this.conditionBottompercent){return true;}else{return false;}},_enableLink:function(B,A){if(A){B.className="iv_dialog_link_enabled";}else{B.className="iv_dialog_link_disabled";}},getOperatorAry:function(D){var A=new Array(3);A[0]=new Array(this.conditionIsnull,this.conditionIsnotnull,this.conditionIstrue,this.conditionIsfalse,this.noCondition);A[1]=new Array(this.conditionTopn,this.conditionBottomn,this.conditionToppercent,this.conditionBottompercent,this.conditionEq,this.conditionNe,this.conditionLt,this.conditionLe,this.conditionGe,this.conditionGt,this.conditionLike,this.conditionNotLike);A[2]=new Array(this.conditionBetween,this.conditionNotbetween);A[3]=new Array(this.conditionIn,this.conditionNotIn);for(var C=0;C<4;C++){for(var B=0;B<A[C].length;B++){if(D==A[C][B]){return C;}}}return 0;},_showHideFindRow:function(){if(this.whichDataType!=actuate.Constant.DataType.STRING){this.idFindRow.style.display="none";this.idFilterText.hide();this.idFindButton.hide();this.idFilterTextLabel.style.display="none";}else{if(actuate.util.Utility.isIE){this.idFindRow.style.display="";}else{this.idFindRow.style.display="table-row";}this.idFilterText.show();this.idFindButton.show();this.idFilterTextLabel.style.display="inline";}},_showHideSelectValuesBlock:function(){var A=this.getOperatorAry(this.condition.getValue());if(A==0){this.idSelectValuesDiv.style.display="none";}else{if(this.idValuesList.getLength()>0){this.idSelectValuesDiv.style.display="block";this._showHideFindRow();}else{this.idFilterText.setValue("");this.showSelectValuesLinks();}}},showData:function(E){var B=[];if(E["resultSetData"]){this._prevCursor=E["prevCursor"];this._currCursor=E["currCursor"];var C=new actuate.data.ResultSetData(E["resultSetData"]);var D=C.getRows();this._rowCount=parseInt(C.getRowCount());this._endOfResultset=C.getEndOfResultSet();this._enableLink(this.idNext,false);this._enableLink(this.idPrevious,false);if(!this._endOfResultset){this._enableLink(this.idNext,true);}if(this._prevCursor>0){this._enableLink(this.idPrevious,true);}if(D.length>0){for(var A=0;A<D.length;A++){if(D[A]!=null){var G=0;var F=0;if(D[A].length>1){F=1;}B.push([D[A][G],D[A][F]]);}}}}this.idValuesList.setStore(B);this.idValuesList.setValues();},__neh_ListClick:function(){var A=this.getOperatorAry(this.condition.getValue());if(A==3){this._fillSelectedValuesInList(true);}else{var C=this.idValuesList.getSelectedValues();if(C&&C.length>0){var B=this.idValuesList.getSelectedValue();this.fillTextBox();}}},_fillSelectedValuesInList:function(D){if(D){var A=this.idValuesList.getSelectedValues();if(A){for(var C=0;C<A.length;C++){var B=(A[C]&&A[C].data!=null)?A[C].data.value:A[C];if(!this.idListSelectedValues.contains(B)){this.idListSelectedValues.add([B,B==null?actuate.util.Utility.getLocalizedString("filterDialog.text.nullValue"):B]);}}}}if(this.idListSelectedValues.getLength()>0){this.idListSelectedValues.setSelectedIndex(this.idListSelectedValues.getLength()-1,true);this._enableLink(this.idAnyOfDeleteValuesLink,true);}else{this.idListSelectedValues.setSelectedIndex(null);}},__neh_FindClick:function(B){this.idValuesList.clear();this._filterText=this.idFilterText.getValue();var A={name:"FilterText",value:this._filterText};var D={name:"target",value:this._classname};var E={name:"currCursor",value:-1};var C=[A,D,E];this._consumer._eventDispatcher.fireEvent(actuate.iv.core.iVEvent.__E_MOREVALUES_FILTER,C);},__neh_FilterTextChange:function(A){if(A.keyCode==13){this.__neh_FindClick(A);}},fillTextBox:function(){this.value1Text.unregisterEventHandler("change",this.__neh_value1Change_c);this.value2Text.unregisterEventHandler("change",this.__neh_value2Change_c);var A="";if(this.idValuesList.getSelectedValues().length>=0&&this.idValuesList.getLength()>0){A=this.idValuesList.getSelectedValue();}if(this.whichButton=="MoreValues1"||this.whichButton=="DateTimeMoreValues1"){this.value1Text.setValue(A);this._selectedValue1=A;this._whichValue1=true;}else{if(this.whichButton=="MoreValues2"||this.whichButton=="DateTimeMoreValues2"){this.value2Text.setValue(A);this._selectedValue2=A;this._whichValue2=true;}}this.value1Text.blur();this.value2Text.blur();this.value1Text.registerEventHandler("change",this.__neh_value1Change_c,false);this.value2Text.registerEventHandler("change",this.__neh_value2Change_c,false);},_neh_clearFilterLink:function(){this._rowCount=0;this._prevCursor=-1;this._currCursor=-1;this._endOfResultset=false;this.valuesLoadedFlag="false";this.clearFilterFlag="false";this.idListSelectedValues.clear();this.value1Text.setValue("");this.value2Text.setValue("");this.condition.setValue("clear");this._previousCondition="clear";this._whichValue1=false;this._whichValue2=false;this.__neh_changeCondition();},__neh_ListSelectedValuesFocus:function(){if(this.idListSelectedValues.getLength()>0&&this.idListSelectedValues.getSelectedIndex()!=-1){this._enableLink(this.idAnyOfDeleteValuesLink,true);if(this.FocusAfterCalendarFlag){this.idListSelectedValues.setSelectedIndex(this.idListSelectedValues.getLength()-1,true);}}else{this._enableLink(this.idAnyOfDeleteValuesLink,false);}this.FocusAfterCalendarFlag=false;},_neh_AdvancedButtonClick:function(E){var D=[];D.push(this.getConditionLine());if(this.idSelectValuesDiv.style.display=="block"){var B=[];var A=this.idValuesList.getStore().getRange();for(var C=0;C<A.length;C++){var G=A[C].get("text");var F=A[C].get("value");B.push([G,F]);}var H=new actuate.data.ResultSetData();H.setRows(B);H.setCursor({currCursor:this._currCursor,prevCursor:this._prevCursor});H.setRowCount(this._rowCount);H.setEndOfResultSet(this._endOfResultset);D.push(H);}this._hide();this._consumer._eventDispatcher.fireEvent(actuate.iv.core.iVEvent.__E_ADVANCEDFILTERDIALOG,D);},getConditionLine:function(){var G=new actuate.data.ConditionLine();G.setOperator(this.condition.getValue());G.setRow(this.selectedName);var B=this.getOperatorAry(this.condition.getValue());var I=new Array();if(B==3){var C="";var A=this.idListSelectedValues.getStore().collect("value",true);if(A.length>0){for(var D=0;D<A.length;D++){var H=A[D];C=C+"|"+H;}if(C.charAt(0)=="|"){C=C.substring(1);}var J=new Object();J.isAnyOf=true;J.isLiteral=true;J.isDataField=false;J.value=C;I.push(J);}}else{var J=new Object();var F=this.value1Text.getValue();var E=this.value2Text.getValue();F=(F=="")?(this.value1Text.isNull()?null:F):F;E=(E=="")?(this.value2Text.isNull()?null:E):E;if(this._whichValue1==true){F=this._selectedValue1;}if(this._whichValue2==true){E=this._selectedValue2;}J.isAnyOf=false;J.isLiteral=true;J.isDataField=false;J.value=F;I.push(J);J=new Object();J.isAnyOf=false;J.isLiteral=true;J.isDataField=false;J.value=E;I.push(J);}G.setFilterOperands(I);return G;},showAdvancedFilterLink:function(A){if(A){this.idAdvancedFilterLink.style.display="";this.idLabelPipe.style.display="";}else{this.idAdvancedFilterLink.style.display="none";this.idLabelPipe.style.display="none";}},__neh_value1Change:function(){this._whichValue1=false;},__neh_value2Change:function(){this._whichValue2=false;},__neh_value1Tooltip:function(){var A=this.value1Text;this.__updateTooltip(A);},__neh_value2Tooltip:function(){var A=this.value2Text;this.__updateTooltip(A);},__updateTooltip:function(A){if(A.getEl){A=A.getEl().dom;}if(A){A.setAttribute("title",A.value);}},_enter_key:function(A,B){if(!this.__preventEnterKey){var C=B==null?null:B.getTarget();if(C&&C.name&&C.name.toLowerCase()=="filtertext"){this.__neh_FilterTextChange(B);}else{if(this.value1Text){if(this.value1Text.hasFocus||(this.value1Text.textfield&&this.value1Text.textfield.hasFocus)){this.__neh_value1Change();}}if(this.value2Text){if(this.value2Text.hasFocus||(this.value2Text.textfield&&this.value2Text.textfield.hasFocus)){this.__neh_value2Change();}}actuate.dialog.impl.helper.SelectedFilterDialog.superclass._enter_key.apply(this,arguments);}}}});