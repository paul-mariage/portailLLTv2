actuate.util.Package.define("actuate.dialog.impl.helper.gadgetbuilder");actuate.dialog.impl.helper.gadgetbuilder.MeterDataTab=actuate.Class.extendClass(actuate.dialog.impl.helper.AbstractDataTabDialog,{_classname:"actuate.dialog.impl.helper.gadgetbuilder.MeterDataTab",_selectedIid:null,initialize:function(){this.id=this._getId(this._classname);this._title=actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.data");actuate.dialog.impl.helper.AbstractDataTabDialog.prototype.initialize.call(this);this.__initDataSourceCombo();this._valueDefinitionCombo1=actuate.widget.ComponentMgr.get(this.id+"_valuedefinitioncombo");this._valueDefinitionCombo2=actuate.widget.ComponentMgr.get(this.id+"_value_2_combo");this._valueDefinitionCombo3=actuate.widget.ComponentMgr.get(this.id+"_value_3_combo");this._agregateExpression1=actuate.widget.ComponentMgr.get(this.id+"_agregateExpression1");this._agregateExpression2=actuate.widget.ComponentMgr.get(this.id+"_agregateExpression2");this._agregateExpression3=actuate.widget.ComponentMgr.get(this.id+"_agregateExpression3");this._hyperlinkCheckbox=actuate.widget.ComponentMgr.get(this.id+"_hyperlinkCheckbox");this._installEventHandlers();this._initializeControlStatus();},_initializeControlStatus:function(){this._validateControlArray=[];},__createDataSourceCombo:function(){return actuate.widget.ComponentMgr.get(this.id+"_datasetcombo");},_initContent:function(){this._componentArray=[];var A=this;this.invalid_arr=[];this._valueDefinitionStore1=new actuate.widget.data.SimpleStore({fields:["valueDefinitionValue","valueDefinitionText","title","valueDefinitionType","hasAction"]});this._valueDefinitionStore2=new actuate.widget.data.SimpleStore({fields:["valueDefinitionValue","valueDefinitionText","title","valueDefinitionType","hasAction"]});this._valueDefinitionStore3=new actuate.widget.data.SimpleStore({fields:["valueDefinitionValue","valueDefinitionText","title","valueDefinitionType","hasAction"]});this._aggrNumStore=[["",""],["Sum",actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.Sum")],["Average",actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.Average")],["Count",actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.Count")],["DistinctCount",actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.DistinctCount")],["Min",actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.Min")],["Max",actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.Max")],["First",actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.First")],["Last",actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.Last")]];this._aggrStringStore=[["",""],["Count",actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.Count")],["DistinctCount",actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.DistinctCount")]];var C={xtype:"fieldset",collapsible:true,title:actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.data"),checkboxToggle:false,defaults:{border:false,layout:"column",bodyStyle:"padding:2px 4px 2px 10px"},listeners:{collapse:function(){if(A._parentDialog&&A._parentDialog.adjustSize){A._parentDialog.adjustSize();}},expand:function(){if(A._parentDialog&&A._parentDialog.adjustSize){A._parentDialog.adjustSize();}}},cls:"actuate-widget-panle-zero-margin-top",items:[{layout:"column",items:[{layout:"form",border:false,labelWidth:112,items:[{id:this.id+"_datasetcombo",width:315,fieldLabel:actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.useDataFrom"),xtype:"treecombo",editable:false,forceSelection:true,autoExpand:true,style:"margin-right:3px",valueField:"value",displayField:"title",titleField:"title",icons:this.__dataSourceIcons,sortInfo:{folderSort:true,field:"text",direction:"ASC"},showTooltip:true,store:new actuate.widget.custom.TreeCombo.TreeComboStore(this.__dataSourceComboStore)}]}]},{items:[{id:this.id+"_hyperlinkCheckbox",xtype:"checkbox",checked:true,boxLabel:actuate.util.Utility.getLocalizedString("common.dataTab.useHyperlink")}]}]};var B={xtype:"fieldset",collapsible:true,autoHeight:true,title:actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.Value"),checkboxToggle:false,defaults:{border:false,header:false,layout:"column",bodyStyle:"padding:2px 4px 2px 10px"},listeners:{collapse:function(){if(A._parentDialog&&A._parentDialog.adjustSize){A._parentDialog.adjustSize();}},expand:function(){if(A._parentDialog&&A._parentDialog.adjustSize){A._parentDialog.adjustSize();}}},items:[{items:[{columnWidth:0.4,xtype:"checkbox",checked:false,id:"allowMultipleValue",handler:function(G,F){var D=actuate.widget.ComponentMgr.get(A.id+"_value_2_label");var J=actuate.widget.ComponentMgr.get(A.id+"_value_2_combo");var H=actuate.widget.ComponentMgr.get(A.id+"_value_3_label");var M=actuate.widget.ComponentMgr.get(A.id+"_value_3_combo");var L=actuate.widget.ComponentMgr.get(A.id+"_agregateExpression2");var K=actuate.widget.ComponentMgr.get(A.id+"_agregateExpression3");if(F){D.enable();J.enable();H.enable();M.enable();var I=actuate.widget.ComponentMgr.get(A.id+"_datasetcombo");var E=I.getValue();if(E.type=="dataset"){L.enable();K.enable();}}else{D.disable();J.disable();J.setValueById("none");H.disable();M.disable();M.setValueById("none");L.disable();L.setValue("");K.disable();K.setValue("");if(A._valueDefinitionCombo1.validate&&A._valueDefinitionCombo1.validate()){A._parentDialog._okBtn.enable();}}},boxLabel:actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.allowMultipleValue")}]},{items:[{columnWidth:0.1,xtype:"label",style:"height:1px"},{columnWidth:0.2,xtype:"label",style:"height:1px",text:""},{columnWidth:0.3,xtype:"label",text:actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.dataColumns")},{columnWidth:0.02,xtype:"label",style:"height:1px"},{columnWidth:0.3,xtype:"label",text:actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.aggregationExpression")}]},{items:[{columnWidth:0.26,xtype:"label",text:actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.selectValue1")},{id:this.id+"_valuedefinitioncombo",columnWidth:0.33,viewWidth:250,xtype:"treecombo",forceSelection:true,editable:false,valueField:"valueDefinitionValue",displayField:"valueDefinitionText",titleField:"title",autoExpand:true,showTooltip:true,icons:this.__icons,store:new actuate.widget.custom.TreeCombo.TreeComboStore(this._valueDefinitionStore1),listeners:{beforeselect:function(E,D){A._valueDefBeforeSelectEvent(E,D,1);},select:function(){A._checkValidationStatus();}},validator:function(F){var G=actuate.widget.ComponentMgr.get(A.id+"_valuedefinitioncombo");var E=G.getSelectedIndex();var D=G.getValueAt(E);return D?A._valiateValueDefRecord(A._getTreeComboValueByRecord(D),1):false;}},{columnWidth:0.03,xtype:"label",style:"height:1px"},{columnWidth:0.33,xtype:"combo",forceSelection:true,value:"",editable:false,id:this.id+"_agregateExpression1",store:this._aggrNumStore,listeners:{select:function(E,D){A._aggrComboSelectEvent(E,D,1);}}}]},{items:[{id:this.id+"_value_2_label",columnWidth:0.26,xtype:"label",disabled:true,text:actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.selectValue2")},{id:this.id+"_value_2_combo",columnWidth:0.33,viewWidth:250,xtype:"treecombo",disabled:true,editable:false,forceSelection:false,valueField:"valueDefinitionValue",displayField:"valueDefinitionText",titleField:"title",autoExpand:true,showTooltip:true,icons:this.__icons,store:new actuate.widget.custom.TreeCombo.TreeComboStore(this._valueDefinitionStore2),listeners:{beforeselect:function(E,D){A._valueDefBeforeSelectEvent(E,D,2);},select:function(){A._checkValidationStatus();}},validator:function(F){var G=actuate.widget.ComponentMgr.get(A.id+"_value_2_combo");var E=G.getSelectedIndex();var D=G.getValueAt(E);return D?A._valiateValueDefRecord(A._getTreeComboValueByRecord(D),2):false;}},{columnWidth:0.03,xtype:"label",style:"height:1px"},{columnWidth:0.33,xtype:"combo",forceSelection:true,value:"",disabled:true,editable:false,id:this.id+"_agregateExpression2",store:this._aggrNumStore,listeners:{select:function(E,D){A._aggrComboSelectEvent(E,D,2);}}}]},{items:[{id:this.id+"_value_3_label",columnWidth:0.26,disabled:true,xtype:"label",text:actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.selectValue3")},{id:this.id+"_value_3_combo",columnWidth:0.33,viewWidth:250,xtype:"treecombo",disabled:true,editable:false,forceSelection:false,valueField:"valueDefinitionValue",displayField:"valueDefinitionText",titleField:"title",autoExpand:true,showTooltip:true,icons:this.__icons,store:new actuate.widget.custom.TreeCombo.TreeComboStore(this._valueDefinitionStore3),listeners:{beforeselect:function(E,D){A._valueDefBeforeSelectEvent(E,D,3);},select:function(){A._checkValidationStatus();}},validator:function(F){var G=actuate.widget.ComponentMgr.get(A.id+"_value_3_combo");var E=G.getSelectedIndex();var D=G.getValueAt(E);return D?A._valiateValueDefRecord(A._getTreeComboValueByRecord(D),3):false;}},{columnWidth:0.03,xtype:"label",style:"height:1px"},{columnWidth:0.33,xtype:"combo",forceSelection:true,value:"",editable:false,disabled:true,id:this.id+"_agregateExpression3",store:this._aggrNumStore,listeners:{select:function(E,D){A._aggrComboSelectEvent(E,D,3);}}}]}]};this._componentArray.push(C);this._componentArray.push(B);},validate:function(){var A=this._isDataCubeSelected();var B=this._isDataSetSelected();if(!(A||B)){actuate.widget.MessageBox.show({title:actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.alertTitle"),msg:actuate.util.Utility.getLocalizedString("common.dataTab.noDataSourceError"),buttons:actuate.widget.MessageBox.OK});return false;}if(!this._getTreeComboValue(this._valueDefinitionCombo1)&&!this._getTreeComboValue(this._valueDefinitionCombo2)&&!this._getTreeComboValue(this._valueDefinitionCombo3)){actuate.widget.MessageBox.show({title:actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.alertTitle"),msg:actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.noValueDefError"),buttons:actuate.widget.MessageBox.OK});return false;}if(!(this._valueDefinitionCombo1.isValid()&&this._valueDefinitionCombo2.isValid()&&this._valueDefinitionCombo3.isValid())){actuate.widget.MessageBox.show({title:actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.alertTitle"),msg:actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.valueDef.typeNotMatch"),buttons:actuate.widget.MessageBox.OK});return false;}return true;},_valiateValueDefRecord:function(value,valueDefComboIndex){var current;var valid=false;var comboBox1=actuate.widget.ComponentMgr.get(this.id+"_valuedefinitioncombo");var comboBox2=actuate.widget.ComponentMgr.get(this.id+"_value_2_combo");var comboBox3=actuate.widget.ComponentMgr.get(this.id+"_value_3_combo");var aggregateExpr1=actuate.widget.ComponentMgr.get(this.id+"_agregateExpression1");var aggregateExpr2=actuate.widget.ComponentMgr.get(this.id+"_agregateExpression2");var aggregateExpr3=actuate.widget.ComponentMgr.get(this.id+"_agregateExpression3");var checkingCombo=null;var comparingCombo1=null;var comparingCombo2=null;var checkingAggr=null;var comparingAggr1=null;var comparingAggr2=null;if(valueDefComboIndex===1){current=1;checkingCombo=comboBox1;comparingCombo1=comboBox2;comparingCombo2=comboBox3;checkingAggr=aggregateExpr1;comparingAggr1=aggregateExpr2;comparingAggr2=aggregateExpr3;}else{if(valueDefComboIndex===2){current=2;checkingCombo=comboBox2;comparingCombo1=comboBox1;comparingCombo2=comboBox3;checkingAggr=aggregateExpr2;comparingAggr1=aggregateExpr1;comparingAggr2=aggregateExpr3;}else{current=3;checkingCombo=comboBox3;comparingCombo1=comboBox1;comparingCombo2=comboBox2;checkingAggr=aggregateExpr3;comparingAggr1=aggregateExpr1;comparingAggr2=aggregateExpr2;}}var store=null;if(!actuate.util.Utility.isEmpty(checkingCombo,false)){store=checkingCombo.getStore();}var record=null;if(!actuate.util.Utility.isEmpty(store,false)){record=this._queryTreeComboRecord(checkingCombo,value);}if(!record){valid=false;return actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.valueDef.valueNotCorrect");}var dataType=record.data.valueDefinitionType;if(dataType=="integer"||dataType=="decimal"||dataType=="float"){valid=true;this.invalid_arr[current]=true;checkingAggr.setStore(this._aggrNumStore);}else{checkingAggr.setStore(this._aggrStringStore);if(checkingAggr.getValue()=="Count"||checkingAggr.getValue()=="DistinctCount"){valid=true;this.invalid_arr[current]=true;}else{valid=false;this.invalid_arr[current]=false;var msg=actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.valueDef.numericTypeNotMatch");checkingCombo.markInvalid(msg);this._parentDialog._okBtn.disable();return msg;}}for(var i=1;i<3;i++){var comboBox=eval("comparingCombo"+i);var displayText=this._getValueDefinition(comboBox);if(!actuate.util.Utility.isEmpty(displayText,false)){if(value==displayText){var aggr=eval("comparingAggr"+i);if(checkingAggr.getValue()!==aggr.getValue()){var temp1=checkingAggr.getValue();var temp2=aggr.getValue();valid=true;checkingCombo.clearInvalid();comboBox.clearInvalid();for(var i=1;i<this.invalid_arr.length;i++){if(this.invalid_arr[i]==false){var msg=actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.valueDef.typeNotMatch");var invalid_comboBox=eval("comboBox"+i);invalid_comboBox.markInvalid(msg);this._parentDialog._okBtn.disable();}}}else{valid=false;var msg=actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.valueDef.valueNotCorrect");checkingCombo.markInvalid(msg);this._parentDialog._okBtn.disable();return msg;}}else{if(value!=displayText){valid=true;checkingCombo.clearInvalid();comboBox.clearInvalid();for(var i=1;i<this.invalid_arr.length;i++){if(this.invalid_arr[i]==false){var msg=actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.valueDef.typeNotMatch");var invalid_comboBox=eval("comboBox"+i);invalid_comboBox.markInvalid(msg);this._parentDialog._okBtn.disable();}}if(this._parentDialog._valid){this._parentDialog._okBtn.enable();}}}}}var valueDef1=this._getValueDefinition(comparingCombo1);var valueDef2=this._getValueDefinition(comparingCombo2);var aggr1=comparingAggr1.getValue();var aggr2=comparingAggr2.getValue();if(!actuate.util.Utility.isEmpty(valueDef1,false)&&!actuate.util.Utility.isEmpty(valueDef2,false)){if(valueDef1==valueDef2&&aggr1==aggr2){valid=false;var msg=actuate.util.Utility.getLocalizedString("flashGadgetBuilderDialog.valueDef.valueNotCorrect");}}if(valid&&this._parentDialog._valid){this._parentDialog._okBtn.enable();}else{this._parentDialog._okBtn.disable();}return valid;},_aggrComboSelectEvent:function(E,D,A){var B=null;if(A===1){B=actuate.widget.ComponentMgr.get(this.id+"_valuedefinitioncombo");}else{if(A===2){B=actuate.widget.ComponentMgr.get(this.id+"_value_2_combo");}else{B=actuate.widget.ComponentMgr.get(this.id+"_value_3_combo");}}if(D.data.value=="Count"||D.data.value=="DistinctCount"){B.clearInvalid();}var C=this._getValueDefinition(B);if(!actuate.util.Utility.isEmpty(C,false)){this._valiateValueDefRecord(C,A);}},_getValueDefinition:function(A){return this._getTreeComboValue(A);},_valueDefBeforeSelectEvent:function(combo,selectedData,currentIndex){var hyperlinkDisabled=false;var comboBox1=actuate.widget.ComponentMgr.get(this.id+"_valuedefinitioncombo");var comboBox2=actuate.widget.ComponentMgr.get(this.id+"_value_2_combo");var comboBox3=actuate.widget.ComponentMgr.get(this.id+"_value_3_combo");var comparingCombo1=null;var comparingCombo2=null;if(currentIndex===1){comparingCombo1=comboBox2;comparingCombo2=comboBox3;}else{if(currentIndex===2){comparingCombo1=comboBox1;comparingCombo2=comboBox3;}else{comparingCombo1=comboBox1;comparingCombo2=comboBox2;}}for(var i=1;i<3;i++){var comboBox=eval("comparingCombo"+i);var record=comboBox.getValue();var store=comboBox.getStore();if(!actuate.util.Utility.isEmpty(store,false)){if(record&&!record.hasAction){hyperlinkDisabled=true;}else{hyperlinkDisabled=false;}}}},_checkValidationStatus:function(){if(this._valueDefinitionCombo1.validate&&this._valueDefinitionCombo1.validate()&&this._valueDefinitionCombo2.validate&&this._valueDefinitionCombo2.validate()&&this._valueDefinitionCombo3.validate&&this._valueDefinitionCombo3.validate()){this._parentDialog._okBtn.enable();}else{this._parentDialog._okBtn.disable();}},_installEventHandlers:function(){var A=actuate.Method.bind(this._eh_datasetComboChange,this);var B=actuate.Method.bind(this._eh_onBeforeSelect,this);this.__dataSourceCombo.registerEventHandler("change",A);this._valueDefinitionCombo1.registerEventHandler("beforeselect",B);this._valueDefinitionCombo2.registerEventHandler("beforeselect",B);this._valueDefinitionCombo3.registerEventHandler("beforeselect",B);},loadData:function(D){this._hasNewDatamart=false;if(D.Element&&D.Element.iid){this._selectedIid=D.Element.iid;}else{this._selectedIid=null;}if(D.DataMarts){this._data=D;this._clearControls();this.__showAllDataSources();this.__onSelectDataSource();}if(D.Filter){this._filter=D.Filter;}if(D.DataSet&&D.DataSet.dataSourceName){this.__selectDataSource(D.DataSet,"dataset");this.__onSelectDataSource();}else{if(D.Cube&&D.Cube.dataSourceName){this.__selectDataSource(D.Cube,"cube");this.__onSelectDataSource();}}var C=[];C[0]=this._valueDefinitionCombo1;C[1]=this._valueDefinitionCombo2;C[2]=this._valueDefinitionCombo3;var F=[];F[0]=this._agregateExpression1;F[1]=this._agregateExpression2;F[2]=this._agregateExpression3;if(D.ValueDefinitions){var B=0;for(var A in D.ValueDefinitions){if(A){F[A].setValue(D.ValueDefinitions[A].Aggregate);this.__setTreeComboValue(C[A],D.ValueDefinitions[A].Query);B++;}if(B>1){actuate.widget.ComponentMgr.get("allowMultipleValue").setValue(true);}}var E=null;if(D.Element!=null&&D.Element.copyHyperlink!=null){E=D.Element.copyHyperlink=="true"?true:false;}if(E==true){this._hyperlinkCheckbox.setValue(true);}else{if(E==false){this._hyperlinkCheckbox.setValue(false);}}}},_changeFilterPanel:function(B){if(this._parentDialog._filterPanel){var C={};var A=this.__getSelectedDataSourceInfo();if(A){C.dataObject=[A[1],A[4],A[3]];C.dataObjectSoap=this.createDataSetSoap(true);C.dataMartSoap=this._dataManagerSoap;C.clearFilterUI=this._clearFilterUI;C.target="FlashGadgets";}if(this._filter){C.Filter=this._filter;}this._parentDialog._filterPanel.loadData(C);}},__onSelectDataSource:function(E){if(E){this.__clearFilter();}var A=this.__getSelectedDataSourceInfo();this._agregateExpression1.setSelectedIndex(0);this._agregateExpression2.setSelectedIndex(0);this._agregateExpression3.setSelectedIndex(0);var D=A?A[1].columns:[];if(D){for(var C=0;C<D.length;C++){if(D[C].dataType!="blob"){this._agregateExpression1.enable();var B=actuate.widget.ComponentMgr.get("allowMultipleValue");if(B.getValue()){this._agregateExpression2.enable();this._agregateExpression3.enable();}}}}var F=A?A[1].measures:[];if(F){this._agregateExpression1.disable();this._agregateExpression2.disable();this._agregateExpression3.disable();}this._resetAllTreeCombo();actuate.dialog.impl.helper.gadgetbuilder.MeterDataTab.superclass.__onSelectDataSource.call(this);},_resetAllTreeCombo:function(){var B=this.__dataSourceCombo.getValue();var A={id:"none",strong:true,value:"",text:""};this._valueDefinitionStore1.removeAll();this._valueDefinitionStore2.removeAll();this._valueDefinitionStore3.removeAll();this.__addDataIntoTreeStore(A,this._valueDefinitionStore1);this.__addDataIntoTreeStore(A,this._valueDefinitionStore2);this.__addDataIntoTreeStore(A,this._valueDefinitionStore3);this.__setTreeStoreValues(this._valueDefinitionStore1,B,["category","column","measure"]);this.__setTreeStoreValues(this._valueDefinitionStore2,B,["category","column","measure"]);this.__setTreeStoreValues(this._valueDefinitionStore3,B,["category","column","measure"]);if(this._isDataModelSelected()){this._valueDefinitionCombo1.expandDeep=1;this._valueDefinitionCombo2.expandDeep=1;this._valueDefinitionCombo3.expandDeep=1;}else{this._valueDefinitionCombo1.expandDeep=null;this._valueDefinitionCombo2.expandDeep=null;this._valueDefinitionCombo3.expandDeep=null;}this._valueDefinitionCombo1.refresh();this._valueDefinitionCombo2.refresh();this._valueDefinitionCombo3.refresh();this._valueDefinitionCombo1.setValueById("none");this._valueDefinitionCombo2.setValueById("none");this._valueDefinitionCombo3.setValueById("none");},_eh_datasetComboChange:function(){this.__selectionChangedHandler();},getDataSelection:function(){var A=this.__getSelectedDataSourceInfo();if(A&&A[1]){return{dataSourceName:A[1].name};}return null;},_preHide:function(){this._dataManagerMetadata=null;this._clearControls();this.hidden=true;},_clearControls:function(){this.__dataSourceCombo.clear();this.__dataSourceCombo.setValue("");this._valueDefinitionCombo1.clear();this._valueDefinitionCombo1.setValueById("none");this._valueDefinitionCombo2.clear();this._valueDefinitionCombo2.setValueById("none");this._valueDefinitionCombo3.clear();this._valueDefinitionCombo3.setValueById("none");this._agregateExpression1.setValue("");this._agregateExpression2.setValue("");this._agregateExpression3.setValue("");actuate.widget.ComponentMgr.get("allowMultipleValue").setValue("false");actuate.widget.ComponentMgr.get(this.id+"_hyperlinkCheckbox").enable();actuate.widget.ComponentMgr.get(this.id+"_hyperlinkCheckbox").setValue(true);this._selectedIid=null;this.__clearFilter();this._filter=null;},createDataSetSoap:function(I){var H=actuate.util.XmlDom.createXMLDom(actuate.util.Constants.soap.NAMESPACE_ACTUATE10,actuate.Constant.tag.Data);if(this.__dataSourceComboStore){var J=this.__getSelectedDataSourceInfo();var M=J[1].name;var F=J[0];if(F==null||F==undefined){F="";}var K=J[2];if(J[1].dimensions){if(I){G=actuate.util.XmlDom.createElement(H,"Cube");}else{G=actuate.util.XmlDom.createElement(H,"CubeDef");}var C=actuate.util.XmlDom.createElement(H,"Name");var D=H.createTextNode(M);C.appendChild(D);G.appendChild(C);}else{var G=actuate.util.XmlDom.createElement(H,"DataSetDef");var C=actuate.util.XmlDom.createElement(H,"Name");var D=H.createTextNode(M);C.appendChild(D);G.appendChild(C);}var B=actuate.util.XmlDom.createElement(H,"DataSource");var P=J[4];if(P){var A=(P.toLowerCase()=="data")?actuate.dialog.impl.constant.DataMartAccessType.LATEST:actuate.dialog.impl.constant.DataMartAccessType.TRANSIENT;var N=actuate.util.XmlDom.createElement(H,"Type");N.appendChild(H.createTextNode(A));B.appendChild(N);}if(F){var O=actuate.util.XmlDom.createElement(H,"DisplayName");O.appendChild(H.createTextNode(F));B.appendChild(O);}var L=actuate.util.XmlDom.createElement(H,"DataMartName");D=H.createTextNode(K);L.appendChild(D);B.appendChild(L);G.appendChild(B);return G;}else{var E=this.__getSelectedDataSourceInfo();var M=E?E.name:"";var F="";var G=actuate.util.XmlDom.createElement(H,"DataSetDef");var C=actuate.util.XmlDom.createElement(H,"Name");var D=H.createTextNode(M);C.appendChild(D);G.appendChild(C);var B=actuate.util.XmlDom.createElement(H,"DataSource");var O=actuate.util.XmlDom.createElement(H,"DisplayName");D=H.createTextNode(F);O.appendChild(D);B.appendChild(O);G.appendChild(B);return G;}return null;},createSoapNode:function(B,F){if(this._selectedIid){F.documentElement.setAttribute("iid",this._selectedIid);}var D=this.createDataSetSoap(false);B.appendChild(D);if(this._getTreeComboValue(this._valueDefinitionCombo1)){B.appendChild(this._createQuery(this._valueDefinitionCombo1,this._agregateExpression1,F));}var A=actuate.widget.ComponentMgr.get("allowMultipleValue");if(A.getValue()){if(this._getTreeComboValue(this._valueDefinitionCombo2)){B.appendChild(this._createQuery(this._valueDefinitionCombo2,this._agregateExpression2,F));}if(this._getTreeComboValue(this._valueDefinitionCombo3)){B.appendChild(this._createQuery(this._valueDefinitionCombo3,this._agregateExpression3,F));}}this.__addFilterSoap(F.documentElement);var G=actuate.util.XmlDom.createElement(F,actuate.Constant.tag.Json);F.documentElement.appendChild(G);if(this._dataManagerSoap!=null){var H=this._dataManagerSoap.childNodes[0].data;var E=H.substr(0,H.length-1);this._hyperlinkCheckbox.disabled==true?E:E+=",";var C=F.createTextNode(E);G.appendChild(C);}if(this._hyperlinkCheckbox.disabled==false){var K=actuate.util.Json;var L="UseHyperlink:";if(G.childNodes.length==0){L="{UseHyperlink:";}var I={};I.value=this._hyperlinkCheckbox.getValue().toString();L+=K.makeMap(I)+"}";var J=F.createTextNode(L);G.appendChild(J);}else{var L=null;if(G.childNodes.length!=0){L="}";}else{L="{}";}var J=F.createTextNode(L);G.appendChild(J);}},_createQuery:function(C,I,H){var J=actuate.util.XmlDom.createElement(H,actuate.Constant.tag.Query);var N=actuate.util.XmlDom.createElement(H,"DataField");var G=this._getTreeComboValue(C);var F=H.createTextNode(G);N.appendChild(F);J.appendChild(N);var M=C.getValue();if(M){var L=actuate.util.XmlDom.createElement(H,"DataType");var B=M.valueDefinitionType;var D=H.createTextNode(B);L.appendChild(D);J.appendChild(L);}if(!I.disabled&&I.getValue()!=null&&I.getValue().length>0){var K=actuate.util.XmlDom.createElement(H,"Aggregate");var E=actuate.util.XmlDom.createElement(H,"Func");var A=H.createTextNode(I.getValue());E.appendChild(A);K.appendChild(E);J.appendChild(K);}return J;},__addDataIntoTreeStore:function(C,A){if(A&&C&&!(C.value&&C.value.dataType=="blob")){var B=C.value;if(B&&B.type=="column"&&this._isSummaryTable&&B.isDimension){return ;}C.valueDefinitionValue=C;C.valueDefinitionText=C.text;C.valueDefinitionType=this._getDataType(C);C.title=this._getTooltip(C);C.dimension=this._getDimension(C);C.hasAction=this._hasAction(C);C.isDimension=this._isDimension(C);C.disabled=this._isDisabled(C,A);A.add(new A.recordType(C,C.id));}},_isDisabled:function(B,A){if(actuate.dialog.impl.helper.gadgetbuilder.MeterDataTab.superclass._isDisabled.apply(this,arguments)){return true;}if(this._isSummaryTable&&B.type=="column"){return B.isDimension;}return false;},_getTreeComboValueByRecord:function(B){var A;if(B){A=B.value;}if(B&&B.value&&B.value.type){var D=B.value;switch(D.type){case"attribute":var E=D.fullName;if(E){E=E.replace(/\"/g,'\\"');A='row["'+E+'"]';}break;case"column":var C=D.name;if(C){C=C.replace(/\"/g,'\\"');A='row["'+C+'"]';}break;case"measure":if(D.dataType!="blob"){A='data["'+D.groupName+"/"+D.name+'"]';}break;default:A=D.name;break;}}return A;},_eh_onBeforeSelect:function(B,A){if(A&&A.data&&A.data.valueDefinitionValue){return actuate.dialog.impl.helper.gadgetbuilder.MeterDataTab.superclass._eh_onBeforeSelect.call(this,B,A.data.valueDefinitionValue.node);}return true;},__supportAttributes:function(A){return false;}});