actuate.util.Package.define("actuate.dialog.impl.helper.format");actuate.dialog.impl.helper.format.TimeFormattingDialog=actuate.Class.create();actuate.dialog.impl.helper.format.TimeFormattingDialog.superclass=actuate.dialog.impl.helper.AbstractIVDialog.prototype;actuate.dialog.impl.helper.format.TimeFormattingDialog.prototype=actuate.Class.extend(new actuate.dialog.impl.helper.AbstractIVDialog(),{_classname:"actuate.dialog.format.TimeFormattingDialog",_width:396,_htmlElements:{"_category":null,"_locale":null,"_customeCode":null,"_customePattern":null,"_customPatternInput":null,"_localeDIV":null,"_helpFormat.time":null,"_helpFormat.timeWithText":null,"_helpCode.time":null,"_helpCode.timeWithText":null,"_helpResult.time":null,"_helpResult.timeWithText":null,"_customePatternHelp":null},_resultSetName:null,_formatPattern:"",__dataFormat:null,_showLocale:false,initialize:function(){var A=this._getId(this._classname);this._applyHtmlElementsNames(A);actuate.dialog.impl.helper.format.TimeFormattingDialog.superclass.initialize.call(this,A);this._initTemplates();this.customCode=document.getElementById(this._htmlElements["_customeCode"]);this.customPattern=document.getElementById(this._htmlElements["_customePattern"]);this.customPatternInput=new actuate.uiadapter.TextField({cls:"valueTextBox "+actuate.dialog.impl.constant.CSS_INPUTBOX,name:"customPattern",width:200});this.customPatternInput.render(this._htmlElements["_customPatternInput"]);this.categoryMenu=new actuate.uiadapter.ComboBox({editable:false,width:200});this.categoryMenu.render(this._htmlElements["_category"]);this.localeMenu=new actuate.uiadapter.ComboBox({editable:false,width:200,valueField:"value",displayField:"text"});this.localeMenu.render(this._htmlElements["_locale"]);this.locale=document.getElementById(this._htmlElements["_localeDIV"]);this._installEventHandlers(A);},_initTemplates:function(){var E=document.createElement("div");var A=new actuate.uiadapter.Template('<table style="margin-top:1ex;" WIDTH="100%">'+'	<tr CLASS="helpHeader"> '+"		<TD>{0}</TD>"+'		<td style="width:4px"/>'+"		<TD>{1}</TD>"+'		<td style="width:4px"/>'+"		<TD>{2}</TD>"+"	</tr>"+"	<tr>"+'		<TD><DIV id="actuate_dialog_format_TimeFormattingDialog_helpFormat.time"></TD>'+'		<td style="width:4px"/>'+'		<TD><DIV id="actuate_dialog_format_TimeFormattingDialog_helpCode.time"></TD>'+'		<td style="width:4px"/>'+'		<td><DIV id="actuate_dialog_format_TimeFormattingDialog_helpResult.time"></DIV></td>'+"	</tr>"+"	<tr>"+'		<TD><DIV id="actuate_dialog_format_TimeFormattingDialog_helpFormat.timeWithText"></DIV></TD>'+'		<td style="width:4px"/>'+'		<TD><DIV id="actuate_dialog_format_TimeFormattingDialog_helpCode.timeWithText"></DIV></TD>'+'		<td style="width:4px"/>'+'		<td><DIV id="actuate_dialog_format_TimeFormattingDialog_helpResult.timeWithText"></DIV></td>'+"	</tr>"+"</table>");var D=[actuate.util.Utility.getLocalizedString("formattingDialog.helpHeader.format"),actuate.util.Utility.getLocalizedString("formattingDialog.helpHeader.code"),actuate.util.Utility.getLocalizedString("formattingDialog.helpHeader.result")];var C=A._append(E,D,true);var B=new actuate.uiadapter.FieldSet({checkboxToggle:false,title:actuate.util.Utility.getLocalizedString("formattingDialog.helpHeader.codeExamples"),autoHeight:true,defaultType:"textfield",bodyStyle:"padding:0px 0px 0",contentEl:E});B.render(this._htmlElements["_customePatternHelp"]);},_installEventHandlers:function(A){this.__neh_categoryMenuChange_c=actuate.Method.bindAsEventListener(this.__neh_categoryMenuChange,this);this.__neh_localeMenuChange_c=actuate.Method.bindAsEventListener(this.__neh_localeMenuChange,this);this.categoryMenu.registerEventHandler("select",this.__neh_categoryMenuChange_c);this.localeMenu.registerEventHandler("select",this.__neh_localeMenuChange_c);},__neh_categoryMenuChange:function(A){if(this.categoryMenu.getValue()==this.categoryMenu.getValueAt(this.categoryMenu.getLength()-1)){this.showCustom();}else{this.hideCustom();}},__neh_localeMenuChange:function(D){var A=actuate.dialog.locales[this.localeMenu.getValue()];var B=A.categorys;var C=A.helpValues;if(!B||!C){this._requestDateTimeFormats(A.country,A.language);return ;}this._refreshCategorysAndHelpValues(B,C);this.adjustSize();},hideCustom:function(){this.customCode.style.display="none";this.customPattern.style.display="none";this.adjustSize();},showCustom:function(){this.customCode.style.display="block";this.customPattern.style.display="block";this.adjustSize();},_propagateCategory:function(C){if(!C){return ;}else{if(C.language==null){C.language="";}if(C.country==null){C.country="";}}var A=actuate.dialog.locales;if(A){for(var B in A){if(A[B].language==null){A[B].language="";}if(A[B].country==null){A[B].country="";}if(C.language==A[B].language&&C.country==A[B].country){A[B].categorys=C.categorys;A[B].helpValues=C.helpValues;break;}}}this._refreshCategorysAndHelpValues(C.categorys,C.helpValues);return ;},_localBind:function(F){if(!F){return true;}if(F.categorys){this._propagateCategory(F);return ;}this._showLocale=F.showLocale;if(this._showLocale){this.locale.style.display="block";}else{this.locale.style.display="none";}this.hideCustom();this.customPatternInput.setValue("");this.categoryMenu.clear();if(!F){return ;}if(!F.targetMd){this._resultSetName=F.selectedBinding?F.selectedBinding.name:null;this.__dataFormat=F.selectedElement?F.selectedElement.dataFormat:null;}else{this._resultSetName=F.targetMd.binding.name;this.__dataFormat=F.targetMd.dataFormat;}if(F.total){this.total=F.total;this.targetMd=F.targetMd;}else{delete this.total;this.targetMd;}var B=actuate.dialog.locales;if(B&&this.localeMenu.getLength()<1){this.localeMenu.setStore(actuate.util.Utility.getLocaleStore());}var H=0;if(B&&this.__dataFormat&&this.__dataFormat.locale){var A=this.__dataFormat.locale;for(var D in B){if(B[D].country==A.country&&B[D].language==A.language){H=D;break;}}}this.localeMenu.setSelectedIndex(H);var G=actuate.dialog.locales[H];var E=G.helpValues;var C=G.categorys;if(!C||!E){this._requestDateTimeFormats(G.country,G.language);return ;}this._refreshCategorysAndHelpValues(C,E);},__getHelpTopic:function(){return"iv_datetime_formatting";},createJsonNode:function(){var B={};var E={};var A={};if(this.__resultSetName||this.__resultSetName==""){E.resultSetName=this.__resultSetName;}A.category=this.categoryMenu.getValue();var C=actuate.dialog.locales[this.localeMenu.getValue()];if(C&&C.country&&C.language){A.localeInfo=C;}var D=this.customPatternInput.getValue();if(!D){D=this._formatPattern;}if("Custom"==this.categoryMenu.getValue()&&!actuate.dialog.impl.Utility.validateCustomPatternInput(D,actuate.Constant.DataType.TIME)){actuate.dialog.impl.helper.format.TimeFormattingDialog.superclass.__showError.call(this,actuate.util.Utility.getLocalizedString("common.error.invalidCustomFormatPattern"));return false;}if(D){A.pattern=D;}B.resultSetDataType="Time";if(this._resultSetName){E.resultSetName=this.__resultSetName;}E.categoryChoice=A;B[actuate.Constant.tag.DATETIMEFORMAT]=E;return{dataFormat:B};},createSoapNode:function(){var A=actuate.util.XmlDom.createXMLDom(actuate.util.Constants.soap.NAMESPACE_ACTUATE10,actuate.Constant.tag.ColumnDefFormat);var K=actuate.util.XmlDom.createElement(A,actuate.Constant.tag.DATETIMEFORMAT);A.documentElement.appendChild(K);var C=actuate.util.XmlDom.createElement(A,actuate.Constant.tag.CATEGORYCHOICE);K.appendChild(C);var I=actuate.util.XmlDom.createElement(A,actuate.Constant.tag.CATEGORY);C.appendChild(I);var F=A.createTextNode(this.categoryMenu.getValue());I.appendChild(F);var D=actuate.dialog.locales[this.localeMenu.getValue()];if(D&&D.country&&D.language){var E=actuate.util.XmlDom.createElement(A,actuate.Constant.tag.LOCALEINFO);var L=actuate.util.XmlDom.createElement(A,actuate.Constant.tag.COUNTRY);var B=actuate.util.XmlDom.createElement(A,actuate.Constant.tag.LANGUAGE);L.appendChild(A.createTextNode(D.country));B.appendChild(A.createTextNode(D.language));E.appendChild(L);E.appendChild(B);C.appendChild(E);}var M=this.customPatternInput.getValue();if(!M){M=this._formatPattern;}if("Custom"==this.categoryMenu.getValue()&&!actuate.dialog.impl.Utility.validateCustomPatternInput(M,actuate.Constant.DataType.TIME)){actuate.dialog.impl.helper.format.TimeFormattingDialog.superclass.__showError.call(this,actuate.util.Utility.getLocalizedString("common.error.invalidCustomFormatPattern"));return false;}if(M){var O=actuate.util.XmlDom.createElement(A,actuate.Constant.tag.PATTERN);C.appendChild(O);var F=A.createTextNode(M);O.appendChild(F);}var H=actuate.util.XmlDom.createElement(A,"ResultSetDataType");A.documentElement.appendChild(H);var N=A.createTextNode("Time");H.appendChild(N);if(this._resultSetName){var G=actuate.util.XmlDom.createElement(A,"ResultSetName");A.documentElement.appendChild(G);var J=A.createTextNode(this._resultSetName);G.appendChild(J);}return A.documentElement;},_requestDateTimeFormats:function(D,F){var A={name:"country",value:D};var E={name:"language",value:F};var C={name:"target",value:this._classname};var B=[A,E,C];if(this._callbacks&&this._callbacks.changeLocaleCallback){this._callbacks.changeLocaleCallback(B);}else{if(this._helpee){this._helpee.fireEvent(actuate.dialog.EventConstants.ON_DIALOG_CHANGE_LOCALE,B);}}},_refreshCategorysAndHelpValues:function(C,E){var D=this.categoryMenu.getValue();if(this.__dataFormat){D=this.__dataFormat.category;}if(C){this.categoryMenu.setStore([["Unformatted",C.unformatted],["Long Time",C.longTime],["Medium Time",C.mediumTime],["Short Time",C.shortTime],["Custom",C.custom]]);if(D&&this.categoryMenu.containsKey(D)){this.categoryMenu.setValue(D);if(D==this.categoryMenu.getValueAt(this.categoryMenu.getLength()-1)){this.showCustom();}}else{this.categoryMenu.setValue(this.categoryMenu.getValueAt(0));}}this._updateNode("helpFormat",E.helpFormat);this._updateNode("helpCode",E.helpCode);this._updateNode("helpResult",E.helpResult);if(this.__dataFormat){var B=this.__dataFormat.pattern;var A=this.__dataFormat.locale;var F=null;if(D==this.categoryMenu.getValueAt(this.categoryMenu.getLength()-1)){this.customPatternInput.setValue(B==null?"":B);}else{B="";}this.__formatPattern=B==null?"":B;}this.__neh_categoryMenuChange();},_updateNode:function(B,A){var D=document.getElementById(this._htmlElements["_"+B+".time"]);var C=document.getElementById(this._htmlElements["_"+B+".timeWithText"]);actuate.util.XmlDom.setTextContent(D,A.time);actuate.util.XmlDom.setTextContent(C,A.timeWithText);}});