actuate.util.Package.define("actuate.dialog.impl.helper.chartbuilder");actuate.dialog.impl.helper.chartbuilder.DoughnutChartFormatTab=actuate.Class.extendClass(actuate.dialog.impl.helper.chartbuilder.BaseChartFormatTab,{_classname:"actuate.dialog.impl.helper.chartbuilder.DoughnutChartFormatTab",initialize:function(){this.id=this._getId(this._classname);this._title=actuate.util.Utility.getLocalizedString("chartBuilder.format");actuate.dialog.impl.helper.chartbuilder.BaseChartFormatTab.prototype.initialize.call(this);this._initUnitMap();this._control_theme=actuate.widget.ComponentMgr.get(this.id+"_theme");this._control_themeRow=actuate.widget.ComponentMgr.get(this.id+"_themeRow");this._control_width=actuate.widget.ComponentMgr.get(this.id+"_width");this._control_widthUnit=actuate.widget.ComponentMgr.get(this.id+"_widthUnit");this._control_height=actuate.widget.ComponentMgr.get(this.id+"_height");this._control_heightUnit=actuate.widget.ComponentMgr.get(this.id+"_heightUnit");this._control_dimension=actuate.widget.ComponentMgr.get(this.id+"_dimension");this._control_dimensionRow=actuate.widget.ComponentMgr.get(this.id+"_dimensionRow");this._control_rotation=actuate.widget.ComponentMgr.get(this.id+"_rotation");this._control_rotationRow=actuate.widget.ComponentMgr.get(this.id+"_rotationRow");this._control_outerRadiusRow=actuate.widget.ComponentMgr.get(this.id+"_outerRadiusRow");this._control_isAutoOuterRadius=actuate.widget.ComponentMgr.get(this.id+"_isAutoOuterRadius");this._control_outerRadius=actuate.widget.ComponentMgr.get(this.id+"_outerRadius");this._control_innerRadiusRow=actuate.widget.ComponentMgr.get(this.id+"_innerRadiusRow");this._control_innerRadius=actuate.widget.ComponentMgr.get(this.id+"_innerRadius");this._control_innerRadiusLabel=actuate.widget.ComponentMgr.get(this.id+"_innerRadiusLabel");this._initializeControlStatus();},_initializeControlStatus:function(){this._validateControlArray=[];this._validateControlArray.push(this._control_width);this._validateControlArray.push(this._control_height);this._validateControlArray.push(this._control_innerRadius);this._validateControlArray.push(this._control_outerRadius);},_initContent:function(){this._initSizeUnit();this._initChartBaseFontContent();this._componentArray=[];var C=this;this._componentArray.push(this._initChartTitle());this._dimensionStore=new actuate.widget.data.SimpleStore({fields:["value","text"]});var A=new this._dimensionStore.recordType({value:"0",text:actuate.util.Utility.getLocalizedString("chartBuilder.2d")});this._dimensionStore.add(A);var A=new this._dimensionStore.recordType({value:"1",text:actuate.util.Utility.getLocalizedString("chartBuilder.2dwithDepth")});this._dimensionStore.add(A);this._themeStore=new actuate.widget.data.SimpleStore({fields:["value","text"]});var B={xtype:"fieldset",collapsible:true,autoHeight:true,title:actuate.util.Utility.getLocalizedString("chartBuilder.chart"),checkboxToggle:false,defaults:{border:false,header:false,layout:"column",bodyStyle:"padding:2px 4px 2px 4px"},listeners:{collapse:function(){if(C._parentDialog&&C._parentDialog.adjustSize){C._parentDialog.adjustSize();}},expand:function(){if(C._parentDialog&&C._parentDialog.adjustSize){C._parentDialog.adjustSize();}}},items:[{id:this.id+"_themeRow",items:[{columnWidth:0.3,xtype:"label",text:actuate.util.Utility.getLocalizedString("chartBuilder.theme")},{columnWidth:0.42,id:this.id+"_theme",xtype:"combo",editable:false,forceSelection:true,valueField:"value",displayField:"text",store:this._themeStore}]},{items:[{columnWidth:0.3,xtype:"label",text:actuate.util.Utility.getLocalizedString("chartBuilder.width")},{columnWidth:0.2,id:this.id+"_width",value:"7",xtype:"textfield",allowBlank:false,validator:function(E){var D=actuate.dialog.impl.Utility.validatePositiveWithoutPlus(E);if(!D){return actuate.util.Utility.getLocalizedString("chartBuilder.numericpositive.errorMessage");}return true;}},{columnWidth:0.02,xtype:"label",style:"height:1px"},{columnWidth:0.2,id:this.id+"_widthUnit",xtype:"combo",editable:false,forceSelection:true,value:actuate.dialog.impl.constant.DesignChoice.UNITS_IN,valueField:"value",displayField:"text",store:this._sizeStore}]},{items:[{columnWidth:0.3,xtype:"label",text:actuate.util.Utility.getLocalizedString("chartBuilder.height")},{columnWidth:0.2,id:this.id+"_height",value:"3",xtype:"textfield",allowBlank:false,validator:function(E){var D=actuate.dialog.impl.Utility.validatePositiveWithoutPlus(E);if(!D){return actuate.util.Utility.getLocalizedString("chartBuilder.numericpositive.errorMessage");}return true;}},{columnWidth:0.02,xtype:"label",style:"height:1px"},{columnWidth:0.2,id:this.id+"_heightUnit",xtype:"combo",editable:false,forceSelection:true,value:actuate.dialog.impl.constant.DesignChoice.UNITS_IN,valueField:"value",displayField:"text",store:this._sizeStore}]},{id:this.id+"_dimensionRow",items:[{columnWidth:0.3,xtype:"label",text:actuate.util.Utility.getLocalizedString("chartBuilder.dimension")},{columnWidth:0.3,id:this.id+"_dimension",xtype:"combo",editable:false,forceSelection:true,value:"0",valueField:"value",displayField:"text",store:this._dimensionStore},{columnWidth:0.02,xtype:"label",style:"height:1px"},{columnWidth:0.2,xtype:"label",style:"height:1px"}]},{id:this.id+"_rotationRow",items:[{columnWidth:0.3,xtype:"label",text:actuate.util.Utility.getLocalizedString("chartBuilder.rotation")},{columnWidth:0.3,id:this.id+"_rotation",width:180,xtype:"slider",showValue:true,increment:10,value:0,minValue:0,maxValue:359}]},{id:this.id+"_outerRadiusRow",items:[{columnWidth:0.3,id:this.id+"_isAutoOuterRadius",xtype:"checkbox",checked:true,boxLabel:actuate.util.Utility.getLocalizedString("chartBuilder.autoOuterRadius"),handler:function(){var D=actuate.widget.ComponentMgr.get(C.id+"_outerRadius");D.setDisabled(this.checked?true:false);}},{columnWidth:0.3,id:this.id+"_outerRadius",xtype:"spinner",value:50,disabled:true,strategy:new actuate.widget.custom.Spinner.NumberStrategy({minValue:1}),validator:function(E){if(this.disabled){return true;}var D=actuate.dialog.impl.Utility.validatePositiveIntegerWithoutPlus(E);if(!D){return actuate.util.Utility.getLocalizedString("chartBuilder.positiveinteger.errorMessage");}return true;}},{columnWidth:0.02,xtype:"label",style:"height:1px"},{columnWidth:0.1,xtype:"label",text:actuate.util.Utility.getLocalizedString("chartBuilder.pixel")}]},{id:this.id+"_innerRadiusRow",items:[{columnWidth:0.3,xtype:"label",text:actuate.util.Utility.getLocalizedString("chartBuilder.innerRadius")},{columnWidth:0.3,id:this.id+"_innerRadius",xtype:"spinner",value:25,disabled:true,strategy:new actuate.widget.custom.Spinner.NumberStrategy({minValue:1}),validator:function(E){if(this.disabled){return true;}var D=actuate.dialog.impl.Utility.validatePositiveIntegerWithoutPlus(E);if(!D){return actuate.util.Utility.getLocalizedString("chartBuilder.positiveinteger.errorMessage");}if(!this._isFlashChart&&E>=100){return actuate.util.Utility.getLocalizedString("chartBuilder.doughnutInner.errorMessage");}return true;}},{columnWidth:0.02,xtype:"label",style:"height:1px"},{id:this.id+"_innerRadiusLabel",columnWidth:0.1,xtype:"label",text:actuate.util.Utility.getLocalizedString("chartBuilder.pixel")}]}]};if(this._chartBaseFont){B.items.push(this._chartBaseFont);}if(this._chartTooltipFont){B.items.push(this._chartTooltipFont);}this._componentArray.push(B);this._componentArray.push(this._initChartLegend());},_clearControls:function(){actuate.dialog.impl.helper.chartbuilder.DoughnutChartFormatTab.superclass._clearControls.apply(this,arguments);this._control_title.setValue("");this._control_rotation.setValue(0);this._control_isAutoOuterRadius.setValue(true);this._control_outerRadius.setDisabled(true);this._control_outerRadius.setValue(50);this._control_innerRadius.setDisabled(false);this._control_innerRadius.setValue(60);this._control_width.setValue("7");this._control_widthUnit.setValue(actuate.dialog.impl.constant.DesignChoice.UNITS_IN);this._control_height.setValue("3");this._control_heightUnit.setValue(actuate.dialog.impl.constant.DesignChoice.UNITS_IN);this._control_theme.setSelectedIndex(0);if(this._themeStore){for(var A=0;A<this._themeStore.getCount();A++){if(this._themeStore.getAt(A)&&this._themeStore.getAt(A).get("value")=="ThemesReportItems.Modern"){this._control_theme.setValue("ThemesReportItems.Modern");break;}}}},loadData:function(F){actuate.dialog.impl.helper.chartbuilder.DoughnutChartFormatTab.superclass.loadData.apply(this,arguments);if(this._isFlashChart==true){this._control_themeRow.hide();this._control_dimensionRow.show();this._control_legendTitleRow.show();this._control_rotationRow.show();this._control_outerRadiusRow.show();var B=this.chart.innerRadiusPercent;if(!B){this._control_innerRadiusLabel.setText(actuate.util.Utility.getLocalizedString("chartBuilder.pixel"));}else{this._control_innerRadiusLabel.setText(actuate.util.Utility.getLocalizedString("chartBuilder.percent"));}this._control_innerRadius._isFlashChart=true;}else{if(this._isFlashChart==false){this._control_themeRow.show();this._control_dimensionRow.hide();this._control_legendTitleRow.hide();this._control_rotationRow.hide();this._control_outerRadiusRow.hide();var B=this.chart.innerRadiusPercent;if(!B){this._control_innerRadiusLabel.setText(actuate.util.Utility.getLocalizedString("chartBuilder.point"));}else{this._control_innerRadiusLabel.setText(actuate.util.Utility.getLocalizedString("chartBuilder.percent"));}this._control_innerRadius._isFlashChart=false;var I=F[actuate.model.Constant.MetadataType.THEMES];if(I&&I.length>0){this._themeStore.removeAll();for(var G=0;G<I.length;G++){var L=new this._themeStore.recordType({value:I[G],text:I[G].replace("ThemesReportItems.","")});this._themeStore.add(L);}}this._control_theme.setSelectedIndex(0);if(this._themeStore){for(var E=0;E<this._themeStore.getCount();E++){if(this._themeStore.getAt(E)&&this._themeStore.getAt(E).get("value")=="ThemesReportItems.Modern"){this._control_theme.setValue("ThemesReportItems.Modern");break;}}}}}if(this.chart&&(this.chart.type=="FLASHCHART"||this.chart.type=="CHART")){this.chartSubType=this.chart.chartSubType;var D=this.chart.dimension;this._control_dimension.setValue(D);var M=this.chart.doughnutRadius;if(M>0){this._control_innerRadius.setValue(M);}this._control_innerRadius.setDisabled(false);var A=this.chart.pieRadius;if(!A||A==0){this._control_isAutoOuterRadius.setValue(true);this._control_outerRadius.setValue(50);this._control_outerRadius.setDisabled(true);}else{this._control_isAutoOuterRadius.setValue(false);this._control_outerRadius.setValue(A);this._control_outerRadius.setDisabled(false);}var C=this.chart.pieRotation;this._control_rotation.setValue(C);var H=this.chart.width;var K=this.getUnit(H);var J=H.split(K)[0];this._control_width.setValue(J);this._control_widthUnit.setValue(K);var H=this.chart.height;var K=this.getUnit(H);var J=H.split(K)[0];this._control_height.setValue(J);this._control_heightUnit.setValue(K);if(this._isFlashChart==false){if(this.chart.theme){this._control_theme.setValue(this.chart.theme);}}if(this._updateLegend){this._updateLegend();}}else{if(F.gadgetAttr){this._udpateSizeFromGadgetContainer(F.gadgetAttr);}}if(!this.hidden){this._enableType();}},_adjuctUIAfterActivate:function(){if(this._control_rotation.syncThumb){this._control_rotation.syncThumb();}},_initUnitMap:function(){this._allUnitMap=new Array();this._allUnitMap[actuate.dialog.impl.constant.DesignChoice.UNITS_PT]="chartFormatDialog.Unit.PT";this._allUnitMap[actuate.dialog.impl.constant.DesignChoice.UNITS_PC]="chartFormatDialog.Unit.PC";this._allUnitMap[actuate.dialog.impl.constant.DesignChoice.UNITS_PERCENTAGE]="chartFormatDialog.Unit.Percentage";this._allUnitMap[actuate.dialog.impl.constant.DesignChoice.UNITS_CM]="chartFormatDialog.Unit.CM";this._allUnitMap[actuate.dialog.impl.constant.DesignChoice.UNITS_MM]="chartFormatDialog.Unit.MM";this._allUnitMap[actuate.dialog.impl.constant.DesignChoice.UNITS_IN]="chartFormatDialog.Unit.IN";this._allUnitMap[actuate.dialog.impl.constant.DesignChoice.UNITS_EM]="chartFormatDialog.Unit.EM";this._allUnitMap[actuate.dialog.impl.constant.DesignChoice.UNITS_EX]="chartFormatDialog.Unit.EX";this._allUnitMap[actuate.dialog.impl.constant.DesignChoice.UNITS_PX]="chartFormatDialog.Unit.PX";},getUnit:function(C){var B=actuate.dialog.impl.constant.DesignChoice.UNITS_IN;for(var A in this._allUnitMap){if(C.indexOf(A)>-1){B=A;break;}}return B;},_enableType:function(){var A=this._parentDialog.getPanel("actuate_dialog_impl_helper_chartbuilder_chartTypeTab");if(A&&!A.hidden){A.updateType("Doughnut Chart");}},createSoapNode:function(A,B){this.createTypeNode(B,A);A.appendChild(this.createAppearanceNode(B,A));A.appendChild(this.createLabelsNode(B));},createTypeNode:function(F,E){var D;var C=E.getElementsByTagName(actuate.Constant.tag.ChartType);if(C==null||C.length==0){D=actuate.util.XmlDom.createElement(F,actuate.Constant.tag.ChartType);E.appendChild(D);}else{D=C[0];}var A=actuate.util.XmlDom.createElement(F,actuate.Constant.tag.ChartSubType);var B=F.createTextNode("standard");A.appendChild(B);D.appendChild(A);},createAppearanceNode:function(D,G){var N;var P=G.getElementsByTagName(actuate.Constant.tag.Apperance);if(P==null||P.length==0){N=actuate.util.XmlDom.createElement(D,actuate.Constant.tag.Apperance);G.appendChild(N);}else{N=P[0];}if(this._isFlashChart==false){var H=actuate.util.XmlDom.createElement(D,actuate.Constant.tag.Theme);var C=actuate.util.String.trim(this._control_theme.getValue());var E=D.createTextNode(C);H.appendChild(E);N.appendChild(H);}var I=actuate.util.Utility.getNumberFormatter();var Q=actuate.util.XmlDom.createElement(D,actuate.Constant.tag.ChartWidth);var Y;var W=actuate.util.String.trim(this._control_width.getValue());if(W==""){Y=D.createTextNode("");}else{Y=D.createTextNode(I.parse(this._control_width.getValue())+this._control_widthUnit.getValue());}Q.appendChild(Y);N.appendChild(Q);var T=actuate.util.XmlDom.createElement(D,actuate.Constant.tag.ChartHeight);var S;var M=actuate.util.String.trim(this._control_height.getValue());if(M==""){S=D.createTextNode("");}else{S=D.createTextNode((this._control_height.getValue())+this._control_heightUnit.getValue());}T.appendChild(S);N.appendChild(T);var U=actuate.util.XmlDom.createElement(D,actuate.Constant.tag.Dimention);var X=D.createTextNode(this._control_dimension.getValue());U.appendChild(X);N.appendChild(U);var L=this._control_rotation.getValue();if(L==null||L.length==0){L="0.0";}var A=actuate.util.XmlDom.createElement(D,actuate.Constant.tag.Rotation);var b=D.createTextNode(L);A.appendChild(b);N.appendChild(A);var a=this._control_isAutoOuterRadius.checked?"0":this._control_outerRadius.getValue();var R=actuate.util.XmlDom.createElement(D,actuate.Constant.tag.PieRadius);var K=D.createTextNode(a);R.appendChild(K);N.appendChild(R);var J=this._control_innerRadius;var c=J.getValue();var Z=actuate.util.XmlDom.createElement(D,actuate.Constant.tag.DoughnutRadius);var O=D.createTextNode(c);Z.appendChild(O);N.appendChild(Z);var V;var F=N.getElementsByTagName("YAxes");if(F==null||F.length==0){V=actuate.util.XmlDom.createElement(D,"YAxes");N.appendChild(V);}else{V=F[0];}var B;var d=V.getElementsByTagName("YAxis");if(d==null||d.length==0){B=actuate.util.XmlDom.createElement(D,"YAxis");V.appendChild(B);}this._addChartLegendToResponse(D,N);return N;},_okPress:function(){},_addChartNavigationToResponse:function(B,A){},_updateChartNavigation:function(){this._showHideTimeLine(false);this._navigationScrollBarCheckBox.hide();this._navigationScrollBarCheckBox.setValue(false);}});